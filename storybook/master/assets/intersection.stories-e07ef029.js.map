{"version":3,"file":"intersection.stories-e07ef029.js","sources":["../../../../src/layers/ReferenceLineLayer.ts","../../../../.storybook/src/complete-example/intersection.stories.ts"],"sourcesContent":["import { calcSize } from '../utils';\nimport { CanvasLayer, LayerOptions } from './base';\nimport { assertNever } from './schematicInterfaces';\nimport { OnUpdateEvent, OnRescaleEvent, OnMountEvent } from '../interfaces';\nimport { ScaleLinear } from 'd3-scale';\n\nexport type ReferenceLineType = 'wavy' | 'dashed' | 'solid';\n\nexport type ReferenceLine = {\n  text?: string;\n  lineType: ReferenceLineType;\n  color: string;\n  depth: number;\n  lineWidth?: number;\n  textColor?: string;\n  fontSize?: string;\n};\n\nexport interface ReferenceLineLayerOptions extends LayerOptions<ReferenceLine[]> {}\n\nconst foldReferenceLine = <T>(\n  options: {\n    wavy: (wavy: ReferenceLine) => T;\n    dashed: (dashed: ReferenceLine) => T;\n    solid: (solid: ReferenceLine) => T;\n  },\n  refLine: ReferenceLine,\n): T => {\n  switch (refLine.lineType) {\n    case 'wavy':\n      return options.wavy(refLine);\n\n    case 'dashed':\n      return options.dashed(refLine);\n\n    case 'solid':\n      return options.solid(refLine);\n\n    default:\n      return assertNever(refLine.lineType);\n  }\n};\n\nexport class ReferenceLineLayer extends CanvasLayer<ReferenceLine[]> {\n  yScale: ScaleLinear<number, number, never> | null = null;\n  xScale: ScaleLinear<number, number, never> | null = null;\n\n  onMount(event: OnMountEvent) {\n    super.onMount(event);\n  }\n\n  onUpdate(event: OnUpdateEvent<ReferenceLine[]>) {\n    super.onUpdate(event);\n    this.clearCanvas();\n    this.render();\n  }\n\n  onRescale(event: OnRescaleEvent) {\n    super.onRescale(event);\n    this.yScale = event.yScale;\n    this.xScale = event.xScale;\n    this.resetTransform();\n    this.render();\n  }\n\n  private drawDashed(dashed: ReferenceLine) {\n    const { ctx } = this;\n    const { canvas } = this;\n    const y = this.yScale(dashed.depth);\n    ctx.save();\n    ctx.strokeStyle = dashed.color;\n    this.setCtxLineStyle(ctx, dashed);\n    this.setCtxLineWidth(ctx, dashed);\n    ctx.beginPath();\n    ctx.moveTo(0, y);\n    ctx.lineTo(canvas.width, y);\n    ctx.stroke();\n    ctx.restore();\n    if (dashed.text) {\n      this.drawText(ctx, dashed, ctx.canvas.width, y);\n    }\n  }\n\n  private drawSolid(solid: ReferenceLine) {\n    const { ctx } = this;\n    const { canvas } = this;\n    const y = this.yScale(solid.depth);\n    ctx.save();\n    ctx.strokeStyle = solid.color;\n    this.setCtxLineStyle(ctx, solid);\n    this.setCtxLineWidth(ctx, solid);\n    ctx.beginPath();\n    ctx.moveTo(0, y);\n    ctx.lineTo(canvas.width, y);\n    ctx.stroke();\n    ctx.restore();\n    if (solid.text) {\n      this.drawText(ctx, solid, ctx.canvas.width, y);\n    }\n  }\n\n  private drawWavy(wavy: ReferenceLine): void {\n    const factor = 4;\n    const min = 2.5;\n    const max = 500;\n    const { ctx } = this;\n    const { canvas } = this;\n    const waveHeight = calcSize(factor, min, max, this.yScale);\n    const wavePeriod = waveHeight * 2;\n    const y = this.yScale(wavy.depth) - waveHeight;\n    const steps = Math.ceil(canvas.width / wavePeriod) + 1;\n    const xOffset = this.xScale(0) % wavePeriod;\n    ctx.save();\n    ctx.strokeStyle = wavy.color;\n    this.setCtxLineStyle(ctx, wavy);\n    this.setCtxLineWidth(ctx, wavy);\n    for (let i = -1; i < steps; i++) {\n      ctx.beginPath();\n      ctx.arc(i * wavePeriod + xOffset + waveHeight, y, waveHeight, 0, Math.PI);\n      ctx.stroke();\n    }\n    ctx.restore();\n    if (wavy.text) {\n      this.drawText(ctx, wavy, ctx.canvas.width, y);\n    }\n  }\n\n  private drawText(ctx: CanvasRenderingContext2D, refLine: ReferenceLine, x: number, y: number) {\n    const textColor = refLine.textColor || '#000';\n    const fontSize = refLine.fontSize || '10px sans-serif';\n    const textOffsetX = 10;\n    ctx.save();\n    ctx.strokeStyle = textColor;\n    ctx.font = fontSize;\n    ctx.textAlign = 'end';\n    ctx.textBaseline = 'bottom';\n    ctx.fillText(refLine.text, x - textOffsetX, y);\n    ctx.restore();\n  }\n\n  private setCtxLineStyle(ctx: CanvasRenderingContext2D, refLine: ReferenceLine): void {\n    const a = 8;\n    const b = 10;\n    foldReferenceLine(\n      {\n        solid: () => {\n          ctx.setLineDash([]);\n        },\n        dashed: () => {\n          ctx.setLineDash([a, b]);\n        },\n        wavy: () => {\n          ctx.setLineDash([]);\n        },\n      },\n      refLine,\n    );\n  }\n\n  private setCtxLineWidth(ctx: CanvasRenderingContext2D, refLine: ReferenceLine) {\n    const defaultLineWidth = 1;\n    ctx.lineWidth = refLine.lineWidth || defaultLineWidth;\n  }\n\n  private render() {\n    if (!this.ctx || !this.yScale || !this.xScale) {\n      return;\n    }\n\n    requestAnimationFrame(() => {\n      this.clearCanvas();\n\n      this.data?.forEach((refLine) => {\n        foldReferenceLine(\n          {\n            solid: (solid) => this.drawSolid(solid),\n            dashed: (dashed) => this.drawDashed(dashed),\n            wavy: (wavy) => this.drawWavy(wavy),\n          },\n          refLine,\n        );\n      });\n    });\n  }\n}\n","import { GridLayer, WellborepathLayer, GeomodelLayerV2, GeomodelLabelsLayer, Layer, SeismicCanvasLayer, CalloutCanvasLayer, PixiRenderApplication, generateSurfaceData, SurfaceData, getSeismicInfo, generateSeismicSliceImage, transformFormationData, getPicksData, getSeismicOptions, IntersectionReferenceSystem, Controller, Annotation, SchematicLayer, SchematicLayerOptions, InternalLayerOptions, Perforation, SchematicData, ReferenceLine, ReferenceLineLayer } from '../../../src';\nimport { createButtonContainer, createFPSLabel, createLayerContainer, createRootContainer, createHelpText } from '../utils';\n\n//Data\nimport { seismicColorMap } from '../exampledata';\nimport { getSeismic, getSurfaces, getWellborePath, getStratColumns, getHolesize, getCasings, getCement, getPicks, getCompletion, getCementSqueezes } from '../data';\nexport const intersection = () => {\n  const xBounds: [number, number] = [0, 1000];\n  const yBounds: [number, number] = [0, 1000];\n  const scaleOptions = {\n    xBounds,\n    yBounds\n  };\n  return renderIntersection(scaleOptions);\n};\nexport const intersectionFlipX = () => {\n  const xBounds: [number, number] = [1000, 0];\n  const yBounds: [number, number] = [0, 1000];\n  const scaleOptions = {\n    xBounds,\n    yBounds\n  };\n  return renderIntersection(scaleOptions);\n};\nconst renderIntersection = (scaleOptions: any) => {\n  const axisOptions = {\n    xLabel: 'Displacement',\n    yLabel: 'TVD MSL',\n    unitOfMeasure: 'm'\n  };\n  const width = 700;\n  const height = 600;\n\n  // helper container elements\n  const root = createRootContainer(width);\n  const btnToggleContainer = createButtonContainer(width);\n  const btnAdjustSizeContainer = createButtonContainer(width);\n  const btnSchematicContainer = createButtonContainer(width);\n  const btnMiscContainer = createButtonContainer(width);\n  const container = createLayerContainer(width, height);\n  const promises = [getWellborePath(), getCompletion(), getSeismic(), getSurfaces(), getStratColumns(), getCasings(), getHolesize(), getCement(), getPicks(), getCementSqueezes()];\n  Promise.all(promises).then(values => {\n    const [path, completion, seismic, surfaces, stratColumns, casings, holeSizes, cement, picks, cementSqueezes] = values;\n    const referenceSystem = new IntersectionReferenceSystem(path);\n    referenceSystem.offset = path[0][2]; // Offset should be md at start of path\n    const displacement = referenceSystem.displacement || 1;\n    const extend = 1000 / displacement;\n    const steps = surfaces[0]?.data?.values?.length || 1;\n    const traj = referenceSystem.getTrajectory(steps, 0, 1 + extend);\n    const trajectory: number[][] = IntersectionReferenceSystem.toDisplacement(traj.points, traj.offset);\n    const geolayerdata: SurfaceData = generateSurfaceData(trajectory, stratColumns, surfaces);\n    const seismicInfo = getSeismicInfo(seismic, trajectory);\n    const transformedPicksData = transformFormationData(picks, stratColumns);\n    const picksData = getPicksData(transformedPicksData);\n    const pixiContext1 = new PixiRenderApplication({\n      width,\n      height\n    });\n    const pixiContext2 = new PixiRenderApplication({\n      width,\n      height\n    });\n\n    // Instantiate layers\n    const gridLayer = new GridLayer('grid', {\n      majorColor: 'black',\n      minorColor: 'gray',\n      majorWidth: 0.5,\n      minorWidth: 0.5,\n      order: 1,\n      referenceSystem\n    });\n    const geomodelLayer = new GeomodelLayerV2<SurfaceData>(pixiContext1, 'geomodel', {\n      order: 2,\n      layerOpacity: 0.6,\n      data: geolayerdata\n    });\n    const wellboreLayer = new WellborepathLayer('wellborepath', {\n      order: 3,\n      strokeWidth: '2px',\n      stroke: 'red',\n      referenceSystem\n    });\n    const geomodelLabelsLayer = new GeomodelLabelsLayer<SurfaceData>('geomodellabels', {\n      order: 3,\n      data: geolayerdata\n    });\n    const seismicLayer = new SeismicCanvasLayer('seismic', {\n      order: 1\n    });\n    const CSDSVGs = {\n      completionSymbol1: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxwYXRoIGQ9Ik0xMCAwSDkwVjEwMEgxMFYwWiIgZmlsbD0iI0Q5RDlEOSIvPgo8cGF0aCBkPSJNMCAyNUgxMFY3NUgwVjI1WiIgZmlsbD0iI0I1QjJCMiIvPgo8cGF0aCBkPSJNNDUgMjVINTVWNzVINDVWMjVaIiBmaWxsPSIjQjVCMkIyIi8+CjxwYXRoIGQ9Ik05MCAyNUgxMDBWNzVIOTBWMjVaIiBmaWxsPSIjQjVCMkIyIi8+Cjwvc3ZnPgo=',\n      completionSymbol2: 'tubing1.svg',\n      // Fetched from URL. Full URL with protocol and hostname is allowed.\n      completionSymbol3: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxwYXRoIGQ9Ik0xMCAwSDkwVjEwMEgxMFYwWiIgZmlsbD0iI0Q5RDlEOSIvPgo8cGF0aCBkPSJNMCAyNUgxMFY3NUgwVjI1WiIgZmlsbD0iI0I1QjJCMiIvPgo8cGF0aCBkPSJNNDUgMjVINTVWNzVINDVWMjVaIiBmaWxsPSIjQjVCMkIyIi8+CjxwYXRoIGQ9Ik0yNSA2NUgzMFY4MEgyNVY2NVoiIGZpbGw9IiMzMTMxMzEiLz4KPHBhdGggZD0iTTI1IDQySDMwVjU3SDI1VjQyWiIgZmlsbD0iIzMxMzEzMSIvPgo8cGF0aCBkPSJNMjUgMjFIMzBWMzZIMjVWMjFaIiBmaWxsPSIjMzEzMTMxIi8+CjxwYXRoIGQ9Ik03MCA2NEg3NVY3OUg3MFY2NFoiIGZpbGw9IiMzMTMxMzEiLz4KPHBhdGggZD0iTTcwIDQxSDc1VjU2SDcwVjQxWiIgZmlsbD0iIzMxMzEzMSIvPgo8cGF0aCBkPSJNNzAgMjBINzVWMzVINzBWMjBaIiBmaWxsPSIjMzEzMTMxIi8+CjxwYXRoIGQ9Ik05MCAyNUgxMDBWNzVIOTBWMjVaIiBmaWxsPSIjQjVCMkIyIi8+Cjwvc3ZnPgo='\n    };\n    const completionSymbols = [{\n      kind: 'completionSymbol',\n      id: 'completion-svg-1',\n      start: 5250,\n      end: 5252,\n      diameter: 8.5,\n      symbolKey: 'completionSymbol1'\n    }, {\n      kind: 'completionSymbol',\n      id: 'completion-svg-2',\n      start: 5252,\n      end: 5274,\n      diameter: 8.5,\n      symbolKey: 'completionSymbol2'\n    }, {\n      kind: 'completionSymbol',\n      id: 'completion-svg-3',\n      start: 5274,\n      end: 5276,\n      diameter: 8.5,\n      symbolKey: 'completionSymbol3'\n    }];\n    const pAndASVGs = {\n      mechanicalPlug: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cjxzdmcgd2lkdGg9IjEwMCIgaGVpZ2h0PSIxMDAiIHZpZXdCb3g9IjAgMCAxMDAgMTAwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMSAxSDk5Vjk5SDFWMVoiIGZpbGw9InVybCgjcGFpbnQwX2xpbmVhcl81MF81KSIvPgo8cGF0aCBkPSJNMSAxSDk5Vjk5SDFWMVoiIGZpbGw9InVybCgjcGFpbnQxX2xpbmVhcl81MF81KSIgZmlsbC1vcGFjaXR5PSIwLjIiLz4KPHBhdGggZD0iTTEgMUg5OVY5OUgxVjFaIiBzdHJva2U9ImJsYWNrIiBzdHJva2Utd2lkdGg9IjIiLz4KPGxpbmUgeDE9IjEuNzEwNzIiIHkxPSIxLjI5NjUzIiB4Mj0iOTguNzEwNyIgeTI9Ijk5LjI5NjUiIHN0cm9rZT0iYmxhY2siIHN0cm9rZS13aWR0aD0iMiIvPgo8bGluZSB4MT0iOTguNzA3MSIgeTE9IjAuNzA3MTA3IiB4Mj0iMC43MDcxIiB5Mj0iOTguNzA3MSIgc3Ryb2tlPSJibGFjayIgc3Ryb2tlLXdpZHRoPSIyIi8+CjxkZWZzPgo8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50MF9saW5lYXJfNTBfNSIgeDE9IjAiIHkxPSI1MCIgeDI9IjUwIiB5Mj0iNTAiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3Agc3RvcC1jb2xvcj0iI0NDMjYyNiIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiNGRjQ3MUEiLz4KPC9saW5lYXJHcmFkaWVudD4KPGxpbmVhckdyYWRpZW50IGlkPSJwYWludDFfbGluZWFyXzUwXzUiIHgxPSI1MCIgeTE9IjUwIiB4Mj0iMTAwIiB5Mj0iNTAiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3Agc3RvcC1jb2xvcj0iI0ZGNDcxQSIvPgo8c3RvcCBvZmZzZXQ9IjAuOTk5OSIgc3RvcC1jb2xvcj0iI0NDMjYyNiIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiNGRjQ3MUEiLz4KPC9saW5lYXJHcmFkaWVudD4KPC9kZWZzPgo8L3N2Zz4K'\n    };\n    const pAndASymbols = [{\n      kind: ('pAndASymbol' as const),\n      id: 'mechanical-plug-1',\n      start: 5100,\n      end: 5110,\n      diameter: 8.5,\n      symbolKey: 'mechanicalPlug'\n    }, {\n      kind: ('cementPlug' as const),\n      id: 'cement-plug-2',\n      start: 5000,\n      end: 5110,\n      referenceIds: ['casing-07']\n    }];\n    const perforations: Perforation[] = [{\n      kind: 'perforation',\n      subKind: 'Perforation',\n      id: 'PerforationDemo1',\n      start: 4000,\n      end: 4500,\n      isOpen: true\n    }, {\n      kind: 'perforation',\n      subKind: 'Cased hole frac pack',\n      id: 'PerforationDemo2',\n      start: 3500,\n      end: 4500,\n      isOpen: true\n    }];\n    const schematicData: SchematicData = {\n      holeSizes,\n      cements: cement,\n      casings,\n      completion: [...completion, ...completionSymbols],\n      pAndA: [...pAndASymbols, ...cementSqueezes],\n      perforations,\n      symbols: {\n        ...CSDSVGs,\n        ...pAndASVGs\n      }\n    };\n    const internalLayerIds: InternalLayerOptions = {\n      holeLayerId: 'hole-id',\n      casingLayerId: 'casing-id',\n      completionLayerId: 'completion-id',\n      cementLayerId: 'cement-id',\n      pAndALayerId: 'pAndA-id',\n      perforationLayerId: 'perforation-id'\n    };\n    const schematicLayerOptions: SchematicLayerOptions<SchematicData> = {\n      order: 5,\n      referenceSystem,\n      internalLayerOptions: internalLayerIds,\n      data: schematicData\n    };\n    const schematicLayer = new SchematicLayer(pixiContext2, 'schematic-webgl-layer', schematicLayerOptions);\n    const seaAndRKBLayerData: ReferenceLine[] = [{\n      text: 'RKB',\n      lineType: 'dashed',\n      color: 'black',\n      depth: 0\n    }, {\n      text: 'MSL',\n      lineType: 'wavy',\n      color: 'blue',\n      depth: 30\n    }, {\n      text: 'Seabed',\n      lineType: 'solid',\n      color: 'slategray',\n      depth: 91.1,\n      lineWidth: 2\n    }];\n    const seaAndRKBLayer = new ReferenceLineLayer('sea-and-rkb-layer', {\n      data: seaAndRKBLayerData\n    });\n    const calloutLayer = new CalloutCanvasLayer<Annotation[]>('callout', {\n      order: 100,\n      data: picksData,\n      referenceSystem\n    });\n    const layers = [gridLayer, geomodelLayer, wellboreLayer, geomodelLabelsLayer, seismicLayer, schematicLayer, seaAndRKBLayer, calloutLayer];\n    const opts = {\n      scaleOptions,\n      axisOptions,\n      container,\n      referenceSystem\n    };\n    const controller = new Controller({\n      layers,\n      ...opts\n    });\n    addMDOverlay(controller);\n    const seismicOptions = getSeismicOptions(seismicInfo);\n    generateSeismicSliceImage((seismic as any), trajectory, seismicColorMap).then((seismicImage: ImageBitmap) => {\n      seismicLayer.setData({\n        image: seismicImage,\n        options: seismicOptions\n      });\n    });\n    controller.adjustToSize(width, height);\n    controller.setViewport(1000, 1500, 5000);\n    controller.zoomPanHandler.zFactor = 1;\n    const FPSLabel = createFPSLabel();\n\n    // toggle layers and axis\n    const btnGrid = createButton(controller, gridLayer, 'Grid');\n    const btnWellbore = createButton(controller, wellboreLayer, 'Wellbore');\n    const btnGeomodel = createButton(controller, geomodelLayer, 'Geo model');\n    const btnSchematic = createButton(controller, schematicLayer, 'Schematic');\n    const btnSeaAndRKB = createButton(controller, seaAndRKBLayer, 'SeaAndRKB');\n    const btnGeomodelLabels = createButton(controller, geomodelLabelsLayer, 'Geo model labels');\n    const btnSeismic = createButton(controller, seismicLayer, 'Seismic');\n    const btnPicks = createButton(controller, calloutLayer, 'Picks');\n    const internalLayerVisibilityButtons = [['Holes', internalLayerIds.holeLayerId], ['Casings', internalLayerIds.casingLayerId], ['Cement', internalLayerIds.cementLayerId], ['Completion', internalLayerIds.completionLayerId], ['Plug & Abandonment', internalLayerIds.pAndALayerId], ['Perforations', internalLayerIds.perforationLayerId]].map(([description, internalLayerId]) => createInternalLayerVisibilityButton(controller, internalLayerId, description));\n    let show = true;\n    const toggleAxis = createButtonWithCb('Axis labels', (btn: HTMLElement) => {\n      if (show) {\n        controller.hideAxisLabels();\n        btn.style.backgroundColor = 'red';\n        btn.style.color = 'white';\n        show = false;\n      } else {\n        controller.showAxisLabels();\n        show = true;\n        btn.style.backgroundColor = 'lightblue';\n        btn.style.color = '';\n      }\n    }, 'background: lightblue;');\n    const btnLarger = createButtonWithCb('800x600', () => {\n      const w = 800;\n      const h = 600;\n      container.setAttribute('style', `height: ${h}px; width: ${w}px;background-color: #eee;`);\n      root.style.width = `${w}px`;\n      btnAdjustSizeContainer.style.width = `${w}px`;\n      btnToggleContainer.style.width = `${w}px`;\n      controller.adjustToSize(w, h);\n    });\n    const btnSmaller = createButtonWithCb('600x400', () => {\n      const w = 600;\n      const h = 400;\n      container.setAttribute('style', `height: ${h}px; width: ${w}px;background-color: #eee;`);\n      root.style.width = `${w}px`;\n      btnAdjustSizeContainer.style.width = `${w}px`;\n      btnToggleContainer.style.width = `${w}px`;\n      controller.adjustToSize(w, h);\n    });\n    const btnDefault = createButtonWithCb('Default', () => {\n      container.setAttribute('style', `height: ${height}px; width: ${width}px;background-color: #eee;`);\n      root.style.width = `${width}px`;\n      btnAdjustSizeContainer.style.width = `${width}px`;\n      btnToggleContainer.style.width = `${width}px`;\n      controller.adjustToSize(width, height);\n    });\n    const btnClearData = createButtonWithCb('Clear everything', () => {\n      controller.clearAllData();\n    });\n    btnToggleContainer.appendChild(btnGrid);\n    btnToggleContainer.appendChild(btnWellbore);\n    btnToggleContainer.appendChild(btnGeomodel);\n    btnToggleContainer.appendChild(btnGeomodelLabels);\n    btnToggleContainer.appendChild(btnSeismic);\n    btnToggleContainer.appendChild(btnSchematic);\n    btnToggleContainer.appendChild(btnSeaAndRKB);\n    btnToggleContainer.appendChild(btnPicks);\n    btnToggleContainer.appendChild(toggleAxis);\n    btnAdjustSizeContainer.appendChild(btnLarger);\n    btnAdjustSizeContainer.appendChild(btnSmaller);\n    btnAdjustSizeContainer.appendChild(btnDefault);\n    btnMiscContainer.appendChild(btnClearData);\n    internalLayerVisibilityButtons.forEach(button => btnSchematicContainer.appendChild(button));\n    root.appendChild(createHelpText('A complete example of multiple layers comprised of SVG, Canvas, HTML and pixi.js (WebGL). We use a controller to update and display each layer in a container (just a plain div element) on top of each other.'));\n    root.appendChild(container);\n    root.appendChild(createHelpText('Toggle'));\n    root.appendChild(btnToggleContainer);\n    root.appendChild(createHelpText('Schematic toggle'));\n    root.appendChild(btnSchematicContainer);\n    root.appendChild(createHelpText('Adjust size'));\n    root.appendChild(btnAdjustSizeContainer);\n    root.appendChild(createHelpText('Miscellaneous'));\n    root.appendChild(btnMiscContainer);\n    root.appendChild(FPSLabel);\n  });\n  return root;\n};\nfunction addMDOverlay(instance: any) {\n  const elm = instance.overlay.create('md', {\n    onMouseMove: (event: any) => {\n      const {\n        target,\n        caller,\n        x\n      } = event;\n      const newX = caller.currentStateAsEvent.xScale.invert(x);\n      const {\n        referenceSystem\n      } = caller;\n      const md = referenceSystem.unproject(newX);\n      target.textContent = Number.isFinite(md) ? `MD: ${md.toFixed(1)}` : '-';\n      if (md < 0 || referenceSystem.length < md) {\n        target.style.visibility = 'hidden';\n      } else {\n        target.style.visibility = 'visible';\n      }\n    },\n    onMouseExit: (event: any) => {\n      event.target.style.visibility = 'hidden';\n    }\n  });\n  elm.style.visibility = 'hidden';\n  elm.style.display = 'inline-block';\n  elm.style.padding = '2px';\n  elm.style.borderRadius = '4px';\n  elm.style.textAlign = 'right';\n  elm.style.position = 'absolute';\n  elm.style.backgroundColor = 'rgba(0,0,0,0.5)';\n  elm.style.color = 'white';\n  elm.style.right = '5px';\n  elm.style.bottom = '5px';\n  elm.style.zIndex = '100';\n}\n\n/**\n * storybook helper button for toggling a layer on and off\n * @param manager\n * @param layer\n * @param title\n * @param additionalEventParams\n */\nconst createButton = <T,>(manager: Controller, layer: Layer<T>, title: string) => {\n  const btn = document.createElement('button');\n  btn.innerHTML = `${title}`;\n  btn.setAttribute('style', 'width: 170px;height:32px;margin-top:12px;background: lightblue;');\n  let show = false;\n  btn.onclick = () => {\n    if (show) {\n      manager.showLayer(layer.id);\n      btn.style.backgroundColor = 'lightblue';\n      btn.style.color = '';\n    } else {\n      manager.hideLayer(layer.id);\n      btn.style.backgroundColor = 'red';\n      btn.style.color = 'white';\n    }\n    show = !show;\n  };\n  return btn;\n};\nconst createInternalLayerVisibilityButton = (manager: Controller, internalLayerId: string, title: string) => {\n  const btn = document.createElement('button');\n  btn.innerHTML = `${title}`;\n  btn.setAttribute('style', 'width: 170px;height:32px;margin-top:12px;background: lightblue;');\n  let show = false;\n  btn.onclick = () => {\n    if (show) {\n      manager.showLayer(internalLayerId);\n      btn.style.backgroundColor = 'lightblue';\n      btn.style.color = '';\n    } else {\n      manager.hideLayer(internalLayerId);\n      btn.style.backgroundColor = 'red';\n      btn.style.color = 'white';\n    }\n    show = !show;\n  };\n  return btn;\n};\n\n/**\n * helper method\n * @param label - button label\n * @param cb - callback function when clicking\n */\nfunction createButtonWithCb(label: string, cb: any, initialStyle = '') {\n  const btn = document.createElement('button');\n  btn.innerHTML = label;\n  btn.setAttribute('style', `${initialStyle}width: 170px;height:32px;margin-top:12px;`);\n  // cb(btn);\n  btn.onclick = () => cb(btn);\n  return btn;\n}\nexport default {\n  title: 'ESV Intersection/Complete example',\n  component: intersection\n};\nintersection.parameters = {\n  ...intersection.parameters,\n  storySource: {\n    source: \"() => {\\n  const xBounds: [number, number] = [0, 1000];\\n  const yBounds: [number, number] = [0, 1000];\\n  const scaleOptions = {\\n    xBounds,\\n    yBounds\\n  };\\n  return renderIntersection(scaleOptions);\\n}\",\n    ...intersection.parameters?.storySource\n  }\n};\nintersectionFlipX.parameters = {\n  ...intersectionFlipX.parameters,\n  storySource: {\n    source: \"() => {\\n  const xBounds: [number, number] = [1000, 0];\\n  const yBounds: [number, number] = [0, 1000];\\n  const scaleOptions = {\\n    xBounds,\\n    yBounds\\n  };\\n  return renderIntersection(scaleOptions);\\n}\",\n    ...intersectionFlipX.parameters?.storySource\n  }\n};"],"names":["foldReferenceLine","options","refLine","assertNever","ReferenceLineLayer","CanvasLayer","event","dashed","ctx","canvas","y","solid","wavy","waveHeight","calcSize","wavePeriod","steps","xOffset","i","x","textColor","fontSize","textOffsetX","_a","intersection","renderIntersection","intersectionFlipX","scaleOptions","axisOptions","width","height","root","createRootContainer","btnToggleContainer","createButtonContainer","btnAdjustSizeContainer","btnSchematicContainer","btnMiscContainer","container","createLayerContainer","promises","getWellborePath","getCompletion","getSeismic","getSurfaces","getStratColumns","getCasings","getHolesize","getCement","getPicks","getCementSqueezes","values","path","completion","seismic","surfaces","stratColumns","casings","holeSizes","cement","picks","cementSqueezes","referenceSystem","IntersectionReferenceSystem","extend","_c","_b","traj","trajectory","geolayerdata","generateSurfaceData","seismicInfo","getSeismicInfo","transformedPicksData","transformFormationData","picksData","getPicksData","pixiContext1","PixiRenderApplication","pixiContext2","gridLayer","GridLayer","geomodelLayer","GeomodelLayerV2","wellboreLayer","WellborepathLayer","geomodelLabelsLayer","GeomodelLabelsLayer","seismicLayer","SeismicCanvasLayer","CSDSVGs","completionSymbols","pAndASVGs","pAndASymbols","perforations","schematicData","internalLayerIds","schematicLayerOptions","schematicLayer","SchematicLayer","seaAndRKBLayerData","seaAndRKBLayer","calloutLayer","CalloutCanvasLayer","layers","opts","controller","Controller","addMDOverlay","seismicOptions","getSeismicOptions","generateSeismicSliceImage","seismicColorMap","seismicImage","FPSLabel","createFPSLabel","btnGrid","createButton","btnWellbore","btnGeomodel","btnSchematic","btnSeaAndRKB","btnGeomodelLabels","btnSeismic","btnPicks","internalLayerVisibilityButtons","description","internalLayerId","createInternalLayerVisibilityButton","show","toggleAxis","createButtonWithCb","btn","btnLarger","btnSmaller","btnDefault","btnClearData","button","createHelpText","instance","elm","target","caller","newX","md","manager","layer","title","label","cb","initialStyle","intersection_stories"],"mappings":"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"}