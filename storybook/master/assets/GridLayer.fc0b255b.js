var V=Object.defineProperty;var P=(r,t,e)=>t in r?V(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var u=(r,t,e)=>(P(r,typeof t!="symbol"?t+"":t,e),e);import{o as C,C as j}from"./elements.b2968f38.js";function E(r){return r}var A=1,S=2,R=3,G=4,$=1e-6;function B(r){return"translate("+r+",0)"}function N(r){return"translate(0,"+r+")"}function U(r){return t=>+r(t)}function J(r,t){return t=Math.max(0,r.bandwidth()-t*2)/2,r.round()&&(t=Math.round(t)),e=>+r(e)+t}function q(){return!this.__axis}function z(r,t){var e=[],s=null,l=null,a=6,i=6,o=3,h=typeof window<"u"&&window.devicePixelRatio>1?0:.5,f=r===A||r===G?-1:1,d=r===G||r===S?"x":"y",g=r===A||r===R?B:N;function c(n){var O=s==null?t.ticks?t.ticks.apply(t,e):t.domain():s,w=l==null?t.tickFormat?t.tickFormat.apply(t,e):E:l,k=Math.max(a,0)+o,x=t.range(),_=+x[0]+h,y=+x[x.length-1]+h,L=(t.bandwidth?J:U)(t.copy(),h),X=n.selection?n.selection():n,b=X.selectAll(".domain").data([null]),m=X.selectAll(".tick").data(O,t).order(),T=m.exit(),v=m.enter().append("g").attr("class","tick"),Y=m.select("line"),M=m.select("text");b=b.merge(b.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),m=m.merge(v),Y=Y.merge(v.append("line").attr("stroke","currentColor").attr(d+"2",f*a)),M=M.merge(v.append("text").attr("fill","currentColor").attr(d,f*k).attr("dy",r===A?"0em":r===R?"0.71em":"0.32em")),n!==X&&(b=b.transition(n),m=m.transition(n),Y=Y.transition(n),M=M.transition(n),T=T.transition(n).attr("opacity",$).attr("transform",function(p){return isFinite(p=L(p))?g(p+h):this.getAttribute("transform")}),v.attr("opacity",$).attr("transform",function(p){var D=this.parentNode.__axis;return g((D&&isFinite(D=D(p))?D:L(p))+h)})),T.remove(),b.attr("d",r===G||r===S?i?"M"+f*i+","+_+"H"+h+"V"+y+"H"+f*i:"M"+h+","+_+"V"+y:i?"M"+_+","+f*i+"V"+h+"H"+y+"V"+f*i:"M"+_+","+h+"H"+y),m.attr("opacity",1).attr("transform",function(p){return g(L(p)+h)}),Y.attr(d+"2",f*a),M.attr(d,f*k).text(w),X.filter(q).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",r===S?"start":r===G?"end":"middle"),X.each(function(){this.__axis=L})}return c.scale=function(n){return arguments.length?(t=n,c):t},c.ticks=function(){return e=Array.from(arguments),c},c.tickArguments=function(n){return arguments.length?(e=n==null?[]:Array.from(n),c):e.slice()},c.tickValues=function(n){return arguments.length?(s=n==null?null:Array.from(n),c):s&&s.slice()},c.tickFormat=function(n){return arguments.length?(l=n,c):l},c.tickSize=function(n){return arguments.length?(a=i=+n,c):a},c.tickSizeInner=function(n){return arguments.length?(a=+n,c):a},c.tickSizeOuter=function(n){return arguments.length?(i=+n,c):i},c.tickPadding=function(n){return arguments.length?(o=+n,c):o},c.offset=function(n){return arguments.length?(h=+n,c):h},c}function K(r){return z(S,r)}function Q(r){return z(R,r)}class st{constructor(t,e=!0,s,l,a,i){u(this,"mainGroup");u(this,"_scaleX");u(this,"_scaleY");u(this,"_showLabels",!0);u(this,"_labelXDesc");u(this,"_labelYDesc");u(this,"_unitOfMeasure");u(this,"_offsetX",0);u(this,"_offsetY",0);u(this,"_flipX",!1);u(this,"_flipY",!1);u(this,"visible",!0);u(this,"createOrGet",t=>{const{mainGroup:e}=this;let s=e.select(`g.${t}`);return s.empty()&&(s=e.append("g").attr("class",t)),s});this.mainGroup=t,this._showLabels=e,this._labelXDesc=s,this._labelYDesc=l,this._unitOfMeasure=a,i&&i.offsetX&&(this._offsetX=i.offsetX),i&&i.offsetX&&(this._offsetY=i.offsetY),i&&i.visible&&(this.visible=i.visible),this.mainGroup.style("pointer-events","none"),this._scaleX=C().domain([0,1]).range([0,1]),this._scaleY=C().domain([0,1]).range([0,1])}renderLabelx(){const{_labelXDesc:t,_unitOfMeasure:e,_showLabels:s,_scaleX:l}=this,[,a]=l.range(),i=this.renderGx();let o=i.select("text.axis-labelx");return s?o.empty()&&(o=i.append("text").attr("class","axis-labelx").attr("fill","rgba(0,0,0,0.3)").style("text-anchor","middle").style("font-weight","800").style("font-size","10px").text(`${t} (${e})`)):o.remove(),o.attr("transform",`translate(${a/2},-4)`),o}renderLabely(){const{_labelYDesc:t,_unitOfMeasure:e,_showLabels:s,_scaleY:l}=this,[,a]=l.range(),i=this.renderGy();let o=i.select("text.axis-labely");return s?(o.empty()&&(o=i.append("text").attr("class","axis-labely").attr("fill","rgba(0,0,0,0.3)").style("text-anchor","middle").style("font-weight","800").style("font-size","10px").text(`${t} (${e})`)),o.attr("transform",`translate(-10,${a/2})rotate(90)`)):o.remove(),o}renderGy(){const{_scaleX:t,_scaleY:e}=this,s=K(e),[,l]=t.range(),a=this.createOrGet("y-axis");return a.call(s),a.attr("transform",`translate(${l},0)`),a}renderGx(){const{_scaleX:t,_scaleY:e}=this,s=Q(t),[,l]=e.range(),a=this.createOrGet("x-axis");return a.attr("transform",`translate(0 ${l})`),a.call(s),a}render(){this.renderLabelx(),this.renderLabely()}onResize(t){this.mainGroup.attr("height",`${t.height}px`).attr("width",`${t.width}px`)}onRescale(t){const{_scaleX:e,_scaleY:s,offsetX:l,offsetY:a}=this,{xScale:i,yScale:o}=t,h=i.domain(),f=o.domain(),d=i.range(),g=o.range();e.domain([h[0]-l,h[1]-l]).range(d),s.domain([f[0]-a,f[1]-a]).range(g),this.flipX(this._flipX),this.flipY(this._flipY),this.visible&&this.render()}show(){return this.visible=!0,this.mainGroup.attr("visibility","visible"),this.render(),this}hide(){return this.visible=!1,this.mainGroup.attr("visibility","hidden"),this}flipX(t){this._flipX=t;const e=this._scaleX.domain(),s=t?-1:1;return this._scaleX.domain([s*e[0],s*e[1]]),this}flipY(t){this._flipY=t;const e=this._scaleY.domain(),s=t?-1:1;return this._scaleY.domain([s*e[0],s*e[1]]),this}showLabels(){return this._showLabels=!0,this.render(),this}hideLabels(){return this._showLabels=!1,this.render(),this}setLabelX(t){return this._labelXDesc=t,this}setLabelY(t){return this._labelYDesc=t,this}setUnitOfMeasure(t){return this._unitOfMeasure=t,this}setLabels(t,e,s){return this._labelXDesc=t,this._labelYDesc=e,this._unitOfMeasure=s,this}get offsetX(){return this._offsetX}set offsetX(t){this._offsetX=t}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY=t}get scaleX(){return this._scaleX.copy()}get scaleY(){return this._scaleY.copy()}}const W="lightgray",F="gray",H=.25,I=.75,Z={minorColor:W,majorColor:F,minorWidth:H,majorWidth:I};class rt extends j{constructor(e,s){super(e,s);u(this,"_offsetX",0);u(this,"_offsetY",0);this.options={...this.options,...s||Z},this.render=this.render.bind(this)}onUpdate(e){super.onUpdate(e),this.render(e)}onRescale(e){super.onRescale(e),this.render(e)}render(e){const{ctx:s}=this,{minorWidth:l,minorColor:a,majorWidth:i,majorColor:o}=this.options;if(!s||(this.clearCanvas(),!(e.xScale||e.yScale)))return;const h=e.xScale.copy(),f=e.yScale.copy(),d=h.domain(),g=f.domain(),c=this.offsetX,n=this.offsetY;h.domain([d[0]-c,d[1]-c]),f.domain([g[0]-n,g[1]-n]);const[O,w]=h.range(),[k,x]=f.range();s.lineWidth=l||H,s.strokeStyle=a||W;const _=this.mapMinorTicks(h.ticks()),y=this.mapMinorTicks(f.ticks());this.renderTicksX(h,_,k,x),this.renderTicksY(f,y,O,w),s.lineWidth=i||I,s.strokeStyle=o||F,this.renderTicksX(h,h.ticks(),k,x),this.renderTicksY(f,f.ticks(),O,w),s.restore()}renderTicksX(e,s,l,a){s.forEach(i=>{const o=e(i);this.ctx.beginPath(),this.ctx.moveTo(o,l),this.ctx.lineTo(o,a),this.ctx.stroke()})}renderTicksY(e,s,l,a){s.forEach(i=>{const o=e(i);this.ctx.beginPath(),this.ctx.moveTo(l,o),this.ctx.lineTo(a,o),this.ctx.stroke()})}mapMinorTicks(e){let s=[];return e.length>=2&&(s=e.map(l=>l+(e[1]-e[0])/2),s.pop()),s}get offsetX(){return this._offsetX}set offsetX(e){this._offsetX=e}get offsetY(){return this._offsetY}set offsetY(e){this._offsetY=e}}export{st as A,rt as G};
//# sourceMappingURL=GridLayer.fc0b255b.js.map
