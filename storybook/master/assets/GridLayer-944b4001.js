import{p as R,C as I}from"./elements-acce8859.js";function V(n){return n}var A=1,S=2,D=3,G=4,C=1e-6;function P(n){return"translate("+n+",0)"}function j(n){return"translate(0,"+n+")"}function E(n){return t=>+n(t)}function B(n,t){return t=Math.max(0,n.bandwidth()-t*2)/2,n.round()&&(t=Math.round(t)),e=>+n(e)+t}function N(){return!this.__axis}function $(n,t){var e=[],i=null,h=null,a=6,s=6,o=3,l=typeof window<"u"&&window.devicePixelRatio>1?0:.5,f=n===A||n===G?-1:1,u=n===G||n===S?"x":"y",m=n===A||n===D?P:j;function c(r){var Y=i??(t.ticks?t.ticks.apply(t,e):t.domain()),M=h??(t.tickFormat?t.tickFormat.apply(t,e):V),_=Math.max(a,0)+o,y=t.range(),p=+y[0]+l,O=+y[y.length-1]+l,w=(t.bandwidth?B:E)(t.copy(),l),b=r.selection?r.selection():r,x=b.selectAll(".domain").data([null]),d=b.selectAll(".tick").data(Y,t).order(),T=d.exit(),L=d.enter().append("g").attr("class","tick"),k=d.select("line"),X=d.select("text");x=x.merge(x.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),d=d.merge(L),k=k.merge(L.append("line").attr("stroke","currentColor").attr(u+"2",f*a)),X=X.merge(L.append("text").attr("fill","currentColor").attr(u,f*_).attr("dy",n===A?"0em":n===D?"0.71em":"0.32em")),r!==b&&(x=x.transition(r),d=d.transition(r),k=k.transition(r),X=X.transition(r),T=T.transition(r).attr("opacity",C).attr("transform",function(g){return isFinite(g=w(g))?m(g+l):this.getAttribute("transform")}),L.attr("opacity",C).attr("transform",function(g){var v=this.parentNode.__axis;return m((v&&isFinite(v=v(g))?v:w(g))+l)})),T.remove(),x.attr("d",n===G||n===S?s?"M"+f*s+","+p+"H"+l+"V"+O+"H"+f*s:"M"+l+","+p+"V"+O:s?"M"+p+","+f*s+"V"+l+"H"+O+"V"+f*s:"M"+p+","+l+"H"+O),d.attr("opacity",1).attr("transform",function(g){return m(w(g)+l)}),k.attr(u+"2",f*a),X.attr(u,f*_).text(M),b.filter(N).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",n===S?"start":n===G?"end":"middle"),b.each(function(){this.__axis=w})}return c.scale=function(r){return arguments.length?(t=r,c):t},c.ticks=function(){return e=Array.from(arguments),c},c.tickArguments=function(r){return arguments.length?(e=r==null?[]:Array.from(r),c):e.slice()},c.tickValues=function(r){return arguments.length?(i=r==null?null:Array.from(r),c):i&&i.slice()},c.tickFormat=function(r){return arguments.length?(h=r,c):h},c.tickSize=function(r){return arguments.length?(a=s=+r,c):a},c.tickSizeInner=function(r){return arguments.length?(a=+r,c):a},c.tickSizeOuter=function(r){return arguments.length?(s=+r,c):s},c.tickPadding=function(r){return arguments.length?(o=+r,c):o},c.offset=function(r){return arguments.length?(l=+r,c):l},c}function U(n){return $(S,n)}function J(n){return $(D,n)}class Q{constructor(t,e=!0,i,h,a,s){this._showLabels=!0,this._offsetX=0,this._offsetY=0,this._flipX=!1,this._flipY=!1,this.visible=!0,this.createOrGet=o=>{const{mainGroup:l}=this;let f=l.select(`g.${o}`);return f.empty()&&(f=l.append("g").attr("class",o)),f},this.mainGroup=t,this._showLabels=e,this._labelXDesc=i,this._labelYDesc=h,this._unitOfMeasure=a,s&&s.offsetX&&(this._offsetX=s.offsetX),s&&s.offsetX&&(this._offsetY=s.offsetY),s&&s.visible&&(this.visible=s.visible),this.mainGroup.style("pointer-events","none"),this._scaleX=R().domain([0,1]).range([0,1]),this._scaleY=R().domain([0,1]).range([0,1])}renderLabelx(){const{_labelXDesc:t,_unitOfMeasure:e,_showLabels:i,_scaleX:h}=this,[,a]=h.range(),s=this.renderGx();let o=s.select("text.axis-labelx");return i?o.empty()&&(o=s.append("text").attr("class","axis-labelx").attr("fill","rgba(0,0,0,0.3)").style("text-anchor","middle").style("font-weight","800").style("font-size","10px").text(`${t} (${e})`)):o.remove(),o.attr("transform",`translate(${a/2},-4)`),o}renderLabely(){const{_labelYDesc:t,_unitOfMeasure:e,_showLabels:i,_scaleY:h}=this,[,a]=h.range(),s=this.renderGy();let o=s.select("text.axis-labely");return i?(o.empty()&&(o=s.append("text").attr("class","axis-labely").attr("fill","rgba(0,0,0,0.3)").style("text-anchor","middle").style("font-weight","800").style("font-size","10px").text(`${t} (${e})`)),o.attr("transform",`translate(-10,${a/2})rotate(90)`)):o.remove(),o}renderGy(){const{_scaleX:t,_scaleY:e}=this,i=U(e),[,h]=t.range(),a=this.createOrGet("y-axis");return a.call(i),a.attr("transform",`translate(${h},0)`),a}renderGx(){const{_scaleX:t,_scaleY:e}=this,i=J(t),[,h]=e.range(),a=this.createOrGet("x-axis");return a.attr("transform",`translate(0 ${h})`),a.call(i),a}render(){this.renderLabelx(),this.renderLabely()}onResize(t){this.mainGroup.attr("height",`${t.height}px`).attr("width",`${t.width}px`)}onRescale(t){const{_scaleX:e,_scaleY:i,offsetX:h,offsetY:a}=this,{xScale:s,yScale:o}=t,l=s.domain(),f=o.domain(),u=s.range(),m=o.range();e.domain([l[0]-h,l[1]-h]).range(u),i.domain([f[0]-a,f[1]-a]).range(m),this.flipX(this._flipX),this.flipY(this._flipY),this.visible&&this.render()}show(){return this.visible=!0,this.mainGroup.attr("visibility","visible"),this.render(),this}hide(){return this.visible=!1,this.mainGroup.attr("visibility","hidden"),this}flipX(t){this._flipX=t;const e=this._scaleX.domain(),i=t?-1:1;return this._scaleX.domain([i*e[0],i*e[1]]),this}flipY(t){this._flipY=t;const e=this._scaleY.domain(),i=t?-1:1;return this._scaleY.domain([i*e[0],i*e[1]]),this}showLabels(){return this._showLabels=!0,this.render(),this}hideLabels(){return this._showLabels=!1,this.render(),this}setLabelX(t){return this._labelXDesc=t,this}setLabelY(t){return this._labelYDesc=t,this}setUnitOfMeasure(t){return this._unitOfMeasure=t,this}setLabels(t,e,i){return this._labelXDesc=t,this._labelYDesc=e,this._unitOfMeasure=i,this}get offsetX(){return this._offsetX}set offsetX(t){this._offsetX=t}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY=t}get scaleX(){return this._scaleX.copy()}get scaleY(){return this._scaleY.copy()}}const z="lightgray",W="gray",F=.25,H=.75,q={minorColor:z,majorColor:W,minorWidth:F,majorWidth:H};class Z extends I{constructor(t,e){super(t,e),this._offsetX=0,this._offsetY=0,this.options={...this.options,...e||q},this.render=this.render.bind(this)}onUpdate(t){super.onUpdate(t),this.render(t)}onRescale(t){super.onRescale(t),this.render(t)}render(t){const{ctx:e}=this,{minorWidth:i,minorColor:h,majorWidth:a,majorColor:s}=this.options;if(!e||(this.clearCanvas(),!(t.xScale||t.yScale)))return;const o=t.xScale.copy(),l=t.yScale.copy(),f=o.domain(),u=l.domain(),m=this.offsetX,c=this.offsetY;o.domain([f[0]-m,f[1]-m]),l.domain([u[0]-c,u[1]-c]);const[r,Y]=o.range(),[M,_]=l.range();e.lineWidth=i||F,e.strokeStyle=h||z;const y=this.mapMinorTicks(o.ticks()),p=this.mapMinorTicks(l.ticks());this.renderTicksX(o,y,M,_),this.renderTicksY(l,p,r,Y),e.lineWidth=a||H,e.strokeStyle=s||W,this.renderTicksX(o,o.ticks(),M,_),this.renderTicksY(l,l.ticks(),r,Y),e.restore()}renderTicksX(t,e,i,h){e.forEach(a=>{const s=t(a);this.ctx.beginPath(),this.ctx.moveTo(s,i),this.ctx.lineTo(s,h),this.ctx.stroke()})}renderTicksY(t,e,i,h){e.forEach(a=>{const s=t(a);this.ctx.beginPath(),this.ctx.moveTo(i,s),this.ctx.lineTo(h,s),this.ctx.stroke()})}mapMinorTicks(t){let e=[];return t.length>=2&&(e=t.map(i=>i+(t[1]-t[0])/2),e.pop()),e}get offsetX(){return this._offsetX}set offsetX(t){this._offsetX=t}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY=t}}export{Q as A,Z as G};
//# sourceMappingURL=GridLayer-944b4001.js.map
