const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./browserAll-B_uz20Fh.js","./webworkerAll-CrVqv5Cp.js","./Filter-BjS0F7N-.js","./preload-helper-Dp1pzeXC.js","./_commonjsHelpers-CqkleIqs.js","./WebGPURenderer-csR-RqTU.js","./BufferResource-C5Lv9mFE.js","./RenderTargetSystem-CKxY57d4.js","./CanvasPool-DMzpdoSh.js","./WebGLRenderer-BxNg1U4q.js","./CanvasRenderer-Cjc8IK-Z.js","./BitmapFont-CgnA3fMx.js"])))=>i.map(i=>d[i]);
import{_ as Ce}from"./preload-helper-Dp1pzeXC.js";import{g as Na}from"./_commonjsHelpers-CqkleIqs.js";function Wn(n,t){return n==null||t==null?NaN:n<t?-1:n>t?1:n>=t?0:NaN}function el(n,t){return n==null||t==null?NaN:t<n?-1:t>n?1:t>=n?0:NaN}function Ua(n){let t,e,r;n.length!==2?(t=Wn,e=(a,h)=>Wn(n(a),h),r=(a,h)=>n(a)-h):(t=n===Wn||n===el?n:nl,e=n,r=n);function i(a,h,c=0,l=a.length){if(c<l){if(t(h,h)!==0)return l;do{const u=c+l>>>1;e(a[u],h)<0?c=u+1:l=u}while(c<l)}return c}function s(a,h,c=0,l=a.length){if(c<l){if(t(h,h)!==0)return l;do{const u=c+l>>>1;e(a[u],h)<=0?c=u+1:l=u}while(c<l)}return c}function o(a,h,c=0,l=a.length){const u=i(a,h,c,l-1);return u>c&&r(a[u-1],h)>-r(a[u],h)?u-1:u}return{left:i,center:o,right:s}}function nl(){return 0}function rl(n){return n===null?NaN:+n}const il=Ua(Wn),sl=il.right;Ua(rl).center;class Vs extends Map{constructor(t,e=hl){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),t!=null)for(const[r,i]of t)this.set(r,i)}get(t){return super.get(Ws(this,t))}has(t){return super.has(Ws(this,t))}set(t,e){return super.set(ol(this,t),e)}delete(t){return super.delete(al(this,t))}}function Ws({_intern:n,_key:t},e){const r=t(e);return n.has(r)?n.get(r):e}function ol({_intern:n,_key:t},e){const r=t(e);return n.has(r)?n.get(r):(n.set(r,e),e)}function al({_intern:n,_key:t},e){const r=t(e);return n.has(r)&&(e=n.get(e),n.delete(r)),e}function hl(n){return n!==null&&typeof n=="object"?n.valueOf():n}const cl=Math.sqrt(50),ll=Math.sqrt(10),ul=Math.sqrt(2);function tr(n,t,e){const r=(t-n)/Math.max(0,e),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),o=s>=cl?10:s>=ll?5:s>=ul?2:1;let a,h,c;return i<0?(c=Math.pow(10,-i)/o,a=Math.round(n*c),h=Math.round(t*c),a/c<n&&++a,h/c>t&&--h,c=-c):(c=Math.pow(10,i)*o,a=Math.round(n/c),h=Math.round(t/c),a*c<n&&++a,h*c>t&&--h),h<a&&.5<=e&&e<2?tr(n,t,e*2):[a,h,c]}function dl(n,t,e){if(t=+t,n=+n,e=+e,!(e>0))return[];if(n===t)return[n];const r=t<n,[i,s,o]=r?tr(t,n,e):tr(n,t,e);if(!(s>=i))return[];const a=s-i+1,h=new Array(a);if(r)if(o<0)for(let c=0;c<a;++c)h[c]=(s-c)/-o;else for(let c=0;c<a;++c)h[c]=(s-c)*o;else if(o<0)for(let c=0;c<a;++c)h[c]=(i+c)/-o;else for(let c=0;c<a;++c)h[c]=(i+c)*o;return h}function yi(n,t,e){return t=+t,n=+n,e=+e,tr(n,t,e)[2]}function fl(n,t,e){t=+t,n=+n,e=+e;const r=t<n,i=r?yi(t,n,e):yi(n,t,e);return(r?-1:1)*(i<0?1/-i:i)}function xi(n,t){let e;if(t===void 0)for(const r of n)r!=null&&(e<r||e===void 0&&r>=r)&&(e=r);else{let r=-1;for(let i of n)(i=t(i,++r,n))!=null&&(e<i||e===void 0&&i>=i)&&(e=i)}return e}function Rr(n,t){let e=0;if(t===void 0)for(let r of n)(r=+r)&&(e+=r);else{let r=-1;for(let i of n)(i=+t(i,++r,n))&&(e+=i)}return e}function $a(n,t){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(t).domain(n);break}return this}const Xs=Symbol("implicit");function Ha(){var n=new Vs,t=[],e=[],r=Xs;function i(s){let o=n.get(s);if(o===void 0){if(r!==Xs)return r;n.set(s,o=t.push(s)-1)}return e[o%e.length]}return i.domain=function(s){if(!arguments.length)return t.slice();t=[],n=new Vs;for(const o of s)n.has(o)||n.set(o,t.push(o)-1);return i},i.range=function(s){return arguments.length?(e=Array.from(s),i):e.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return Ha(t,e).unknown(r)},$a.apply(i,arguments),i}function ss(n,t,e){n.prototype=t.prototype=e,e.constructor=n}function Va(n,t){var e=Object.create(n.prototype);for(var r in t)e[r]=t[r];return e}function bn(){}var un=.7,er=1/un,Me="\\s*([+-]?\\d+)\\s*",dn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",It="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",pl=/^#([0-9a-f]{3,8})$/,gl=new RegExp(`^rgb\\(${Me},${Me},${Me}\\)$`),ml=new RegExp(`^rgb\\(${It},${It},${It}\\)$`),yl=new RegExp(`^rgba\\(${Me},${Me},${Me},${dn}\\)$`),xl=new RegExp(`^rgba\\(${It},${It},${It},${dn}\\)$`),_l=new RegExp(`^hsl\\(${dn},${It},${It}\\)$`),bl=new RegExp(`^hsla\\(${dn},${It},${It},${dn}\\)$`),Ys={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ss(bn,Yt,{copy(n){return Object.assign(new this.constructor,this,n)},displayable(){return this.rgb().displayable()},hex:qs,formatHex:qs,formatHex8:vl,formatHsl:wl,formatRgb:js,toString:js});function qs(){return this.rgb().formatHex()}function vl(){return this.rgb().formatHex8()}function wl(){return Wa(this).formatHsl()}function js(){return this.rgb().formatRgb()}function Yt(n){var t,e;return n=(n+"").trim().toLowerCase(),(t=pl.exec(n))?(e=t[1].length,t=parseInt(t[1],16),e===6?Zs(t):e===3?new lt(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):e===8?Mn(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):e===4?Mn(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=gl.exec(n))?new lt(t[1],t[2],t[3],1):(t=ml.exec(n))?new lt(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=yl.exec(n))?Mn(t[1],t[2],t[3],t[4]):(t=xl.exec(n))?Mn(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=_l.exec(n))?Js(t[1],t[2]/100,t[3]/100,1):(t=bl.exec(n))?Js(t[1],t[2]/100,t[3]/100,t[4]):Ys.hasOwnProperty(n)?Zs(Ys[n]):n==="transparent"?new lt(NaN,NaN,NaN,0):null}function Zs(n){return new lt(n>>16&255,n>>8&255,n&255,1)}function Mn(n,t,e,r){return r<=0&&(n=t=e=NaN),new lt(n,t,e,r)}function Al(n){return n instanceof bn||(n=Yt(n)),n?(n=n.rgb(),new lt(n.r,n.g,n.b,n.opacity)):new lt}function _i(n,t,e,r){return arguments.length===1?Al(n):new lt(n,t,e,r??1)}function lt(n,t,e,r){this.r=+n,this.g=+t,this.b=+e,this.opacity=+r}ss(lt,_i,Va(bn,{brighter(n){return n=n==null?er:Math.pow(er,n),new lt(this.r*n,this.g*n,this.b*n,this.opacity)},darker(n){return n=n==null?un:Math.pow(un,n),new lt(this.r*n,this.g*n,this.b*n,this.opacity)},rgb(){return this},clamp(){return new lt(pe(this.r),pe(this.g),pe(this.b),nr(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ks,formatHex:Ks,formatHex8:Cl,formatRgb:Qs,toString:Qs}));function Ks(){return`#${fe(this.r)}${fe(this.g)}${fe(this.b)}`}function Cl(){return`#${fe(this.r)}${fe(this.g)}${fe(this.b)}${fe((isNaN(this.opacity)?1:this.opacity)*255)}`}function Qs(){const n=nr(this.opacity);return`${n===1?"rgb(":"rgba("}${pe(this.r)}, ${pe(this.g)}, ${pe(this.b)}${n===1?")":`, ${n})`}`}function nr(n){return isNaN(n)?1:Math.max(0,Math.min(1,n))}function pe(n){return Math.max(0,Math.min(255,Math.round(n)||0))}function fe(n){return n=pe(n),(n<16?"0":"")+n.toString(16)}function Js(n,t,e,r){return r<=0?n=t=e=NaN:e<=0||e>=1?n=t=NaN:t<=0&&(n=NaN),new At(n,t,e,r)}function Wa(n){if(n instanceof At)return new At(n.h,n.s,n.l,n.opacity);if(n instanceof bn||(n=Yt(n)),!n)return new At;if(n instanceof At)return n;n=n.rgb();var t=n.r/255,e=n.g/255,r=n.b/255,i=Math.min(t,e,r),s=Math.max(t,e,r),o=NaN,a=s-i,h=(s+i)/2;return a?(t===s?o=(e-r)/a+(e<r)*6:e===s?o=(r-t)/a+2:o=(t-e)/a+4,a/=h<.5?s+i:2-s-i,o*=60):a=h>0&&h<1?0:o,new At(o,a,h,n.opacity)}function Ml(n,t,e,r){return arguments.length===1?Wa(n):new At(n,t,e,r??1)}function At(n,t,e,r){this.h=+n,this.s=+t,this.l=+e,this.opacity=+r}ss(At,Ml,Va(bn,{brighter(n){return n=n==null?er:Math.pow(er,n),new At(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=n==null?un:Math.pow(un,n),new At(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=this.h%360+(this.h<0)*360,t=isNaN(n)||isNaN(this.s)?0:this.s,e=this.l,r=e+(e<.5?e:1-e)*t,i=2*e-r;return new lt(Fr(n>=240?n-240:n+120,i,r),Fr(n,i,r),Fr(n<120?n+240:n-120,i,r),this.opacity)},clamp(){return new At(to(this.h),Sn(this.s),Sn(this.l),nr(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const n=nr(this.opacity);return`${n===1?"hsl(":"hsla("}${to(this.h)}, ${Sn(this.s)*100}%, ${Sn(this.l)*100}%${n===1?")":`, ${n})`}`}}));function to(n){return n=(n||0)%360,n<0?n+360:n}function Sn(n){return Math.max(0,Math.min(1,n||0))}function Fr(n,t,e){return(n<60?t+(e-t)*n/60:n<180?e:n<240?t+(e-t)*(240-n)/60:t)*255}const os=n=>()=>n;function Sl(n,t){return function(e){return n+e*t}}function Pl(n,t,e){return n=Math.pow(n,e),t=Math.pow(t,e)-n,e=1/e,function(r){return Math.pow(n+r*t,e)}}function Tl(n){return(n=+n)==1?Xa:function(t,e){return e-t?Pl(t,e,n):os(isNaN(t)?e:t)}}function Xa(n,t){var e=t-n;return e?Sl(n,e):os(isNaN(n)?t:n)}const fn=(function n(t){var e=Tl(t);function r(i,s){var o=e((i=_i(i)).r,(s=_i(s)).r),a=e(i.g,s.g),h=e(i.b,s.b),c=Xa(i.opacity,s.opacity);return function(l){return i.r=o(l),i.g=a(l),i.b=h(l),i.opacity=c(l),i+""}}return r.gamma=n,r})(1);function kl(n,t){t||(t=[]);var e=n?Math.min(t.length,n.length):0,r=t.slice(),i;return function(s){for(i=0;i<e;++i)r[i]=n[i]*(1-s)+t[i]*s;return r}}function El(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Il(n,t){var e=t?t.length:0,r=n?Math.min(e,n.length):0,i=new Array(r),s=new Array(e),o;for(o=0;o<r;++o)i[o]=as(n[o],t[o]);for(;o<e;++o)s[o]=t[o];return function(a){for(o=0;o<r;++o)s[o]=i[o](a);return s}}function Rl(n,t){var e=new Date;return n=+n,t=+t,function(r){return e.setTime(n*(1-r)+t*r),e}}function wt(n,t){return n=+n,t=+t,function(e){return n*(1-e)+t*e}}function Fl(n,t){var e={},r={},i;(n===null||typeof n!="object")&&(n={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in n?e[i]=as(n[i],t[i]):r[i]=t[i];return function(s){for(i in e)r[i]=e[i](s);return r}}var bi=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Br=new RegExp(bi.source,"g");function Bl(n){return function(){return n}}function Ll(n){return function(t){return n(t)+""}}function Ya(n,t){var e=bi.lastIndex=Br.lastIndex=0,r,i,s,o=-1,a=[],h=[];for(n=n+"",t=t+"";(r=bi.exec(n))&&(i=Br.exec(t));)(s=i.index)>e&&(s=t.slice(e,s),a[o]?a[o]+=s:a[++o]=s),(r=r[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,h.push({i:o,x:wt(r,i)})),e=Br.lastIndex;return e<t.length&&(s=t.slice(e),a[o]?a[o]+=s:a[++o]=s),a.length<2?h[0]?Ll(h[0].x):Bl(t):(t=h.length,function(c){for(var l=0,u;l<t;++l)a[(u=h[l]).i]=u.x(c);return a.join("")})}function as(n,t){var e=typeof t,r;return t==null||e==="boolean"?os(t):(e==="number"?wt:e==="string"?(r=Yt(t))?(t=r,fn):Ya:t instanceof Yt?fn:t instanceof Date?Rl:El(t)?kl:Array.isArray(t)?Il:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Fl:wt)(n,t)}function Dl(n,t){return n=+n,t=+t,function(e){return Math.round(n*(1-e)+t*e)}}var eo=180/Math.PI,vi={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function qa(n,t,e,r,i,s){var o,a,h;return(o=Math.sqrt(n*n+t*t))&&(n/=o,t/=o),(h=n*e+t*r)&&(e-=n*h,r-=t*h),(a=Math.sqrt(e*e+r*r))&&(e/=a,r/=a,h/=a),n*r<t*e&&(n=-n,t=-t,h=-h,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(t,n)*eo,skewX:Math.atan(h)*eo,scaleX:o,scaleY:a}}var Pn;function Gl(n){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(n+"");return t.isIdentity?vi:qa(t.a,t.b,t.c,t.d,t.e,t.f)}function Ol(n){return n==null||(Pn||(Pn=document.createElementNS("http://www.w3.org/2000/svg","g")),Pn.setAttribute("transform",n),!(n=Pn.transform.baseVal.consolidate()))?vi:(n=n.matrix,qa(n.a,n.b,n.c,n.d,n.e,n.f))}function ja(n,t,e,r){function i(c){return c.length?c.pop()+" ":""}function s(c,l,u,d,f,p){if(c!==u||l!==d){var g=f.push("translate(",null,t,null,e);p.push({i:g-4,x:wt(c,u)},{i:g-2,x:wt(l,d)})}else(u||d)&&f.push("translate("+u+t+d+e)}function o(c,l,u,d){c!==l?(c-l>180?l+=360:l-c>180&&(c+=360),d.push({i:u.push(i(u)+"rotate(",null,r)-2,x:wt(c,l)})):l&&u.push(i(u)+"rotate("+l+r)}function a(c,l,u,d){c!==l?d.push({i:u.push(i(u)+"skewX(",null,r)-2,x:wt(c,l)}):l&&u.push(i(u)+"skewX("+l+r)}function h(c,l,u,d,f,p){if(c!==u||l!==d){var g=f.push(i(f)+"scale(",null,",",null,")");p.push({i:g-4,x:wt(c,u)},{i:g-2,x:wt(l,d)})}else(u!==1||d!==1)&&f.push(i(f)+"scale("+u+","+d+")")}return function(c,l){var u=[],d=[];return c=n(c),l=n(l),s(c.translateX,c.translateY,l.translateX,l.translateY,u,d),o(c.rotate,l.rotate,u,d),a(c.skewX,l.skewX,u,d),h(c.scaleX,c.scaleY,l.scaleX,l.scaleY,u,d),c=l=null,function(f){for(var p=-1,g=d.length,m;++p<g;)u[(m=d[p]).i]=m.x(f);return u.join("")}}}var zl=ja(Gl,"px, ","px)","deg)"),Nl=ja(Ol,", ",")",")"),Ul=1e-12;function no(n){return((n=Math.exp(n))+1/n)/2}function $l(n){return((n=Math.exp(n))-1/n)/2}function Hl(n){return((n=Math.exp(2*n))-1)/(n+1)}const Vl=(function n(t,e,r){function i(s,o){var a=s[0],h=s[1],c=s[2],l=o[0],u=o[1],d=o[2],f=l-a,p=u-h,g=f*f+p*p,m,y;if(g<Ul)y=Math.log(d/c)/t,m=function(A){return[a+A*f,h+A*p,c*Math.exp(t*A*y)]};else{var x=Math.sqrt(g),_=(d*d-c*c+r*g)/(2*c*e*x),b=(d*d-c*c-r*g)/(2*d*e*x),M=Math.log(Math.sqrt(_*_+1)-_),C=Math.log(Math.sqrt(b*b+1)-b);y=(C-M)/t,m=function(A){var E=A*y,I=no(M),T=c/(e*x)*(I*Hl(t*E+M)-$l(M));return[a+T*f,h+T*p,c*I/no(t*E+M)]}}return m.duration=y*1e3*t/Math.SQRT2,m}return i.rho=function(s){var o=Math.max(.001,+s),a=o*o,h=a*a;return n(o,a,h)},i})(Math.SQRT2,2,4);function Wl(n,t){for(var e=new Array(t),r=0;r<t;++r)e[r]=n(r/(t-1));return e}function Xl(n){return function(){return n}}function Yl(n){return+n}var ro=[0,1];function be(n){return n}function wi(n,t){return(t-=n=+n)?function(e){return(e-n)/t}:Xl(isNaN(t)?NaN:.5)}function ql(n,t){var e;return n>t&&(e=n,n=t,t=e),function(r){return Math.max(n,Math.min(t,r))}}function jl(n,t,e){var r=n[0],i=n[1],s=t[0],o=t[1];return i<r?(r=wi(i,r),s=e(o,s)):(r=wi(r,i),s=e(s,o)),function(a){return s(r(a))}}function Zl(n,t,e){var r=Math.min(n.length,t.length)-1,i=new Array(r),s=new Array(r),o=-1;for(n[r]<n[0]&&(n=n.slice().reverse(),t=t.slice().reverse());++o<r;)i[o]=wi(n[o],n[o+1]),s[o]=e(t[o],t[o+1]);return function(a){var h=sl(n,a,1,r)-1;return s[h](i[h](a))}}function Kl(n,t){return t.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}function Ql(){var n=ro,t=ro,e=as,r,i,s,o=be,a,h,c;function l(){var d=Math.min(n.length,t.length);return o!==be&&(o=ql(n[0],n[d-1])),a=d>2?Zl:jl,h=c=null,u}function u(d){return d==null||isNaN(d=+d)?s:(h||(h=a(n.map(r),t,e)))(r(o(d)))}return u.invert=function(d){return o(i((c||(c=a(t,n.map(r),wt)))(d)))},u.domain=function(d){return arguments.length?(n=Array.from(d,Yl),l()):n.slice()},u.range=function(d){return arguments.length?(t=Array.from(d),l()):t.slice()},u.rangeRound=function(d){return t=Array.from(d),e=Dl,l()},u.clamp=function(d){return arguments.length?(o=d?!0:be,l()):o!==be},u.interpolate=function(d){return arguments.length?(e=d,l()):e},u.unknown=function(d){return arguments.length?(s=d,u):s},function(d,f){return r=d,i=f,l()}}function Jl(){return Ql()(be,be)}function tu(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)}function rr(n,t){if((e=(n=t?n.toExponential(t-1):n.toExponential()).indexOf("e"))<0)return null;var e,r=n.slice(0,e);return[r.length>1?r[0]+r.slice(2):r,+n.slice(e+1)]}function ke(n){return n=rr(Math.abs(n)),n?n[1]:NaN}function eu(n,t){return function(e,r){for(var i=e.length,s=[],o=0,a=n[0],h=0;i>0&&a>0&&(h+a+1>r&&(a=Math.max(1,r-h)),s.push(e.substring(i-=a,i+a)),!((h+=a+1)>r));)a=n[o=(o+1)%n.length];return s.reverse().join(t)}}function nu(n){return function(t){return t.replace(/[0-9]/g,function(e){return n[+e]})}}var ru=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ir(n){if(!(t=ru.exec(n)))throw new Error("invalid format: "+n);var t;return new hs({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}ir.prototype=hs.prototype;function hs(n){this.fill=n.fill===void 0?" ":n.fill+"",this.align=n.align===void 0?">":n.align+"",this.sign=n.sign===void 0?"-":n.sign+"",this.symbol=n.symbol===void 0?"":n.symbol+"",this.zero=!!n.zero,this.width=n.width===void 0?void 0:+n.width,this.comma=!!n.comma,this.precision=n.precision===void 0?void 0:+n.precision,this.trim=!!n.trim,this.type=n.type===void 0?"":n.type+""}hs.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function iu(n){t:for(var t=n.length,e=1,r=-1,i;e<t;++e)switch(n[e]){case".":r=i=e;break;case"0":r===0&&(r=e),i=e;break;default:if(!+n[e])break t;r>0&&(r=0);break}return r>0?n.slice(0,r)+n.slice(i+1):n}var Za;function su(n,t){var e=rr(n,t);if(!e)return n+"";var r=e[0],i=e[1],s=i-(Za=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return s===o?r:s>o?r+new Array(s-o+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+rr(n,Math.max(0,t+s-1))[0]}function io(n,t){var e=rr(n,t);if(!e)return n+"";var r=e[0],i=e[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const so={"%":(n,t)=>(n*100).toFixed(t),b:n=>Math.round(n).toString(2),c:n=>n+"",d:tu,e:(n,t)=>n.toExponential(t),f:(n,t)=>n.toFixed(t),g:(n,t)=>n.toPrecision(t),o:n=>Math.round(n).toString(8),p:(n,t)=>io(n*100,t),r:io,s:su,X:n=>Math.round(n).toString(16).toUpperCase(),x:n=>Math.round(n).toString(16)};function oo(n){return n}var ao=Array.prototype.map,ho=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function ou(n){var t=n.grouping===void 0||n.thousands===void 0?oo:eu(ao.call(n.grouping,Number),n.thousands+""),e=n.currency===void 0?"":n.currency[0]+"",r=n.currency===void 0?"":n.currency[1]+"",i=n.decimal===void 0?".":n.decimal+"",s=n.numerals===void 0?oo:nu(ao.call(n.numerals,String)),o=n.percent===void 0?"%":n.percent+"",a=n.minus===void 0?"−":n.minus+"",h=n.nan===void 0?"NaN":n.nan+"";function c(u){u=ir(u);var d=u.fill,f=u.align,p=u.sign,g=u.symbol,m=u.zero,y=u.width,x=u.comma,_=u.precision,b=u.trim,M=u.type;M==="n"?(x=!0,M="g"):so[M]||(_===void 0&&(_=12),b=!0,M="g"),(m||d==="0"&&f==="=")&&(m=!0,d="0",f="=");var C=g==="$"?e:g==="#"&&/[boxX]/.test(M)?"0"+M.toLowerCase():"",A=g==="$"?r:/[%p]/.test(M)?o:"",E=so[M],I=/[defgprs%]/.test(M);_=_===void 0?6:/[gprs]/.test(M)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_));function T(P){var G=C,O=A,v,R,w;if(M==="c")O=E(P)+O,P="";else{P=+P;var S=P<0||1/P<0;if(P=isNaN(P)?h:E(Math.abs(P),_),b&&(P=iu(P)),S&&+P==0&&p!=="+"&&(S=!1),G=(S?p==="("?p:a:p==="-"||p==="("?"":p)+G,O=(M==="s"?ho[8+Za/3]:"")+O+(S&&p==="("?")":""),I){for(v=-1,R=P.length;++v<R;)if(w=P.charCodeAt(v),48>w||w>57){O=(w===46?i+P.slice(v+1):P.slice(v))+O,P=P.slice(0,v);break}}}x&&!m&&(P=t(P,1/0));var B=G.length+P.length+O.length,k=B<y?new Array(y-B+1).join(d):"";switch(x&&m&&(P=t(k+P,k.length?y-O.length:1/0),k=""),f){case"<":P=G+P+O+k;break;case"=":P=G+k+P+O;break;case"^":P=k.slice(0,B=k.length>>1)+G+P+O+k.slice(B);break;default:P=k+G+P+O;break}return s(P)}return T.toString=function(){return u+""},T}function l(u,d){var f=c((u=ir(u),u.type="f",u)),p=Math.max(-8,Math.min(8,Math.floor(ke(d)/3)))*3,g=Math.pow(10,-p),m=ho[8+p/3];return function(y){return f(g*y)+m}}return{format:c,formatPrefix:l}}var Tn,Ka,Qa;au({thousands:",",grouping:[3],currency:["$",""]});function au(n){return Tn=ou(n),Ka=Tn.format,Qa=Tn.formatPrefix,Tn}function hu(n){return Math.max(0,-ke(Math.abs(n)))}function cu(n,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(ke(t)/3)))*3-ke(Math.abs(n)))}function lu(n,t){return n=Math.abs(n),t=Math.abs(t)-n,Math.max(0,ke(t)-ke(n))+1}function uu(n,t,e,r){var i=fl(n,t,e),s;switch(r=ir(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(n),Math.abs(t));return r.precision==null&&!isNaN(s=cu(i,o))&&(r.precision=s),Qa(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=lu(i,Math.max(Math.abs(n),Math.abs(t))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=hu(i))&&(r.precision=s-(r.type==="%")*2);break}}return Ka(r)}function du(n){var t=n.domain;return n.ticks=function(e){var r=t();return dl(r[0],r[r.length-1],e??10)},n.tickFormat=function(e,r){var i=t();return uu(i[0],i[i.length-1],e??10,r)},n.nice=function(e){e==null&&(e=10);var r=t(),i=0,s=r.length-1,o=r[i],a=r[s],h,c,l=10;for(a<o&&(c=o,o=a,a=c,c=i,i=s,s=c);l-- >0;){if(c=yi(o,a,e),c===h)return r[i]=o,r[s]=a,t(r);if(c>0)o=Math.floor(o/c)*c,a=Math.ceil(a/c)*c;else if(c<0)o=Math.ceil(o*c)/c,a=Math.floor(a*c)/c;else break;h=c}return n},n}function sr(){var n=Jl();return n.copy=function(){return Kl(n,sr())},$a.apply(n,arguments),du(n)}const fu=Math.PI/180;function pu(n,t=0,e=1){return n<t?t:n>e?e:n}function jx(n){return n*fu}function Zx(n){const t=new Array(n),e=1/(n-1);t[0]=0;for(let r=1;r<n-1;r++)t[r]=r*e;return t[n-1]=1,t}function Oe(n,t,e){e===void 0&&(e=n);for(var r=0;r<n.length;r++)e[r]=n[r]+t[r];return e}function ze(n,t,e){e===void 0&&(e=n);for(var r=0;r<n.length;r++)e[r]=n[r]-t[r];return e}function oe(n,t,e){e===void 0&&(e=n);for(var r=0;r<n.length;r++)e[r]=n[r]*t;return e}function gu(n){for(var t=0,e=0;e<n.length;e++)t+=Math.pow(n[e],2);return t}function Ze(n){var t=gu(n);return t===0?t:Math.sqrt(t)}function co(n,t){t===void 0&&(t=n);var e=Ze(n);return e===0?mu(0,t):oe(n,1/e,t)}function mu(n,t){for(var e=0;e<t.length;e++)t[e]=n;return t}function yu(n,t){for(var e=0,r=0;r<n.length;r++)e+=Math.pow(t[r]-n[r],2);return e===0?e:Math.sqrt(e)}function xu(n,t){for(var e=0,r=0;r<n.length;r++)e+=n[r]*t[r];return e}function _u(n,t,e,r){r===void 0&&(r=n);for(var i=pu(e,0,1),s=1-i,o=0;o<n.length;o++)r[o]=n[o]*s+t[o]*i;return r}function bu(n,t,e){e===void 0&&(e=n);for(var r=0;r<n.length;r++)e[r]=t(n[r],r);return e}function lo(n,t){t===void 0&&(t=0),t===void 0&&(t=0);for(var e=0;e<n.length;e++)if(Math.abs(n[e])>t)return!1;return!0}var Lr=180/Math.PI,vu=Math.PI/180;function Dr(n,t,e){var r=Math.cos(t),i=Math.sin(t),s=n[0];return e[0]=r*s-i*n[1],e[1]=i*s+r*n[1],e}function uo(n){return Math.atan2(n[1],n[0])}function Ne(n,t){var e=Math.atan2(t[1],t[0])-Math.atan2(n[1],n[0]);return e>Math.PI?e-=2*Math.PI:e<=-Math.PI&&(e+=2*Math.PI),e}var Ja=(function(){function n(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];this.isMutating=!1,this.length=2,typeof t=="number"?typeof e[0]=="number"?(this[0]=t,this[1]=e[0]):(this[0]=t,this[1]=t):"x"in t&&"y"in t?(this[0]=t.x,this[1]=t.y):(this[0]=t[0],this[1]=t[1])}return Object.defineProperty(n.prototype,"x",{get:function(){return this[0]},set:function(t){this[0]=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this[1]},set:function(t){this[1]=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"magnitude",{get:function(){return Ze(this)},set:function(t){var e=Ze(this);oe(this,t/e,this)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"mutable",{get:function(){return this.isMutating=!0,this},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"immutable",{get:function(){return this.isMutating=!1,this},enumerable:!1,configurable:!0}),n.prototype.set=function(t,e){return typeof t=="number"?typeof e=="number"?(this[0]=t,this[1]=e):(this[0]=t,this[1]=t):(this[0]=t[0],this[1]=t[1]),this},n.prototype.add=function(t,e){return e===void 0&&(e=0),typeof t=="number"?this.isMutating?Oe(this,[t,e]):Oe(this.clone(),[t,e]):this.isMutating?Oe(this,t):Oe(this.clone(),t)},n.add=function(t,e){var r=new n(t);return Oe(r,e)},n.prototype.sub=function(t,e){return e===void 0&&(e=0),typeof t=="number"?this.isMutating?ze(this,[t,e]):ze(this.clone(),[t,e]):this.isMutating?ze(this,t):ze(this.clone(),t)},n.sub=function(t,e){var r=new n(t);return ze(r,e)},n.prototype.subFrom=function(t,e){return e===void 0&&(e=0),typeof t=="number"?this.isMutating?(this[0]=t-this[0],this[1]=e-this[1],this):new n(t-this[0],e-this[1]):this.isMutating?(this[0]=t[0]-this[0],this[1]=t[1]-this[1],this):new n(t[0]-this[0],t[1]-this[1])},n.divide=function(t,e){var r=new n(t);return oe(r,1/e)},n.multiply=function(t,e){var r=new n(t);return oe(r,e)},n.prototype.scale=function(t){return oe(this,t,this.isMutating?this:n.zero)},n.prototype.rescale=function(t){var e=Ze(this);return e<=0?this.isMutating?this:n.zero:oe(this,t/e,this.isMutating?this:n.zero)},n.prototype.clampMagnitude=function(t){var e=Ze(this);return e>t?oe(this,t/e,this.isMutating?this:n.zero):this.isMutating?this:this.clone()},n.prototype.rotate=function(t){return Dr(this,t,this.isMutating?this:n.zero)},n.prototype.rotateDeg=function(t){return Dr(this,t*vu,this.isMutating?this:n.zero)},n.prototype.rotate90=function(){return t=this,e=this.isMutating?this:n.zero,r=t[0],e[0]=-t[1],e[1]=r,e;var t,e,r},n.prototype.rotate180=function(){return t=this,(e=this.isMutating?this:n.zero)[0]=-t[0],e[1]=-t[1],e;var t,e},n.prototype.rotate270=function(){return t=this,e=this.isMutating?this:n.zero,r=t[0],e[0]=t[1],e[1]=-r,e;var t,e,r},n.prototype.normalize=function(){return co(this)},n.prototype.normalized=function(){return co(this,n.zero)},n.distance=function(t,e){return yu(t,e)},n.dot=function(t,e){return xu(t,e)},n.cross=function(t,e){return(function(r,i){return r[0]*i[1]-r[1]*i[0]})(t,e)},n.angleRight=function(t){return uo(t)},n.angleRightDeg=function(t){return uo(t)*Lr},n.angle=function(t,e){return Math.abs(Ne(t,e))},n.angleDeg=function(t,e){return Math.abs(Ne(t,e))*Lr},n.signedAngle=function(t,e){return Ne(t,e)},n.signedAngleDeg=function(t,e){return Ne(t,e)*Lr},n.lerp=function(t,e,r){var i=new n(t);return _u(i,e,r)},n.lerpRot=function(t,e,r){return(function(i,s,o,a){return a===void 0&&(a=i),Dr(i,o*Ne(i,s),a)})(t,e,r,n.zero)},n.prototype.clone=function(){return new n(this[0],this[1])},n.equals=function(t,e,r){return r===void 0&&(r=0),!(Math.abs(t[0]-e[0])>r)&&!(Math.abs(t[1]-e[1])>r)},n.prototype.equals=function(t,e){return e===void 0&&(e=0),n.equals(this,t,e)},n.isZeroVector=function(t,e){return e===void 0&&(e=0),lo(t,e)},n.prototype.isZeroVector=function(t){return t===void 0&&(t=0),lo(this,t)},n.prototype.toArray=function(){return[this[0],this[1]]},n.prototype.modify=function(t){return bu(this,t)},n.prototype[Symbol.iterator]=function(){var t=this,e=0;return{next:function(){switch(e++){case 0:return{value:t[0],done:!1};case 1:return{value:t[1],done:!1};default:return{value:-1,done:!0}}}}},Object.defineProperty(n,"zero",{get:function(){return new n(0,0)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"one",{get:function(){return new n(1,1)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"positiveInfinity",{get:function(){return new n(1/0,1/0)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"negativeInfinity",{get:function(){return new n(-1/0,-1/0)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"up",{get:function(){return new n(0,1)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"right",{get:function(){return new n(1,0)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"down",{get:function(){return new n(0,-1)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"left",{get:function(){return new n(-1,0)},enumerable:!1,configurable:!0}),n})();/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ai=function(n,t){return Ai=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])},Ai(n,t)};function th(n,t){function e(){this.constructor=n}Ai(n,t),n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var or=function(){return or=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++)for(var i in t=arguments[e])Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n},or.apply(this,arguments)};function fo(n,t){for(var e=new Array(n.length),r=0;r<n.length;r++)e[r]=2*n[r]-t[r];return e}function Ci(n,t,e){var r,i,s,o,a=t.length-1;if(e)r=t[n-1<0?a:n-1],i=t[n%t.length],s=t[(n+1)%t.length],o=t[(n+2)%t.length];else{if(n===a)throw Error("There is no spline segment at this index for a closed curve!");i=t[n],s=t[n+1],r=n>0?t[n-1]:fo(i,s),o=n<a-1?t[n+2]:fo(s,i)}return[r,i,s,o]}function wu(n,t,e){e===void 0&&(e=!1);var r=e?t.length:t.length-1;if(n===1)return{index:r-1,weight:1};var i=r*n,s=Math.floor(i);return{index:s,weight:i-s}}function Au(n,t){for(var e=0;e<n.length;e++)n[e]=t;return n}function Cu(n,t){for(var e=0;e<n.length;e++)n[e]=t(n[e],e);return n}function Mu(n,t,e){e===void 0&&(e=0);for(var r=0;r<n.length;r++)e=t(e,n[r],r);return e}function Xn(n,t){t=t||new Array(n.length);for(var e=0;e<n.length;e++)t[e]=n[e];return t}function ct(n,t,e){return t===void 0&&(t=0),e===void 0&&(e=1),n<t?t:n>e?e:n}function Mi(n,t){var e=t[0];if(n>=t[t.length-1])return t.length-1;if(n<=e)return 0;for(var r=0,i=t.length-1;r<=i;){var s=Math.floor((r+i)/2),o=t[s];if(o<n)r=s+1;else{if(!(o>n))return s;i=s-1}}return Math.max(0,i)}var yt=Math.pow(2,-42);function po(n){var t=Math.pow(Math.abs(n),.3333333333333333);return n<0?-t:t}function eh(n,t,e){if(Math.abs(n)<yt)return Math.abs(t)<yt?[]:[-e/t];var r=t*t-4*n*e;return Math.abs(r)<yt?[-t/(2*n)]:r>0?[(-t+Math.sqrt(r))/(2*n),(-t-Math.sqrt(r))/(2*n)]:[]}function Su(n,t,e,r){if(Math.abs(n)<yt)return eh(t,e,r);var i,s=(3*n*e-t*t)/(3*n*n),o=(2*t*t*t-9*n*t*e+27*n*n*r)/(27*n*n*n);if(Math.abs(s)<yt)i=[po(-o)];else if(Math.abs(o)<yt)i=[0].concat(s<0?[Math.sqrt(-s),-Math.sqrt(-s)]:[]);else{var a=o*o/4+s*s*s/27;if(Math.abs(a)<yt)i=[-1.5*o/s,3*o/s];else if(a>0)i=[(h=po(-o/2-Math.sqrt(a)))-s/(3*h)];else{var h=2*Math.sqrt(-s/3),c=Math.acos(3*o/s/h)/3,l=2*Math.PI/3;i=[h*Math.cos(c),h*Math.cos(c-l),h*Math.cos(c-2*l)]}}for(var u=0;u<i.length;u++)i[u]-=t/(3*n);return i}function kn(n,t){if(n.length!==t.length)throw Error("Vectors must be of equal length!");for(var e=0,r=0;r<n.length;r++)e+=n[r]*t[r];return e}function bt(n,t,e){if(!(n.length>3)){e=e||new Array(3);var r=n[0],i=n[1],s=n[2]||0,o=t[0],a=t[1],h=t[2]||0;return e[0]=i*h-s*a,e[1]=s*o-r*h,e[2]=r*a-i*o,e}}function nh(n,t){for(var e=0,r=0;r<n.length;r++)e+=(n[r]-t[r])*(n[r]-t[r]);return e}function de(n){for(var t=0,e=0;e<n.length;e++)t+=n[e]*n[e];return Math.sqrt(t)}function ar(n,t){var e=nh(n,t);return e===0?0:Math.sqrt(e)}function Ht(n,t){var e=t?Xn(n,t):n,r=Mu(e,(function(s,o){return s+Math.pow(o,2)})),i=Math.sqrt(r);return i===0?Au(e,0):Cu(e,(function(s){return s/i}))}function go(n,t,e,r){t===void 0&&(t=[0,1,0]),e===void 0&&(e=0);var i=Math.cos(e),s=Math.sin(e),o=1-i,a=n[0],h=n[1],c=n[2],l=t[0],u=t[1],d=t[2],f=o*l,p=o*u;return(r=r||n)[0]=(f*l+i)*a+(f*u-s*d)*h+(f*d+s*u)*c,r[1]=(f*u+s*d)*a+(p*u+i)*h+(p*d-s*l)*c,r[2]=(f*d-s*u)*a+(p*d+s*l)*h+(o*d*d+i)*c,r}function Pu(n,t,e,r,i){if(i===void 0&&(i=0),i===0)return[0,1,2,3];var s=function(h,c){return Math.pow(nh(h,c),.5*i)},o=s(t,n),a=s(e,t)+o;return[0,o,a,s(r,e)+a]}function Tu(n,t,e,r,i){for(var s=Number.isFinite(i.tension)?i.tension:.5,o=Number.isFinite(i.alpha)?i.alpha:null,a=o>0?Pu(n,t,e,r,o):null,h=new Array(n.length),c=0;c<n.length;c++){var l=0,u=0,d=n[c],f=t[c],p=e[c],g=r[c];if(a){var m=a[0],y=a[1],x=a[2],_=a[3];y-x!=0&&(m-y!=0&&m-x!=0&&(l=(1-s)*(x-y)*((d-f)/(m-y)-(d-p)/(m-x)+(f-p)/(y-x))),y-_!=0&&x-_!=0&&(u=(1-s)*(x-y)*((f-p)/(y-x)-(f-g)/(y-_)+(p-g)/(x-_))))}else l=(1-s)*(p-d)*.5,u=(1-s)*(g-f)*.5;var b=2*f-2*p+l+u,M=-3*f+3*p-2*l-u,C=l,A=f;h[c]=[b,M,C,A]}return h}function ve(n,t){var e=n*n,r=n*e;return t[0]*r+t[1]*e+t[2]*n+t[3]}function we(n,t){var e=n*n;return 3*t[0]*e+2*t[1]*n+t[2]}function Gr(n,t){return 6*t[0]*n+2*t[1]}function ku(n,t){var e=t[0],r=t[1],i=t[2],s=t[3]-n;return e===0&&r===0&&i===0&&s===0?[0]:Su(e,r,i,s).filter((function(o){return o>-yt&&o<=1+yt})).map((function(o){return ct(o,0,1)}))}function Si(n,t,e,r){r===void 0&&(r=null),r=r||new Array(e.length);for(var i=0;i<e.length;i++)r[i]=n(t,e[i]);return r}var rh=(function(){function n(t){t===void 0&&(t=null),this._alpha=0,this._tension=.5,this._closed=!1,this._onInvalidateCache=null,this._onInvalidateCache=t,this._cache={arcLengths:null,coefficients:null}}return n.prototype._invalidateCache=function(){this.points&&(this._cache={arcLengths:null,coefficients:null},this._onInvalidateCache&&this._onInvalidateCache())},Object.defineProperty(n.prototype,"alpha",{get:function(){return this._alpha},set:function(t){Number.isFinite(t)&&t!==this._alpha&&(this._invalidateCache(),this._alpha=t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"tension",{get:function(){return this._tension},set:function(t){Number.isFinite(t)&&t!==this._tension&&(this._invalidateCache(),this._tension=t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"points",{get:function(){return this._points},set:function(t){if(!t||t.length<2)throw Error("At least 2 control points are required!");this._points=t,this._invalidateCache()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"closed",{get:function(){return this._closed},set:function(t){t=!!t,this._closed!==t&&(this._invalidateCache(),this._closed=t)},enumerable:!1,configurable:!0}),n.prototype.reset=function(){this._invalidateCache()},n.prototype.evaluateForT=function(t,e,r){var i=wu(e,this.points,this.closed),s=i.index;return Si(t,i.weight,this.getCoefficients(s),r)},n.prototype.getCoefficients=function(t){if(this.points){if(this._cache.coefficients||(this._cache.coefficients=new Map),!this._cache.coefficients.has(t)){var e=Ci(t,this.points,this.closed),r=Tu(e[0],e[1],e[2],e[3],{tension:this.tension,alpha:this.alpha});this._cache.coefficients.set(t,r)}return this._cache.coefficients.get(t)}},n})(),Eu=(function(n){function t(e,r){e===void 0&&(e=300),r===void 0&&(r=null);var i=n.call(this,r)||this;return i._subDivisions=e,i}return th(t,n),Object.defineProperty(t.prototype,"arcLengths",{get:function(){return this._cache.arcLengths||(this._cache.arcLengths=this.computeArcLengths()),this._cache.arcLengths},enumerable:!1,configurable:!0}),t.prototype._invalidateCache=function(){n.prototype._invalidateCache.call(this),this._cache.arcLengths=null},t.prototype.computeArcLengths=function(){var e,r=[],i=this.evaluateForT(ve,0),s=0;r.push(0);for(var o=1;o<=this._subDivisions;o++)s+=ar(e=this.evaluateForT(ve,o/this._subDivisions),i),r.push(s),i=e;return r},t.prototype.lengthAt=function(e){var r=this.arcLengths;return e*r[r.length-1]},t.prototype.getT=function(e){var r=this.arcLengths,i=r.length,s=e*r[i-1],o=Mi(s,r);if(r[o]===s)return o/(i-1);var a=r[o];return(o+(s-a)/(r[o+1]-a))/(i-1)},t.prototype.getU=function(e){if(e===0)return 0;if(e===1)return 1;var r=this.arcLengths,i=r.length-1,s=r[i],o=e*i,a=Math.floor(o),h=r[a];if(o===a)return h/s;var c=a/i;return(h+ar(this.evaluateForT(ve,c),this.evaluateForT(ve,e)))/s},t})(rh),ih=[[[-.906179845938664,.23692688505618908],[-.5384693101056831,.47862867049936647],[0,.5688888888888889],[.5384693101056831,.47862867049936647],[.906179845938664,.23692688505618908]],[[-.932469514203152,.17132449237917036],[-.6612093864662645,.3607615730481386],[-.2386191860831969,.46791393457269104],[.2386191860831969,.46791393457269104],[.6612093864662645,.3607615730481386],[.932469514203152,.17132449237917036]],[[-.9491079123427585,.1294849661688697],[-.7415311855993945,.27970539148927664],[-.4058451513773972,.3818300505051189],[0,.4179591836734694],[.4058451513773972,.3818300505051189],[.7415311855993945,.27970539148927664],[.9491079123427585,.1294849661688697]],[[-.9602898564975363,.10122853629037626],[-.7966664774136267,.22238103445337448],[-.525532409916329,.31370664587788727],[-.1834346424956498,.362683783378362],[.1834346424956498,.362683783378362],[.525532409916329,.31370664587788727],[.7966664774136267,.22238103445337448],[.9602898564975363,.10122853629037626]],[[-.9681602395076261,.08127438836157441],[-.8360311073266358,.1806481606948574],[-.6133714327005904,.26061069640293544],[-.3242534234038089,.31234707704000286],[0,.3302393550012598],[.3242534234038089,.31234707704000286],[.6133714327005904,.26061069640293544],[.8360311073266358,.1806481606948574],[.9681602395076261,.08127438836157441]],[[-.9739065285171717,.06667134430868814],[-.8650633666889845,.1494513491505806],[-.6794095682990244,.21908636251598204],[-.4333953941292472,.26926671930999635],[-.14887433898163122,.29552422471475287],[.14887433898163122,.29552422471475287],[.4333953941292472,.26926671930999635],[.6794095682990244,.21908636251598204],[.8650633666889845,.1494513491505806],[.9739065285171717,.06667134430868814]],[[-.978228658146056,.0556685671161736],[-.887062599768095,.125580369464904],[-.730152005574049,.186290210927734],[-.519096129206811,.23319376459199],[-.269543155952344,.262804544510246],[0,.2729250867779],[.269543155952344,.262804544510246],[.519096129206811,.23319376459199],[.730152005574049,.186290210927734],[.887062599768095,.125580369464904],[.978228658146056,.0556685671161736]],[[-.981560634246719,.0471753363865118],[-.904117256370474,.106939325995318],[-.769902674194304,.160078328543346],[-.587317954286617,.203167426723065],[-.36783149899818,.233492536538354],[-.125233408511468,.249147045813402],[.125233408511468,.249147045813402],[.36783149899818,.233492536538354],[.587317954286617,.203167426723065],[.769902674194304,.160078328543346],[.904117256370474,.106939325995318],[.981560634246719,.0471753363865118]],[[-.984183054718588,.0404840047653158],[-.917598399222977,.0921214998377284],[-.801578090733309,.138873510219787],[-.64234933944034,.178145980761945],[-.448492751036446,.207816047536888],[-.230458315955134,.226283180262897],[0,.232551553230873],[.230458315955134,.226283180262897],[.448492751036446,.207816047536888],[.64234933944034,.178145980761945],[.801578090733309,.138873510219787],[.917598399222977,.0921214998377284],[.984183054718588,.0404840047653158]],[[-.986283808696812,.0351194603317518],[-.928434883663573,.0801580871597602],[-.827201315069764,.121518570687903],[-.687292904811685,.157203167158193],[-.515248636358154,.185538397477937],[-.319112368927889,.205198463721295],[-.108054948707343,.215263853463157],[.108054948707343,.215263853463157],[.319112368927889,.205198463721295],[.515248636358154,.185538397477937],[.687292904811685,.157203167158193],[.827201315069764,.121518570687903],[.928434883663573,.0801580871597602],[.986283808696812,.0351194603317518]],[[-.987992518020485,.0307532419961172],[-.937273392400705,.0703660474881081],[-.848206583410427,.107159220467171],[-.72441773136017,.139570677926154],[-.570972172608538,.166269205816993],[-.394151347077563,.186161000015562],[-.201194093997434,.198431485327111],[0,.202578241925561],[.201194093997434,.198431485327111],[.394151347077563,.186161000015562],[.570972172608538,.166269205816993],[.72441773136017,.139570677926154],[.848206583410427,.107159220467171],[.937273392400705,.0703660474881081],[.987992518020485,.0307532419961172]],[[-.989400934991649,.027152459411754],[-.944575023073232,.0622535239386478],[-.865631202387831,.0951585116824927],[-.755404408355003,.124628971255533],[-.617876244402643,.149595988816576],[-.458016777657227,.169156519395002],[-.281603550779258,.182603415044923],[-.0950125098376374,.189450610455068],[.0950125098376374,.189450610455068],[.281603550779258,.182603415044923],[.458016777657227,.169156519395002],[.617876244402643,.149595988816576],[.755404408355003,.124628971255533],[.865631202387831,.0951585116824927],[.944575023073232,.0622535239386478],[.989400934991649,.027152459411754]],[[-.990575475314417,.0241483028685479],[-.950675521768767,.0554595293739872],[-.880239153726985,.0850361483171791],[-.781514003896801,.111883847193403],[-.65767115921669,.135136368468525],[-.512690537086476,.15404576107681],[-.351231763453876,.16800410215645],[-.178484181495847,.176562705366992],[0,.179446470356206],[.178484181495847,.176562705366992],[.351231763453876,.16800410215645],[.512690537086476,.15404576107681],[.65767115921669,.135136368468525],[.781514003896801,.111883847193403],[.880239153726985,.0850361483171791],[.950675521768767,.0554595293739872],[.990575475314417,.0241483028685479]],[[-.99156516842093,.0216160135264833],[-.955823949571397,.0497145488949698],[-.892602466497555,.076425730254889],[-.803704958972523,.100942044106287],[-.691687043060353,.122555206711478],[-.559770831073947,.14064291467065],[-.411751161462842,.154684675126265],[-.251886225691505,.164276483745832],[-.0847750130417353,.169142382963143],[.0847750130417353,.169142382963143],[.251886225691505,.164276483745832],[.411751161462842,.154684675126265],[.559770831073947,.14064291467065],[.691687043060353,.122555206711478],[.803704958972523,.100942044106287],[.892602466497555,.076425730254889],[.955823949571397,.0497145488949697],[.99156516842093,.0216160135264833]],[[-.992406843843584,.0194617882297264],[-.96020815213483,.0448142267656996],[-.903155903614817,.0690445427376412],[-.822714656537142,.0914900216224499],[-.720966177335229,.111566645547333],[-.600545304661681,.128753962539336],[-.46457074137596,.142606702173606],[-.316564099963629,.152766042065859],[-.160358645640225,.158968843393954],[0,.161054449848783],[.160358645640225,.158968843393954],[.316564099963629,.152766042065859],[.46457074137596,.142606702173606],[.600545304661681,.128753962539336],[.720966177335229,.111566645547333],[.822714656537142,.0914900216224499],[.903155903614817,.0690445427376412],[.96020815213483,.0448142267656996],[.992406843843584,.0194617882297264]],[[-.993128599185094,.0176140071391521],[-.963971927277913,.0406014298003869],[-.912234428251325,.062672048334109],[-.839116971822218,.0832767415767047],[-.74633190646015,.10193011981724],[-.636053680726515,.118194531961518],[-.510867001950827,.131688638449176],[-.373706088715419,.142096109318382],[-.227785851141645,.149172986472603],[-.0765265211334973,.152753387130725],[.0765265211334973,.152753387130725],[.227785851141645,.149172986472603],[.373706088715419,.142096109318382],[.510867001950827,.131688638449176],[.636053680726515,.118194531961518],[.74633190646015,.10193011981724],[.839116971822218,.0832767415767047],[.912234428251325,.062672048334109],[.963971927277913,.0406014298003869],[.993128599185094,.0176140071391521]],[[-.993752170620389,.0160172282577743],[-.967226838566306,.0369537897708524],[-.9200993341504,.0571344254268572],[-.853363364583317,.0761001136283793],[-.768439963475677,.0934444234560338],[-.667138804197412,.108797299167148],[-.551618835887219,.121831416053728],[-.424342120207438,.132268938633337],[-.288021316802401,.139887394791073],[-.145561854160895,.14452440398997],[0,.14608113364969],[.145561854160895,.14452440398997],[.288021316802401,.139887394791073],[.424342120207438,.132268938633337],[.551618835887219,.121831416053728],[.667138804197412,.108797299167148],[.768439963475677,.0934444234560338],[.853363364583317,.0761001136283793],[.9200993341504,.0571344254268572],[.967226838566306,.0369537897708524],[.993752170620389,.0160172282577743]],[[-.994294585482399,.0146279952982722],[-.970060497835428,.0337749015848141],[-.926956772187174,.0522933351526832],[-.8658125777203,.0697964684245204],[-.787816805979208,.0859416062170677],[-.694487263186682,.10041414444288],[-.587640403506911,.112932296080539],[-.469355837986757,.123252376810512],[-.341935820892084,.131173504787062],[-.207860426688221,.136541498346015],[-.0697392733197222,.139251872855631],[.0697392733197222,.139251872855631],[.207860426688221,.136541498346015],[.341935820892084,.131173504787062],[.469355837986757,.123252376810512],[.587640403506911,.112932296080539],[.694487263186682,.10041414444288],[.787816805979208,.0859416062170677],[.8658125777203,.0697964684245204],[.926956772187174,.0522933351526832],[.970060497835428,.0337749015848141],[.994294585482399,.0146279952982722]],[[-.994769334997552,.0134118594871417],[-.972542471218115,.0309880058569794],[-.932971086826016,.0480376717310846],[-.876752358270441,.0642324214085258],[-.804888401618839,.0792814117767189],[-.71866136313195,.0929157660600351],[-.619609875763646,.104892091464541],[-.509501477846007,.114996640222411],[-.39030103803029,.123049084306729],[-.264135680970344,.128905722188082],[-.133256824298466,.132462039404696],[0,.133654572186106],[.133256824298466,.132462039404696],[.264135680970344,.128905722188082],[.39030103803029,.123049084306729],[.509501477846007,.114996640222411],[.619609875763646,.104892091464541],[.71866136313195,.0929157660600351],[.804888401618839,.0792814117767189],[.876752358270441,.0642324214085258],[.932971086826016,.0480376717310846],[.972542471218115,.0309880058569794],[.994769334997552,.0134118594871417]],[[-.995187219997021,.0123412297999872],[-.974728555971309,.0285313886289336],[-.938274552002732,.0442774388174198],[-.886415527004401,.0592985849154367],[-.820001985973902,.0733464814110803],[-.740124191578554,.0861901615319532],[-.648093651936975,.0976186521041138],[-.545421471388839,.107444270115965],[-.433793507626045,.115505668053725],[-.315042679696163,.121670472927803],[-.191118867473616,.125837456346828],[-.0640568928626056,.127938195346752],[.0640568928626056,.127938195346752],[.191118867473616,.125837456346828],[.315042679696163,.121670472927803],[.433793507626045,.115505668053725],[.545421471388839,.107444270115965],[.648093651936975,.0976186521041138],[.740124191578554,.0861901615319532],[.820001985973902,.0733464814110803],[.886415527004401,.0592985849154367],[.938274552002732,.0442774388174198],[.974728555971309,.0285313886289336],[.995187219997021,.0123412297999872]],[[-.995556969790498,.0113937985010262],[-.976663921459517,.0263549866150321],[-.942974571228974,.0409391567013063],[-.894991997878275,.0549046959758351],[-.833442628760834,.0680383338123569],[-.759259263037357,.080140700335001],[-.673566368473468,.0910282619829636],[-.577662930241222,.10053594906705],[-.473002731445714,.108519624474263],[-.361172305809387,.114858259145711],[-.243866883720988,.119455763535784],[-.12286469261071,.12224244299031],[0,.123176053726715],[.12286469261071,.12224244299031],[.243866883720988,.119455763535784],[.361172305809387,.114858259145711],[.473002731445714,.108519624474263],[.577662930241222,.10053594906705],[.673566368473468,.0910282619829636],[.759259263037357,.080140700335001],[.833442628760834,.0680383338123569],[.894991997878275,.0549046959758351],[.942974571228974,.0409391567013063],[.976663921459517,.0263549866150321],[.995556969790498,.0113937985010262]],[[-.995885701145616,.010551372617343],[-.97838544595647,.0244178510926319],[-.947159066661714,.0379623832943627],[-.902637861984307,.0509758252971478],[-.845445942788498,.0632740463295748],[-.776385948820678,.0746841497656597],[-.696427260419957,.0850458943134852],[-.606692293017618,.0942138003559141],[-.508440714824505,.102059161094425],[-.403051755123486,.108471840528576],[-.292004839485956,.113361816546319],[-.17685882035689,.116660443485296],[-.0592300934293132,.118321415279262],[.0592300934293132,.118321415279262],[.17685882035689,.116660443485296],[.292004839485956,.113361816546319],[.403051755123486,.108471840528576],[.508440714824505,.102059161094425],[.606692293017618,.0942138003559141],[.696427260419957,.0850458943134852],[.776385948820678,.0746841497656597],[.845445942788498,.0632740463295748],[.902637861984307,.0509758252971478],[.947159066661714,.0379623832943627],[.97838544595647,.0244178510926319],[.995885701145616,.010551372617343]],[[-.996179262888988,.00979899605129436],[-.979923475961501,.0226862315961806],[-.950900557814705,.0352970537574197],[-.909482320677491,.047449412520615],[-.856207908018294,.0589835368598335],[-.791771639070508,.0697488237662455],[-.717013473739423,.0796048677730577],[-.632907971946495,.0884231585437569],[-.540551564579456,.0960887273700285],[-.441148251750026,.102501637817745],[-.335993903638508,.107578285788533],[-.226459365439536,.111252488356845],[-.113972585609529,.113476346108965],[0,.114220867378956],[.113972585609529,.113476346108965],[.226459365439536,.111252488356845],[.335993903638508,.107578285788533],[.441148251750026,.102501637817745],[.540551564579456,.0960887273700285],[.632907971946495,.0884231585437569],[.717013473739423,.0796048677730577],[.791771639070508,.0697488237662455],[.856207908018294,.0589835368598336],[.909482320677491,.047449412520615],[.950900557814705,.0352970537574197],[.979923475961501,.0226862315961806],[.996179262888988,.00979899605129436]],[[-.996442497573954,.00912428259309452],[-.981303165370872,.0211321125927712],[-.954259280628938,.0329014277823043],[-.915633026392132,.0442729347590042],[-.865892522574395,.0551073456757167],[-.805641370917179,.0652729239669995],[-.735610878013631,.0746462142345687],[-.656651094038864,.0831134172289012],[-.569720471811401,.0905717443930328],[-.475874224955118,.0969306579979299],[-.376251516089078,.10211296757806],[-.272061627635178,.106055765922846],[-.16456928213338,.108711192258294],[-.0550792898840342,.110047013016475],[.0550792898840342,.110047013016475],[.16456928213338,.108711192258294],[.272061627635178,.106055765922846],[.376251516089078,.10211296757806],[.475874224955118,.0969306579979299],[.569720471811401,.0905717443930328],[.656651094038864,.0831134172289012],[.735610878013631,.0746462142345687],[.805641370917179,.0652729239669995],[.865892522574395,.0551073456757167],[.915633026392132,.0442729347590042],[.954259280628938,.0329014277823043],[.981303165370872,.0211321125927712],[.996442497573954,.00912428259309452]],[[-.996679442260596,.00851690387874641],[-.982545505261413,.0197320850561227],[-.957285595778087,.0307404922020936],[-.921180232953058,.0414020625186828],[-.874637804920102,.0515948269024979],[-.818185487615252,.0612030906570791],[-.752462851734477,.0701179332550512],[-.678214537602686,.0782383271357637],[-.596281797138227,.0854722573661725],[-.507592955124227,.0917377571392587],[-.413152888174008,.0969638340944086],[-.314031637867639,.101091273759914],[-.211352286166001,.104073310077729],[-.106278230132679,.10587615509732],[0,.106479381718314],[.106278230132679,.10587615509732],[.211352286166001,.104073310077729],[.314031637867639,.101091273759914],[.413152888174008,.0969638340944086],[.507592955124227,.0917377571392587],[.596281797138227,.0854722573661725],[.678214537602686,.0782383271357637],[.752462851734477,.0701179332550512],[.818185487615252,.0612030906570791],[.874637804920102,.0515948269024979],[.921180232953058,.0414020625186828],[.957285595778087,.0307404922020936],[.982545505261413,.0197320850561227],[.996679442260596,.00851690387874641]],[[-.996893484074649,.0079681924961666],[-.983668123279747,.0184664683110909],[-.960021864968307,.0287847078833233],[-.926200047429274,.038799192569627],[-.882560535792052,.048402672830594],[-.829565762382768,.057493156217619],[-.767777432104826,.0659742298821805],[-.697850494793315,.0737559747377052],[-.620526182989242,.0807558952294202],[-.536624148142019,.0868997872010829],[-.447033769538089,.0921225222377861],[-.352704725530878,.0963687371746442],[-.254636926167889,.0995934205867952],[-.153869913608583,.101762389748405],[-.0514718425553176,.102852652893558],[.0514718425553176,.102852652893558],[.153869913608583,.101762389748405],[.254636926167889,.0995934205867952],[.352704725530878,.0963687371746442],[.447033769538089,.0921225222377861],[.536624148142019,.0868997872010829],[.620526182989242,.0807558952294202],[.697850494793315,.0737559747377052],[.767777432104826,.0659742298821805],[.829565762382768,.057493156217619],[.882560535792052,.048402672830594],[.926200047429274,.038799192569627],[.960021864968307,.0287847078833233],[.983668123279747,.0184664683110909],[.996893484074649,.0079681924961666]]],mo=ih.length+5,Iu=(function(n){function t(e,r,i){e===void 0&&(e=24),r===void 0&&(r=21);var s=n.call(this,i)||this;return s._nSamples=21,s._gauss=(function(o){if(o<5||o>mo)throw Error("Order for Gaussian Quadrature must be in the range of ".concat(5," and ").concat(mo,"."));return ih[o-5]})(e),s._nSamples=r,s}return th(t,n),t.prototype._invalidateCache=function(){n.prototype._invalidateCache.call(this),this._cache.arcLengths=null,this._cache.samples=null},Object.defineProperty(t.prototype,"arcLengths",{get:function(){return this._cache.arcLengths||(this._cache.arcLengths=this.computeArcLengths()),this._cache.arcLengths},enumerable:!1,configurable:!0}),t.prototype.getSamples=function(e){if(this.points){if(this._cache.samples||(this._cache.samples=new Map),!this._cache.samples.has(e)){for(var r=this._nSamples,i=[],s=[],o=this.getCoefficients(e),a=0;a<r;++a){var h=a/(r-1);i.push(this.computeArcLength(e,0,h));var c=de(Si(we,h,o)),l=c===0?0:1/c;this.tension>.95&&(l=ct(l,-1,1)),s.push(l)}var u=r-1,d=[],f=[],p=i[0],g=s[0],m=1/u;for(a=0;a<u;++a){var y=p,x=(p=i[a+1])-y,_=g,b=s[a+1];g=b;var M=m/x,C=(_+b-2*M)/(x*x),A=(3*M-2*_-b)/x;d.push(C),f.push(A)}this._cache.samples.set(e,[i,s,f,d])}return this._cache.samples.get(e)}},t.prototype.computeArcLength=function(e,r,i){if(r===void 0&&(r=0),i===void 0&&(i=1),r===i)return 0;for(var s=this.getCoefficients(e),o=.5*(i-r),a=0,h=0;h<this._gauss.length;h++){var c=this._gauss[h],l=c[0];a+=c[1]*de(Si(we,o*l+o+r,s))}return o*a},t.prototype.computeArcLengths=function(){if(this.points){var e=[];e.push(0);for(var r=this.closed?this.points.length:this.points.length-1,i=0,s=0;s<r;s++)i+=this.computeArcLength(s),e.push(i);return e}},t.prototype.inverse=function(e,r){var i=1/(this._nSamples-1),s=this.getSamples(e),o=s[0],a=s[1],h=s[2],c=s[3];if(r>=o[o.length-1])return 1;if(r<=0)return 0;var l=Math.max(0,Mi(r,o)),u=l*i;if(o[l]===r)return u;var d=a[l],f=c[l],p=h[l],g=r-o[l];return((f*g+p)*g+d)*g+u},t.prototype.lengthAt=function(e){return e*this.arcLengths[this.arcLengths.length-1]},t.prototype.getT=function(e){var r=this.arcLengths,i=r.length,s=e*r[i-1],o=Mi(s,r),a=o/(i-1);if(r[o]===s)return a;var h=s-r[o];return(o+this.inverse(o,h))/(i-1)},t.prototype.getU=function(e){if(e===0)return 0;if(e===1)return 1;var r=this.arcLengths,i=r.length-1,s=r[i],o=e*i,a=Math.floor(o),h=r[a];if(o===a)return h/s;var c=o-a;return(h+this.computeArcLength(a,0,c))/s},t})(rh),Kx=(function(){function n(t,e){e===void 0&&(e={});var r=this;this._cache=new Map;var i=(e=or({tension:.5,alpha:0,closed:!1},e)).arcDivisions?new Eu(e.arcDivisions,(function(){return r._invalidateCache()})):new Iu(e.numericalApproximationOrder,e.numericalInverseSamples,(function(){return r._invalidateCache()}));i.alpha=e.alpha,i.tension=e.tension,i.closed=e.closed,i.points=t,this._lmargin=e.lmargin||1-i.tension,this._curveMapper=i}return n.prototype.getTimeFromPosition=function(t,e){return e===void 0&&(e=!1),this._curveMapper.getT(e?ct(t,0,1):t)},n.prototype.getPositionFromTime=function(t,e){return e===void 0&&(e=!1),this._curveMapper.getU(e?ct(t,0,1):t)},n.prototype.getPositionFromLength=function(t,e){e===void 0&&(e=!1);var r=e?ct(t,0,this.length):t;return this._curveMapper.getU(r/this.length)},n.prototype.getLengthAt=function(t,e){return t===void 0&&(t=1),e===void 0&&(e=!1),this._curveMapper.lengthAt(e?ct(t,0,1):t)},n.prototype.getTimeAtKnot=function(t){if(t<0||t>this.points.length-1)throw Error("Invalid index!");return t===0?0:this.closed||t!==this.points.length-1?t/(this.closed?this.points.length:this.points.length-1):1},n.prototype.getPositionAtKnot=function(t){return this.getPositionFromTime(this.getTimeAtKnot(t))},n.prototype.getPointAtTime=function(t,e){return(t=ct(t,0,1))===0?Xn(this.points[0],e):t===1?Xn(this.closed?this.points[0]:this.points[this.points.length-1],e):this._curveMapper.evaluateForT(ve,t,e)},n.prototype.getPointAt=function(t,e){return this.getPointAtTime(this.getTimeFromPosition(t),e)},n.prototype.getTangentAt=function(t,e){var r=ct(this.getTimeFromPosition(t),0,1);return this.getTangentAtTime(r,e)},n.prototype.getTangentAtTime=function(t,e){return Ht(this._curveMapper.evaluateForT(we,t,e))},n.prototype.getNormalAt=function(t,e){var r=ct(this.getTimeFromPosition(t),0,1);return this.getNormalAtTime(r,e)},n.prototype.getNormalAtTime=function(t,e){var r=Ht(this._curveMapper.evaluateForT(we,t));if(!(r.length<2||r.length>3)){var i=e||new Array(r.length);if(r.length===2)return i[0]=-r[1],i[1]=r[0],i;var s=Ht(this._curveMapper.evaluateForT(Gr,t));return Ht(bt(bt(r,s),r),i)}},n.prototype.getFrenetFrames=function(t,e,r){if(e===void 0&&(e=0),r===void 0&&(r=1),!(e<0||r>1||r<e)){for(var i=new Array(t+1),s=new Array(t+1),o=0;o<=t;o++){var a=e===0&&r===1?o/t:e+o/t*(r-e);i[o]=this.getTangentAt(a)}if(this.dim===2){for(o=0;o<i.length;o++)s[o]=[-i[o][1],i[o][0]];return{tangents:i,normals:s}}if(this.dim===3){var h=new Array(t+1),c=void 0,l=Number.MAX_VALUE,u=Math.abs(i[0][0]),d=Math.abs(i[0][1]);u<=l&&(l=u,c=[1,0,0]),d<=l&&(l=d,c=[0,1,0]),Math.abs(i[0][2])<=l&&(c=[0,0,1]);var f=Ht(bt(i[0],c));for(s[0]=bt(i[0],f),h[0]=bt(i[0],s[0]),o=1;o<=t;o++){if(f=bt(i[o-1],i[o]),s[o]=Xn(s[o-1]),de(f)>yt){Ht(f);var p=Math.acos(ct(kn(i[o-1],i[o]),-1,1));go(s[o-1],f,p,s[o])}h[o]=bt(i[o],s[o])}if(this.closed===!0)for(p=Math.acos(ct(kn(s[0],s[t]),-1,1))/t,kn(i[0],bt(s[0],s[t]))>0&&(p=-p),o=1;o<=t;o++)go(s[o],i[o],p*o,s[o]),h[o]=bt(i[o],s[o]);return{tangents:i,normals:s,binormals:h}}}},n.prototype.getCurvatureAt=function(t){var e=ct(this.getTimeFromPosition(t),0,1);return this.getCurvatureAtTime(e)},n.prototype.getCurvatureAtTime=function(t){var e=this._curveMapper.evaluateForT(we,t),r=this._curveMapper.evaluateForT(Gr,t),i=Ht(e,[]),s=0,o=void 0;if(e.length===2){if((u=Math.pow(e[0]*e[0]+e[1]*e[1],1.5))!==0){var a=(e[0]*r[1]-e[1]*r[0])/u;o=a<0?[i[1],-i[0]]:[-i[1],i[0]],s=Math.abs(a)}}else if(e.length===3){var h=de(e),c=bt(e,r);o=Ht(bt(c,e)),h!==0&&(s=de(c)/Math.pow(h,3))}else{h=de(e);var l=de(r),u=Math.pow(h,3),d=kn(e,r);u!==0&&(s=Math.sqrt(Math.pow(h,2)*Math.pow(l,2)-Math.pow(d,2))/u)}return{curvature:s,radius:s!==0?1/s:0,tangent:i,direction:o}},n.prototype.getDerivativeAt=function(t,e){var r=ct(this.getTimeFromPosition(t),0,1);return this._curveMapper.evaluateForT(we,r,e)},n.prototype.getSecondDerivativeAt=function(t,e){var r=ct(this.getTimeFromPosition(t),0,1);return this._curveMapper.evaluateForT(Gr,r,e)},n.prototype.getBoundingBox=function(t,e){if(t===void 0&&(t=0),e===void 0&&(e=1),t===0&&e===1&&this._cache.has("bbox"))return this._cache.get("bbox");for(var r=[],i=[],s=this.getTimeFromPosition(t),o=this.getTimeFromPosition(e),a=this.getPointAtTime(s),h=this.getPointAtTime(o),c=this.closed?this.points.length:this.points.length-1,l=Math.floor(c*s),u=Math.ceil(c*o),d=0;d<a.length;d++)r[d]=Math.min(a[d],h[d]),i[d]=Math.max(a[d],h[d]);for(var f=function(y){var x=Ci(y-1,p.points,p.closed)[2];if(y<u)for(var _=0;_<x.length;_++)x[_]<r[_]&&(r[_]=x[_]),x[_]>i[_]&&(i[_]=x[_]);if(p.tension<1){var b=c*s-(y-1),M=c*o-(y-1),C=function(I){return I>-yt&&I<=1+yt&&(y-1!==l||I>b)&&(y!==u||I<M)},A=p._curveMapper.getCoefficients(y-1),E=function(I){var T=A[I];eh(3*T[0],2*T[1],T[2]).filter(C).forEach((function(P){var G=ve(P,A[I]);G<r[I]&&(r[I]=G),G>i[I]&&(i[I]=G)}))};for(_=0;_<A.length;_++)E(_)}},p=this,g=l+1;g<=u;g++)f(g);var m={min:r,max:i};return t===0&&e===1&&this._cache.set("bbox",m),m},n.prototype.getPoints=function(t,e,r,i){if(t===void 0&&(t=100),r===void 0&&(r=0),i===void 0&&(i=1),!t||t<=0)throw Error("Invalid arguments passed to getPoints(). You must specify at least 1 sample/segment.");if(!(r<0||i>1||i<r)){for(var s=[],o=0;o<=t;o++){var a=r===0&&i===1?o/t:r+o/t*(i-r);s.push(this.getPointAt(a,e&&new e))}return s}},n.prototype.getNearestPosition=function(t,e,r){var i=this;if(e===void 0&&(e=1e-5),e<=0||!Number.isFinite(e))throw Error("Invalid threshold. Must be a number greater than zero!");r=r||10*this.points.length-1;var s=new Array(t.length),o=1/0,a=0,h=this.createLookupTable((function(d){return i.getPointAt(d)}),r,{cacheKey:"lut_nearest_".concat(r)});Array.from(h.keys()).forEach((function(d){var f=h.get(d),p=ar(t,f);if(p<o)return o=p,a=d,!0}));for(var c=this.getTimeFromPosition(a),l=function(d){if(d>=0&&d<=1){i.getPointAtTime(d,s);var f=ar(t,s);if(f<o)return o=f,c=d,!0}},u=.005;u>e;)l(c-u)||l(c+u)||(u/=2);return{u:a=this._curveMapper.getU(c),distance:o,point:s}},n.prototype.getIntersects=function(t,e,r,i){var s=this;e===void 0&&(e=0),r===void 0&&(r=0),i===void 0&&(i=this._lmargin);var o=this.getIntersectsAsTime(t,e,r,i).map((function(a){return s.getPointAtTime(a)}));return Math.abs(r)===1?o.length===1?o[0]:null:o},n.prototype.getIntersectsAsPositions=function(t,e,r,i){var s=this;return e===void 0&&(e=0),r===void 0&&(r=0),i===void 0&&(i=this._lmargin),this.getIntersectsAsTime(t,e,r,i).map((function(o){return s.getPositionFromTime(o)}))},n.prototype.getIntersectsAsTime=function(t,e,r,i){e===void 0&&(e=0),r===void 0&&(r=0),i===void 0&&(i=this._lmargin);for(var s=e,o=new Set,a=this.closed?this.points.length:this.points.length-1,h=0;h<a&&(r===0||o.size<Math.abs(r));h+=1){var c=r<0?a-(h+1):h,l=Ci(c,this.points,this.closed),u=l[1],d=l[2],f=this._curveMapper.getCoefficients(c),p=void 0,g=void 0;if(u[s]<d[s]?(p=u[s],g=d[s]):(p=d[s],g=u[s]),t-i<=g&&t+i>=p){var m=ku(t,f[s]);r<0?m.sort((function(_,b){return b-_})):r>=0&&m.sort((function(_,b){return _-b}));for(var y=0;y<m.length;y++){var x=(m[y]+c)/a;if(o.add(x),r!==0&&o.size===Math.abs(r))break}}}return Array.from(o)},n.prototype.createLookupTable=function(t,e,r){if(!e||e<=1)throw Error("Invalid arguments passed to createLookupTable(). You must specify at least 2 samples.");var i=or({from:0,to:1,cacheForceUpdate:!1},r),s=i.from,o=i.to,a=i.cacheKey,h=i.cacheForceUpdate;if(!(s<0||o>1||o<s)){var c=null;if(a&&!h&&this._cache.has(a))a&&this._cache.has(a)&&(c=this._cache.get(a));else{c=new Map;for(var l=0;l<e;l++){var u=s===0&&o===1?l/(e-1):s+l/(e-1)*(o-s),d=t(u);c.set(u,d)}a&&this._cache.set(a,c)}return c}},n.prototype.forEach=function(t,e,r,i){var s=this;r===void 0&&(r=0),i===void 0&&(i=1);var o=[];if(Number.isFinite(e)){var a=e;if(a<=1)throw Error("Invalid arguments passed to forEach(). You must specify at least 2 samples.");for(var h=0;h<a;h++){var c=r===0&&i===1?h/(a-1):r+h/(a-1)*(i-r);o.push(c)}}else Array.isArray(e)&&(o=e);var l=null;o.forEach((function(u,d){if(!Number.isFinite(u)||u<0||u>1)throw Error("Invalid position (u) for sample in forEach!");var f=s.getTimeFromPosition(u),p=t({u,t:f,i:d,prev:l});l={u,t:f,i:d,value:p}}))},n.prototype.map=function(t,e,r,i){var s=this;r===void 0&&(r=0),i===void 0&&(i=1);var o=[];if(Number.isFinite(e)){var a=e;if(a<=1)throw Error("Invalid arguments passed to map(). You must specify at least 2 samples.");for(var h=0;h<a;h++){var c=r===0&&i===1?h/(a-1):r+h/(a-1)*(i-r);o.push(c)}}else Array.isArray(e)&&(o=e);var l=null;return o.map((function(u,d){if(!Number.isFinite(u)||u<0||u>1)throw Error("Invalid position (u) for sample in map()!");var f=s.getTimeFromPosition(u),p=t({u,t:f,i:d,prev:l});return l={u,t:f,i:d,value:p},p}))},n.prototype.reduce=function(t,e,r,i,s){var o=this;i===void 0&&(i=0),s===void 0&&(s=1);var a=[];if(Number.isFinite(r)){var h=r;if(h<=1)throw Error("Invalid arguments passed to map(). You must specify at least 2 samples.");for(var c=0;c<h;c++){var l=i===0&&s===1?c/(h-1):i+c/(h-1)*(s-i);a.push(l)}}else Array.isArray(r)&&(a=r);return a.reduce((function(u,d,f){if(!Number.isFinite(d)||d<0||d>1)throw Error("Invalid position (u) for sample in map()!");var p=o.getTimeFromPosition(d);return t({acc:u,u:d,t:p,i:f})}),e)},n.prototype._invalidateCache=function(){return this._cache=new Map,this},n.prototype.reset=function(){this._curveMapper.reset()},Object.defineProperty(n.prototype,"points",{get:function(){return this._curveMapper.points},set:function(t){this._curveMapper.points=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"tension",{get:function(){return this._curveMapper.tension},set:function(t){this._curveMapper.tension=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"alpha",{get:function(){return this._curveMapper.alpha},set:function(t){this._curveMapper.alpha=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"closed",{get:function(){return this._curveMapper.closed},set:function(t){this._curveMapper.closed=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"length",{get:function(){return this._curveMapper.lengthAt(1)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"minX",{get:function(){return this.getBoundingBox().min[0]},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"maxX",{get:function(){return this.getBoundingBox().max[0]},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"minY",{get:function(){return this.getBoundingBox().min[1]},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"maxY",{get:function(){return this.getBoundingBox().max[1]},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"minZ",{get:function(){return this.getBoundingBox().min[2]},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"maxZ",{get:function(){return this.getBoundingBox().max[2]},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dim",{get:function(){var t;return((t=this.points[0])===null||t===void 0?void 0:t.length)||void 0},enumerable:!1,configurable:!0}),n})(),Pi="http://www.w3.org/1999/xhtml";const yo={svg:"http://www.w3.org/2000/svg",xhtml:Pi,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function yr(n){var t=n+="",e=t.indexOf(":");return e>=0&&(t=n.slice(0,e))!=="xmlns"&&(n=n.slice(e+1)),yo.hasOwnProperty(t)?{space:yo[t],local:n}:n}function Ru(n){return function(){var t=this.ownerDocument,e=this.namespaceURI;return e===Pi&&t.documentElement.namespaceURI===Pi?t.createElement(n):t.createElementNS(e,n)}}function Fu(n){return function(){return this.ownerDocument.createElementNS(n.space,n.local)}}function sh(n){var t=yr(n);return(t.local?Fu:Ru)(t)}function Bu(){}function cs(n){return n==null?Bu:function(){return this.querySelector(n)}}function Lu(n){typeof n!="function"&&(n=cs(n));for(var t=this._groups,e=t.length,r=new Array(e),i=0;i<e;++i)for(var s=t[i],o=s.length,a=r[i]=new Array(o),h,c,l=0;l<o;++l)(h=s[l])&&(c=n.call(h,h.__data__,l,s))&&("__data__"in h&&(c.__data__=h.__data__),a[l]=c);return new gt(r,this._parents)}function Du(n){return n==null?[]:Array.isArray(n)?n:Array.from(n)}function Gu(){return[]}function oh(n){return n==null?Gu:function(){return this.querySelectorAll(n)}}function Ou(n){return function(){return Du(n.apply(this,arguments))}}function zu(n){typeof n=="function"?n=Ou(n):n=oh(n);for(var t=this._groups,e=t.length,r=[],i=[],s=0;s<e;++s)for(var o=t[s],a=o.length,h,c=0;c<a;++c)(h=o[c])&&(r.push(n.call(h,h.__data__,c,o)),i.push(h));return new gt(r,i)}function ah(n){return function(){return this.matches(n)}}function hh(n){return function(t){return t.matches(n)}}var Nu=Array.prototype.find;function Uu(n){return function(){return Nu.call(this.children,n)}}function $u(){return this.firstElementChild}function Hu(n){return this.select(n==null?$u:Uu(typeof n=="function"?n:hh(n)))}var Vu=Array.prototype.filter;function Wu(){return Array.from(this.children)}function Xu(n){return function(){return Vu.call(this.children,n)}}function Yu(n){return this.selectAll(n==null?Wu:Xu(typeof n=="function"?n:hh(n)))}function qu(n){typeof n!="function"&&(n=ah(n));for(var t=this._groups,e=t.length,r=new Array(e),i=0;i<e;++i)for(var s=t[i],o=s.length,a=r[i]=[],h,c=0;c<o;++c)(h=s[c])&&n.call(h,h.__data__,c,s)&&a.push(h);return new gt(r,this._parents)}function ch(n){return new Array(n.length)}function ju(){return new gt(this._enter||this._groups.map(ch),this._parents)}function hr(n,t){this.ownerDocument=n.ownerDocument,this.namespaceURI=n.namespaceURI,this._next=null,this._parent=n,this.__data__=t}hr.prototype={constructor:hr,appendChild:function(n){return this._parent.insertBefore(n,this._next)},insertBefore:function(n,t){return this._parent.insertBefore(n,t)},querySelector:function(n){return this._parent.querySelector(n)},querySelectorAll:function(n){return this._parent.querySelectorAll(n)}};function Zu(n){return function(){return n}}function Ku(n,t,e,r,i,s){for(var o=0,a,h=t.length,c=s.length;o<c;++o)(a=t[o])?(a.__data__=s[o],r[o]=a):e[o]=new hr(n,s[o]);for(;o<h;++o)(a=t[o])&&(i[o]=a)}function Qu(n,t,e,r,i,s,o){var a,h,c=new Map,l=t.length,u=s.length,d=new Array(l),f;for(a=0;a<l;++a)(h=t[a])&&(d[a]=f=o.call(h,h.__data__,a,t)+"",c.has(f)?i[a]=h:c.set(f,h));for(a=0;a<u;++a)f=o.call(n,s[a],a,s)+"",(h=c.get(f))?(r[a]=h,h.__data__=s[a],c.delete(f)):e[a]=new hr(n,s[a]);for(a=0;a<l;++a)(h=t[a])&&c.get(d[a])===h&&(i[a]=h)}function Ju(n){return n.__data__}function td(n,t){if(!arguments.length)return Array.from(this,Ju);var e=t?Qu:Ku,r=this._parents,i=this._groups;typeof n!="function"&&(n=Zu(n));for(var s=i.length,o=new Array(s),a=new Array(s),h=new Array(s),c=0;c<s;++c){var l=r[c],u=i[c],d=u.length,f=ed(n.call(l,l&&l.__data__,c,r)),p=f.length,g=a[c]=new Array(p),m=o[c]=new Array(p),y=h[c]=new Array(d);e(l,u,g,m,y,f,t);for(var x=0,_=0,b,M;x<p;++x)if(b=g[x]){for(x>=_&&(_=x+1);!(M=m[_])&&++_<p;);b._next=M||null}}return o=new gt(o,r),o._enter=a,o._exit=h,o}function ed(n){return typeof n=="object"&&"length"in n?n:Array.from(n)}function nd(){return new gt(this._exit||this._groups.map(ch),this._parents)}function rd(n,t,e){var r=this.enter(),i=this,s=this.exit();return typeof n=="function"?(r=n(r),r&&(r=r.selection())):r=r.append(n+""),t!=null&&(i=t(i),i&&(i=i.selection())),e==null?s.remove():e(s),r&&i?r.merge(i).order():i}function id(n){for(var t=n.selection?n.selection():n,e=this._groups,r=t._groups,i=e.length,s=r.length,o=Math.min(i,s),a=new Array(i),h=0;h<o;++h)for(var c=e[h],l=r[h],u=c.length,d=a[h]=new Array(u),f,p=0;p<u;++p)(f=c[p]||l[p])&&(d[p]=f);for(;h<i;++h)a[h]=e[h];return new gt(a,this._parents)}function sd(){for(var n=this._groups,t=-1,e=n.length;++t<e;)for(var r=n[t],i=r.length-1,s=r[i],o;--i>=0;)(o=r[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function od(n){n||(n=ad);function t(u,d){return u&&d?n(u.__data__,d.__data__):!u-!d}for(var e=this._groups,r=e.length,i=new Array(r),s=0;s<r;++s){for(var o=e[s],a=o.length,h=i[s]=new Array(a),c,l=0;l<a;++l)(c=o[l])&&(h[l]=c);h.sort(t)}return new gt(i,this._parents).order()}function ad(n,t){return n<t?-1:n>t?1:n>=t?0:NaN}function hd(){var n=arguments[0];return arguments[0]=this,n.apply(null,arguments),this}function cd(){return Array.from(this)}function ld(){for(var n=this._groups,t=0,e=n.length;t<e;++t)for(var r=n[t],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null}function ud(){let n=0;for(const t of this)++n;return n}function dd(){return!this.node()}function fd(n){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var i=t[e],s=0,o=i.length,a;s<o;++s)(a=i[s])&&n.call(a,a.__data__,s,i);return this}function pd(n){return function(){this.removeAttribute(n)}}function gd(n){return function(){this.removeAttributeNS(n.space,n.local)}}function md(n,t){return function(){this.setAttribute(n,t)}}function yd(n,t){return function(){this.setAttributeNS(n.space,n.local,t)}}function xd(n,t){return function(){var e=t.apply(this,arguments);e==null?this.removeAttribute(n):this.setAttribute(n,e)}}function _d(n,t){return function(){var e=t.apply(this,arguments);e==null?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,e)}}function bd(n,t){var e=yr(n);if(arguments.length<2){var r=this.node();return e.local?r.getAttributeNS(e.space,e.local):r.getAttribute(e)}return this.each((t==null?e.local?gd:pd:typeof t=="function"?e.local?_d:xd:e.local?yd:md)(e,t))}function lh(n){return n.ownerDocument&&n.ownerDocument.defaultView||n.document&&n||n.defaultView}function vd(n){return function(){this.style.removeProperty(n)}}function wd(n,t,e){return function(){this.style.setProperty(n,t,e)}}function Ad(n,t,e){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(n):this.style.setProperty(n,r,e)}}function Cd(n,t,e){return arguments.length>1?this.each((t==null?vd:typeof t=="function"?Ad:wd)(n,t,e??"")):Ee(this.node(),n)}function Ee(n,t){return n.style.getPropertyValue(t)||lh(n).getComputedStyle(n,null).getPropertyValue(t)}function Md(n){return function(){delete this[n]}}function Sd(n,t){return function(){this[n]=t}}function Pd(n,t){return function(){var e=t.apply(this,arguments);e==null?delete this[n]:this[n]=e}}function Td(n,t){return arguments.length>1?this.each((t==null?Md:typeof t=="function"?Pd:Sd)(n,t)):this.node()[n]}function uh(n){return n.trim().split(/^|\s+/)}function ls(n){return n.classList||new dh(n)}function dh(n){this._node=n,this._names=uh(n.getAttribute("class")||"")}dh.prototype={add:function(n){var t=this._names.indexOf(n);t<0&&(this._names.push(n),this._node.setAttribute("class",this._names.join(" ")))},remove:function(n){var t=this._names.indexOf(n);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(n){return this._names.indexOf(n)>=0}};function fh(n,t){for(var e=ls(n),r=-1,i=t.length;++r<i;)e.add(t[r])}function ph(n,t){for(var e=ls(n),r=-1,i=t.length;++r<i;)e.remove(t[r])}function kd(n){return function(){fh(this,n)}}function Ed(n){return function(){ph(this,n)}}function Id(n,t){return function(){(t.apply(this,arguments)?fh:ph)(this,n)}}function Rd(n,t){var e=uh(n+"");if(arguments.length<2){for(var r=ls(this.node()),i=-1,s=e.length;++i<s;)if(!r.contains(e[i]))return!1;return!0}return this.each((typeof t=="function"?Id:t?kd:Ed)(e,t))}function Fd(){this.textContent=""}function Bd(n){return function(){this.textContent=n}}function Ld(n){return function(){var t=n.apply(this,arguments);this.textContent=t??""}}function Dd(n){return arguments.length?this.each(n==null?Fd:(typeof n=="function"?Ld:Bd)(n)):this.node().textContent}function Gd(){this.innerHTML=""}function Od(n){return function(){this.innerHTML=n}}function zd(n){return function(){var t=n.apply(this,arguments);this.innerHTML=t??""}}function Nd(n){return arguments.length?this.each(n==null?Gd:(typeof n=="function"?zd:Od)(n)):this.node().innerHTML}function Ud(){this.nextSibling&&this.parentNode.appendChild(this)}function $d(){return this.each(Ud)}function Hd(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Vd(){return this.each(Hd)}function Wd(n){var t=typeof n=="function"?n:sh(n);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Xd(){return null}function Yd(n,t){var e=typeof n=="function"?n:sh(n),r=t==null?Xd:typeof t=="function"?t:cs(t);return this.select(function(){return this.insertBefore(e.apply(this,arguments),r.apply(this,arguments)||null)})}function qd(){var n=this.parentNode;n&&n.removeChild(this)}function jd(){return this.each(qd)}function Zd(){var n=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(n,this.nextSibling):n}function Kd(){var n=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(n,this.nextSibling):n}function Qd(n){return this.select(n?Kd:Zd)}function Jd(n){return arguments.length?this.property("__data__",n):this.node().__data__}function tf(n){return function(t){n.call(this,t,this.__data__)}}function ef(n){return n.trim().split(/^|\s+/).map(function(t){var e="",r=t.indexOf(".");return r>=0&&(e=t.slice(r+1),t=t.slice(0,r)),{type:t,name:e}})}function nf(n){return function(){var t=this.__on;if(t){for(var e=0,r=-1,i=t.length,s;e<i;++e)s=t[e],(!n.type||s.type===n.type)&&s.name===n.name?this.removeEventListener(s.type,s.listener,s.options):t[++r]=s;++r?t.length=r:delete this.__on}}}function rf(n,t,e){return function(){var r=this.__on,i,s=tf(t);if(r){for(var o=0,a=r.length;o<a;++o)if((i=r[o]).type===n.type&&i.name===n.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=e),i.value=t;return}}this.addEventListener(n.type,s,e),i={type:n.type,name:n.name,value:t,listener:s,options:e},r?r.push(i):this.__on=[i]}}function sf(n,t,e){var r=ef(n+""),i,s=r.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var h=0,c=a.length,l;h<c;++h)for(i=0,l=a[h];i<s;++i)if((o=r[i]).type===l.type&&o.name===l.name)return l.value}return}for(a=t?rf:nf,i=0;i<s;++i)this.each(a(r[i],t,e));return this}function gh(n,t,e){var r=lh(n),i=r.CustomEvent;typeof i=="function"?i=new i(t,e):(i=r.document.createEvent("Event"),e?(i.initEvent(t,e.bubbles,e.cancelable),i.detail=e.detail):i.initEvent(t,!1,!1)),n.dispatchEvent(i)}function of(n,t){return function(){return gh(this,n,t)}}function af(n,t){return function(){return gh(this,n,t.apply(this,arguments))}}function hf(n,t){return this.each((typeof t=="function"?af:of)(n,t))}function*cf(){for(var n=this._groups,t=0,e=n.length;t<e;++t)for(var r=n[t],i=0,s=r.length,o;i<s;++i)(o=r[i])&&(yield o)}var mh=[null];function gt(n,t){this._groups=n,this._parents=t}function vn(){return new gt([[document.documentElement]],mh)}function lf(){return this}gt.prototype=vn.prototype={constructor:gt,select:Lu,selectAll:zu,selectChild:Hu,selectChildren:Yu,filter:qu,data:td,enter:ju,exit:nd,join:rd,merge:id,selection:lf,order:sd,sort:od,call:hd,nodes:cd,node:ld,size:ud,empty:dd,each:fd,attr:bd,style:Cd,property:Td,classed:Rd,text:Dd,html:Nd,raise:$d,lower:Vd,append:Wd,insert:Yd,remove:jd,clone:Qd,datum:Jd,on:sf,dispatch:hf,[Symbol.iterator]:cf};function Vt(n){return typeof n=="string"?new gt([[document.querySelector(n)]],[document.documentElement]):new gt([[n]],mh)}function uf(n){let t;for(;t=n.sourceEvent;)n=t;return n}function ie(n,t){if(n=uf(n),t===void 0&&(t=n.currentTarget),t){var e=t.ownerSVGElement||t;if(e.createSVGPoint){var r=e.createSVGPoint();return r.x=n.clientX,r.y=n.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[n.clientX-i.left-t.clientLeft,n.clientY-i.top-t.clientTop]}}return[n.pageX,n.pageY]}var df={value:()=>{}};function us(){for(var n=0,t=arguments.length,e={},r;n<t;++n){if(!(r=arguments[n]+"")||r in e||/[\s.]/.test(r))throw new Error("illegal type: "+r);e[r]=[]}return new Yn(e)}function Yn(n){this._=n}function ff(n,t){return n.trim().split(/^|\s+/).map(function(e){var r="",i=e.indexOf(".");if(i>=0&&(r=e.slice(i+1),e=e.slice(0,i)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:r}})}Yn.prototype=us.prototype={constructor:Yn,on:function(n,t){var e=this._,r=ff(n+"",e),i,s=-1,o=r.length;if(arguments.length<2){for(;++s<o;)if((i=(n=r[s]).type)&&(i=pf(e[i],n.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<o;)if(i=(n=r[s]).type)e[i]=xo(e[i],n.name,t);else if(t==null)for(i in e)e[i]=xo(e[i],n.name,null);return this},copy:function(){var n={},t=this._;for(var e in t)n[e]=t[e].slice();return new Yn(n)},call:function(n,t){if((i=arguments.length-2)>0)for(var e=new Array(i),r=0,i,s;r<i;++r)e[r]=arguments[r+2];if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(s=this._[n],r=0,i=s.length;r<i;++r)s[r].value.apply(t,e)},apply:function(n,t,e){if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(var r=this._[n],i=0,s=r.length;i<s;++i)r[i].value.apply(t,e)}};function pf(n,t){for(var e=0,r=n.length,i;e<r;++e)if((i=n[e]).name===t)return i.value}function xo(n,t,e){for(var r=0,i=n.length;r<i;++r)if(n[r].name===t){n[r]=df,n=n.slice(0,r).concat(n.slice(r+1));break}return e!=null&&n.push({name:t,value:e}),n}const Ti={capture:!0,passive:!1};function ki(n){n.preventDefault(),n.stopImmediatePropagation()}function gf(n){var t=n.document.documentElement,e=Vt(n).on("dragstart.drag",ki,Ti);"onselectstart"in t?e.on("selectstart.drag",ki,Ti):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function mf(n,t){var e=n.document.documentElement,r=Vt(n).on("dragstart.drag",null);t&&(r.on("click.drag",ki,Ti),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in e?r.on("selectstart.drag",null):(e.style.MozUserSelect=e.__noselect,delete e.__noselect)}var Ie=0,Ke=0,Ue=0,yh=1e3,cr,Qe,lr=0,ge=0,xr=0,pn=typeof performance=="object"&&performance.now?performance:Date,xh=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(n){setTimeout(n,17)};function ds(){return ge||(xh(yf),ge=pn.now()+xr)}function yf(){ge=0}function ur(){this._call=this._time=this._next=null}ur.prototype=_h.prototype={constructor:ur,restart:function(n,t,e){if(typeof n!="function")throw new TypeError("callback is not a function");e=(e==null?ds():+e)+(t==null?0:+t),!this._next&&Qe!==this&&(Qe?Qe._next=this:cr=this,Qe=this),this._call=n,this._time=e,Ei()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ei())}};function _h(n,t,e){var r=new ur;return r.restart(n,t,e),r}function xf(){ds(),++Ie;for(var n=cr,t;n;)(t=ge-n._time)>=0&&n._call.call(void 0,t),n=n._next;--Ie}function _o(){ge=(lr=pn.now())+xr,Ie=Ke=0;try{xf()}finally{Ie=0,bf(),ge=0}}function _f(){var n=pn.now(),t=n-lr;t>yh&&(xr-=t,lr=n)}function bf(){for(var n,t=cr,e,r=1/0;t;)t._call?(r>t._time&&(r=t._time),n=t,t=t._next):(e=t._next,t._next=null,t=n?n._next=e:cr=e);Qe=n,Ei(r)}function Ei(n){if(!Ie){Ke&&(Ke=clearTimeout(Ke));var t=n-ge;t>24?(n<1/0&&(Ke=setTimeout(_o,n-pn.now()-xr)),Ue&&(Ue=clearInterval(Ue))):(Ue||(lr=pn.now(),Ue=setInterval(_f,yh)),Ie=1,xh(_o))}}function bo(n,t,e){var r=new ur;return t=t==null?0:+t,r.restart(i=>{r.stop(),n(i+t)},t,e),r}var vf=us("start","end","cancel","interrupt"),wf=[],bh=0,vo=1,Ii=2,qn=3,wo=4,Ri=5,jn=6;function _r(n,t,e,r,i,s){var o=n.__transition;if(!o)n.__transition={};else if(e in o)return;Af(n,e,{name:t,index:r,group:i,on:vf,tween:wf,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:bh})}function fs(n,t){var e=St(n,t);if(e.state>bh)throw new Error("too late; already scheduled");return e}function Ft(n,t){var e=St(n,t);if(e.state>qn)throw new Error("too late; already running");return e}function St(n,t){var e=n.__transition;if(!e||!(e=e[t]))throw new Error("transition not found");return e}function Af(n,t,e){var r=n.__transition,i;r[t]=e,e.timer=_h(s,0,e.time);function s(c){e.state=vo,e.timer.restart(o,e.delay,e.time),e.delay<=c&&o(c-e.delay)}function o(c){var l,u,d,f;if(e.state!==vo)return h();for(l in r)if(f=r[l],f.name===e.name){if(f.state===qn)return bo(o);f.state===wo?(f.state=jn,f.timer.stop(),f.on.call("interrupt",n,n.__data__,f.index,f.group),delete r[l]):+l<t&&(f.state=jn,f.timer.stop(),f.on.call("cancel",n,n.__data__,f.index,f.group),delete r[l])}if(bo(function(){e.state===qn&&(e.state=wo,e.timer.restart(a,e.delay,e.time),a(c))}),e.state=Ii,e.on.call("start",n,n.__data__,e.index,e.group),e.state===Ii){for(e.state=qn,i=new Array(d=e.tween.length),l=0,u=-1;l<d;++l)(f=e.tween[l].value.call(n,n.__data__,e.index,e.group))&&(i[++u]=f);i.length=u+1}}function a(c){for(var l=c<e.duration?e.ease.call(null,c/e.duration):(e.timer.restart(h),e.state=Ri,1),u=-1,d=i.length;++u<d;)i[u].call(n,l);e.state===Ri&&(e.on.call("end",n,n.__data__,e.index,e.group),h())}function h(){e.state=jn,e.timer.stop(),delete r[t];for(var c in r)return;delete n.__transition}}function Zn(n,t){var e=n.__transition,r,i,s=!0,o;if(e){t=t==null?null:t+"";for(o in e){if((r=e[o]).name!==t){s=!1;continue}i=r.state>Ii&&r.state<Ri,r.state=jn,r.timer.stop(),r.on.call(i?"interrupt":"cancel",n,n.__data__,r.index,r.group),delete e[o]}s&&delete n.__transition}}function Cf(n){return this.each(function(){Zn(this,n)})}function Mf(n,t){var e,r;return function(){var i=Ft(this,n),s=i.tween;if(s!==e){r=e=s;for(var o=0,a=r.length;o<a;++o)if(r[o].name===t){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function Sf(n,t,e){var r,i;if(typeof e!="function")throw new Error;return function(){var s=Ft(this,n),o=s.tween;if(o!==r){i=(r=o).slice();for(var a={name:t,value:e},h=0,c=i.length;h<c;++h)if(i[h].name===t){i[h]=a;break}h===c&&i.push(a)}s.tween=i}}function Pf(n,t){var e=this._id;if(n+="",arguments.length<2){for(var r=St(this.node(),e).tween,i=0,s=r.length,o;i<s;++i)if((o=r[i]).name===n)return o.value;return null}return this.each((t==null?Mf:Sf)(e,n,t))}function ps(n,t,e){var r=n._id;return n.each(function(){var i=Ft(this,r);(i.value||(i.value={}))[t]=e.apply(this,arguments)}),function(i){return St(i,r).value[t]}}function vh(n,t){var e;return(typeof t=="number"?wt:t instanceof Yt?fn:(e=Yt(t))?(t=e,fn):Ya)(n,t)}function Tf(n){return function(){this.removeAttribute(n)}}function kf(n){return function(){this.removeAttributeNS(n.space,n.local)}}function Ef(n,t,e){var r,i=e+"",s;return function(){var o=this.getAttribute(n);return o===i?null:o===r?s:s=t(r=o,e)}}function If(n,t,e){var r,i=e+"",s;return function(){var o=this.getAttributeNS(n.space,n.local);return o===i?null:o===r?s:s=t(r=o,e)}}function Rf(n,t,e){var r,i,s;return function(){var o,a=e(this),h;return a==null?void this.removeAttribute(n):(o=this.getAttribute(n),h=a+"",o===h?null:o===r&&h===i?s:(i=h,s=t(r=o,a)))}}function Ff(n,t,e){var r,i,s;return function(){var o,a=e(this),h;return a==null?void this.removeAttributeNS(n.space,n.local):(o=this.getAttributeNS(n.space,n.local),h=a+"",o===h?null:o===r&&h===i?s:(i=h,s=t(r=o,a)))}}function Bf(n,t){var e=yr(n),r=e==="transform"?Nl:vh;return this.attrTween(n,typeof t=="function"?(e.local?Ff:Rf)(e,r,ps(this,"attr."+n,t)):t==null?(e.local?kf:Tf)(e):(e.local?If:Ef)(e,r,t))}function Lf(n,t){return function(e){this.setAttribute(n,t.call(this,e))}}function Df(n,t){return function(e){this.setAttributeNS(n.space,n.local,t.call(this,e))}}function Gf(n,t){var e,r;function i(){var s=t.apply(this,arguments);return s!==r&&(e=(r=s)&&Df(n,s)),e}return i._value=t,i}function Of(n,t){var e,r;function i(){var s=t.apply(this,arguments);return s!==r&&(e=(r=s)&&Lf(n,s)),e}return i._value=t,i}function zf(n,t){var e="attr."+n;if(arguments.length<2)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;var r=yr(n);return this.tween(e,(r.local?Gf:Of)(r,t))}function Nf(n,t){return function(){fs(this,n).delay=+t.apply(this,arguments)}}function Uf(n,t){return t=+t,function(){fs(this,n).delay=t}}function $f(n){var t=this._id;return arguments.length?this.each((typeof n=="function"?Nf:Uf)(t,n)):St(this.node(),t).delay}function Hf(n,t){return function(){Ft(this,n).duration=+t.apply(this,arguments)}}function Vf(n,t){return t=+t,function(){Ft(this,n).duration=t}}function Wf(n){var t=this._id;return arguments.length?this.each((typeof n=="function"?Hf:Vf)(t,n)):St(this.node(),t).duration}function Xf(n,t){if(typeof t!="function")throw new Error;return function(){Ft(this,n).ease=t}}function Yf(n){var t=this._id;return arguments.length?this.each(Xf(t,n)):St(this.node(),t).ease}function qf(n,t){return function(){var e=t.apply(this,arguments);if(typeof e!="function")throw new Error;Ft(this,n).ease=e}}function jf(n){if(typeof n!="function")throw new Error;return this.each(qf(this._id,n))}function Zf(n){typeof n!="function"&&(n=ah(n));for(var t=this._groups,e=t.length,r=new Array(e),i=0;i<e;++i)for(var s=t[i],o=s.length,a=r[i]=[],h,c=0;c<o;++c)(h=s[c])&&n.call(h,h.__data__,c,s)&&a.push(h);return new Nt(r,this._parents,this._name,this._id)}function Kf(n){if(n._id!==this._id)throw new Error;for(var t=this._groups,e=n._groups,r=t.length,i=e.length,s=Math.min(r,i),o=new Array(r),a=0;a<s;++a)for(var h=t[a],c=e[a],l=h.length,u=o[a]=new Array(l),d,f=0;f<l;++f)(d=h[f]||c[f])&&(u[f]=d);for(;a<r;++a)o[a]=t[a];return new Nt(o,this._parents,this._name,this._id)}function Qf(n){return(n+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||t==="start"})}function Jf(n,t,e){var r,i,s=Qf(t)?fs:Ft;return function(){var o=s(this,n),a=o.on;a!==r&&(i=(r=a).copy()).on(t,e),o.on=i}}function t0(n,t){var e=this._id;return arguments.length<2?St(this.node(),e).on.on(n):this.each(Jf(e,n,t))}function e0(n){return function(){var t=this.parentNode;for(var e in this.__transition)if(+e!==n)return;t&&t.removeChild(this)}}function n0(){return this.on("end.remove",e0(this._id))}function r0(n){var t=this._name,e=this._id;typeof n!="function"&&(n=cs(n));for(var r=this._groups,i=r.length,s=new Array(i),o=0;o<i;++o)for(var a=r[o],h=a.length,c=s[o]=new Array(h),l,u,d=0;d<h;++d)(l=a[d])&&(u=n.call(l,l.__data__,d,a))&&("__data__"in l&&(u.__data__=l.__data__),c[d]=u,_r(c[d],t,e,d,c,St(l,e)));return new Nt(s,this._parents,t,e)}function i0(n){var t=this._name,e=this._id;typeof n!="function"&&(n=oh(n));for(var r=this._groups,i=r.length,s=[],o=[],a=0;a<i;++a)for(var h=r[a],c=h.length,l,u=0;u<c;++u)if(l=h[u]){for(var d=n.call(l,l.__data__,u,h),f,p=St(l,e),g=0,m=d.length;g<m;++g)(f=d[g])&&_r(f,t,e,g,d,p);s.push(d),o.push(l)}return new Nt(s,o,t,e)}var s0=vn.prototype.constructor;function o0(){return new s0(this._groups,this._parents)}function a0(n,t){var e,r,i;return function(){var s=Ee(this,n),o=(this.style.removeProperty(n),Ee(this,n));return s===o?null:s===e&&o===r?i:i=t(e=s,r=o)}}function wh(n){return function(){this.style.removeProperty(n)}}function h0(n,t,e){var r,i=e+"",s;return function(){var o=Ee(this,n);return o===i?null:o===r?s:s=t(r=o,e)}}function c0(n,t,e){var r,i,s;return function(){var o=Ee(this,n),a=e(this),h=a+"";return a==null&&(h=a=(this.style.removeProperty(n),Ee(this,n))),o===h?null:o===r&&h===i?s:(i=h,s=t(r=o,a))}}function l0(n,t){var e,r,i,s="style."+t,o="end."+s,a;return function(){var h=Ft(this,n),c=h.on,l=h.value[s]==null?a||(a=wh(t)):void 0;(c!==e||i!==l)&&(r=(e=c).copy()).on(o,i=l),h.on=r}}function u0(n,t,e){var r=(n+="")=="transform"?zl:vh;return t==null?this.styleTween(n,a0(n,r)).on("end.style."+n,wh(n)):typeof t=="function"?this.styleTween(n,c0(n,r,ps(this,"style."+n,t))).each(l0(this._id,n)):this.styleTween(n,h0(n,r,t),e).on("end.style."+n,null)}function d0(n,t,e){return function(r){this.style.setProperty(n,t.call(this,r),e)}}function f0(n,t,e){var r,i;function s(){var o=t.apply(this,arguments);return o!==i&&(r=(i=o)&&d0(n,o,e)),r}return s._value=t,s}function p0(n,t,e){var r="style."+(n+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,f0(n,t,e??""))}function g0(n){return function(){this.textContent=n}}function m0(n){return function(){var t=n(this);this.textContent=t??""}}function y0(n){return this.tween("text",typeof n=="function"?m0(ps(this,"text",n)):g0(n==null?"":n+""))}function x0(n){return function(t){this.textContent=n.call(this,t)}}function _0(n){var t,e;function r(){var i=n.apply(this,arguments);return i!==e&&(t=(e=i)&&x0(i)),t}return r._value=n,r}function b0(n){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(n==null)return this.tween(t,null);if(typeof n!="function")throw new Error;return this.tween(t,_0(n))}function v0(){for(var n=this._name,t=this._id,e=Ah(),r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],a=o.length,h,c=0;c<a;++c)if(h=o[c]){var l=St(h,t);_r(h,n,e,c,o,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new Nt(r,this._parents,n,e)}function w0(){var n,t,e=this,r=e._id,i=e.size();return new Promise(function(s,o){var a={value:o},h={value:function(){--i===0&&s()}};e.each(function(){var c=Ft(this,r),l=c.on;l!==n&&(t=(n=l).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(h)),c.on=t}),i===0&&s()})}var A0=0;function Nt(n,t,e,r){this._groups=n,this._parents=t,this._name=e,this._id=r}function Ah(){return++A0}var Bt=vn.prototype;Nt.prototype={constructor:Nt,select:r0,selectAll:i0,selectChild:Bt.selectChild,selectChildren:Bt.selectChildren,filter:Zf,merge:Kf,selection:o0,transition:v0,call:Bt.call,nodes:Bt.nodes,node:Bt.node,size:Bt.size,empty:Bt.empty,each:Bt.each,on:t0,attr:Bf,attrTween:zf,style:u0,styleTween:p0,text:y0,textTween:b0,remove:n0,tween:Pf,delay:$f,duration:Wf,ease:Yf,easeVarying:jf,end:w0,[Symbol.iterator]:Bt[Symbol.iterator]};function C0(n){return((n*=2)<=1?n*n*n:(n-=2)*n*n+2)/2}var M0={time:null,delay:0,duration:250,ease:C0};function S0(n,t){for(var e;!(e=n.__transition)||!(e=e[t]);)if(!(n=n.parentNode))throw new Error(`transition ${t} not found`);return e}function P0(n){var t,e;n instanceof Nt?(t=n._id,n=n._name):(t=Ah(),(e=M0).time=ds(),n=n==null?null:n+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],a=o.length,h,c=0;c<a;++c)(h=o[c])&&_r(h,n,t,c,o,e||S0(h,t));return new Nt(r,this._parents,n,t)}vn.prototype.interrupt=Cf;vn.prototype.transition=P0;const En=n=>()=>n;function T0(n,{sourceEvent:t,target:e,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:n,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:e,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function Gt(n,t,e){this.k=n,this.x=t,this.y=e}Gt.prototype={constructor:Gt,scale:function(n){return n===1?this:new Gt(this.k*n,this.x,this.y)},translate:function(n,t){return n===0&t===0?this:new Gt(this.k,this.x+this.k*n,this.y+this.k*t)},apply:function(n){return[n[0]*this.k+this.x,n[1]*this.k+this.y]},applyX:function(n){return n*this.k+this.x},applyY:function(n){return n*this.k+this.y},invert:function(n){return[(n[0]-this.x)/this.k,(n[1]-this.y)/this.k]},invertX:function(n){return(n-this.x)/this.k},invertY:function(n){return(n-this.y)/this.k},rescaleX:function(n){return n.copy().domain(n.range().map(this.invertX,this).map(n.invert,n))},rescaleY:function(n){return n.copy().domain(n.range().map(this.invertY,this).map(n.invert,n))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var gs=new Gt(1,0,0);Gt.prototype;function Or(n){n.stopImmediatePropagation()}function $e(n){n.preventDefault(),n.stopImmediatePropagation()}function k0(n){return(!n.ctrlKey||n.type==="wheel")&&!n.button}function E0(){var n=this;return n instanceof SVGElement?(n=n.ownerSVGElement||n,n.hasAttribute("viewBox")?(n=n.viewBox.baseVal,[[n.x,n.y],[n.x+n.width,n.y+n.height]]):[[0,0],[n.width.baseVal.value,n.height.baseVal.value]]):[[0,0],[n.clientWidth,n.clientHeight]]}function Ao(){return this.__zoom||gs}function I0(n){return-n.deltaY*(n.deltaMode===1?.05:n.deltaMode?1:.002)*(n.ctrlKey?10:1)}function R0(){return navigator.maxTouchPoints||"ontouchstart"in this}function F0(n,t,e){var r=n.invertX(t[0][0])-e[0][0],i=n.invertX(t[1][0])-e[1][0],s=n.invertY(t[0][1])-e[0][1],o=n.invertY(t[1][1])-e[1][1];return n.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}function B0(){var n=k0,t=E0,e=F0,r=I0,i=R0,s=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],a=250,h=Vl,c=us("start","zoom","end"),l,u,d,f=500,p=150,g=0,m=10;function y(v){v.property("__zoom",Ao).on("wheel.zoom",E,{passive:!1}).on("mousedown.zoom",I).on("dblclick.zoom",T).filter(i).on("touchstart.zoom",P).on("touchmove.zoom",G).on("touchend.zoom touchcancel.zoom",O).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}y.transform=function(v,R,w,S){var B=v.selection?v.selection():v;B.property("__zoom",Ao),v!==B?M(v,R,w,S):B.interrupt().each(function(){C(this,arguments).event(S).start().zoom(null,typeof R=="function"?R.apply(this,arguments):R).end()})},y.scaleBy=function(v,R,w,S){y.scaleTo(v,function(){var B=this.__zoom.k,k=typeof R=="function"?R.apply(this,arguments):R;return B*k},w,S)},y.scaleTo=function(v,R,w,S){y.transform(v,function(){var B=t.apply(this,arguments),k=this.__zoom,L=w==null?b(B):typeof w=="function"?w.apply(this,arguments):w,N=k.invert(L),H=typeof R=="function"?R.apply(this,arguments):R;return e(_(x(k,H),L,N),B,o)},w,S)},y.translateBy=function(v,R,w,S){y.transform(v,function(){return e(this.__zoom.translate(typeof R=="function"?R.apply(this,arguments):R,typeof w=="function"?w.apply(this,arguments):w),t.apply(this,arguments),o)},null,S)},y.translateTo=function(v,R,w,S,B){y.transform(v,function(){var k=t.apply(this,arguments),L=this.__zoom,N=S==null?b(k):typeof S=="function"?S.apply(this,arguments):S;return e(gs.translate(N[0],N[1]).scale(L.k).translate(typeof R=="function"?-R.apply(this,arguments):-R,typeof w=="function"?-w.apply(this,arguments):-w),k,o)},S,B)};function x(v,R){return R=Math.max(s[0],Math.min(s[1],R)),R===v.k?v:new Gt(R,v.x,v.y)}function _(v,R,w){var S=R[0]-w[0]*v.k,B=R[1]-w[1]*v.k;return S===v.x&&B===v.y?v:new Gt(v.k,S,B)}function b(v){return[(+v[0][0]+ +v[1][0])/2,(+v[0][1]+ +v[1][1])/2]}function M(v,R,w,S){v.on("start.zoom",function(){C(this,arguments).event(S).start()}).on("interrupt.zoom end.zoom",function(){C(this,arguments).event(S).end()}).tween("zoom",function(){var B=this,k=arguments,L=C(B,k).event(S),N=t.apply(B,k),H=w==null?b(N):typeof w=="function"?w.apply(B,k):w,rt=Math.max(N[1][0]-N[0][0],N[1][1]-N[0][1]),Q=B.__zoom,it=typeof R=="function"?R.apply(B,k):R,ot=h(Q.invert(H).concat(rt/Q.k),it.invert(H).concat(rt/it.k));return function(ht){if(ht===1)ht=it;else{var mt=ot(ht),$t=rt/mt[2];ht=new Gt($t,H[0]-mt[0]*$t,H[1]-mt[1]*$t)}L.zoom(null,ht)}})}function C(v,R,w){return!w&&v.__zooming||new A(v,R)}function A(v,R){this.that=v,this.args=R,this.active=0,this.sourceEvent=null,this.extent=t.apply(v,R),this.taps=0}A.prototype={event:function(v){return v&&(this.sourceEvent=v),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(v,R){return this.mouse&&v!=="mouse"&&(this.mouse[1]=R.invert(this.mouse[0])),this.touch0&&v!=="touch"&&(this.touch0[1]=R.invert(this.touch0[0])),this.touch1&&v!=="touch"&&(this.touch1[1]=R.invert(this.touch1[0])),this.that.__zoom=R,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(v){var R=Vt(this.that).datum();c.call(v,this.that,new T0(v,{sourceEvent:this.sourceEvent,target:y,transform:this.that.__zoom,dispatch:c}),R)}};function E(v,...R){if(!n.apply(this,arguments))return;var w=C(this,R).event(v),S=this.__zoom,B=Math.max(s[0],Math.min(s[1],S.k*Math.pow(2,r.apply(this,arguments)))),k=ie(v);if(w.wheel)(w.mouse[0][0]!==k[0]||w.mouse[0][1]!==k[1])&&(w.mouse[1]=S.invert(w.mouse[0]=k)),clearTimeout(w.wheel);else{if(S.k===B)return;w.mouse=[k,S.invert(k)],Zn(this),w.start()}$e(v),w.wheel=setTimeout(L,p),w.zoom("mouse",e(_(x(S,B),w.mouse[0],w.mouse[1]),w.extent,o));function L(){w.wheel=null,w.end()}}function I(v,...R){if(d||!n.apply(this,arguments))return;var w=v.currentTarget,S=C(this,R,!0).event(v),B=Vt(v.view).on("mousemove.zoom",H,!0).on("mouseup.zoom",rt,!0),k=ie(v,w),L=v.clientX,N=v.clientY;gf(v.view),Or(v),S.mouse=[k,this.__zoom.invert(k)],Zn(this),S.start();function H(Q){if($e(Q),!S.moved){var it=Q.clientX-L,ot=Q.clientY-N;S.moved=it*it+ot*ot>g}S.event(Q).zoom("mouse",e(_(S.that.__zoom,S.mouse[0]=ie(Q,w),S.mouse[1]),S.extent,o))}function rt(Q){B.on("mousemove.zoom mouseup.zoom",null),mf(Q.view,S.moved),$e(Q),S.event(Q).end()}}function T(v,...R){if(n.apply(this,arguments)){var w=this.__zoom,S=ie(v.changedTouches?v.changedTouches[0]:v,this),B=w.invert(S),k=w.k*(v.shiftKey?.5:2),L=e(_(x(w,k),S,B),t.apply(this,R),o);$e(v),a>0?Vt(this).transition().duration(a).call(M,L,S,v):Vt(this).call(y.transform,L,S,v)}}function P(v,...R){if(n.apply(this,arguments)){var w=v.touches,S=w.length,B=C(this,R,v.changedTouches.length===S).event(v),k,L,N,H;for(Or(v),L=0;L<S;++L)N=w[L],H=ie(N,this),H=[H,this.__zoom.invert(H),N.identifier],B.touch0?!B.touch1&&B.touch0[2]!==H[2]&&(B.touch1=H,B.taps=0):(B.touch0=H,k=!0,B.taps=1+!!l);l&&(l=clearTimeout(l)),k&&(B.taps<2&&(u=H[0],l=setTimeout(function(){l=null},f)),Zn(this),B.start())}}function G(v,...R){if(this.__zooming){var w=C(this,R).event(v),S=v.changedTouches,B=S.length,k,L,N,H;for($e(v),k=0;k<B;++k)L=S[k],N=ie(L,this),w.touch0&&w.touch0[2]===L.identifier?w.touch0[0]=N:w.touch1&&w.touch1[2]===L.identifier&&(w.touch1[0]=N);if(L=w.that.__zoom,w.touch1){var rt=w.touch0[0],Q=w.touch0[1],it=w.touch1[0],ot=w.touch1[1],ht=(ht=it[0]-rt[0])*ht+(ht=it[1]-rt[1])*ht,mt=(mt=ot[0]-Q[0])*mt+(mt=ot[1]-Q[1])*mt;L=x(L,Math.sqrt(ht/mt)),N=[(rt[0]+it[0])/2,(rt[1]+it[1])/2],H=[(Q[0]+ot[0])/2,(Q[1]+ot[1])/2]}else if(w.touch0)N=w.touch0[0],H=w.touch0[1];else return;w.zoom("touch",e(_(L,N,H),w.extent,o))}}function O(v,...R){if(this.__zooming){var w=C(this,R).event(v),S=v.changedTouches,B=S.length,k,L;for(Or(v),d&&clearTimeout(d),d=setTimeout(function(){d=null},f),k=0;k<B;++k)L=S[k],w.touch0&&w.touch0[2]===L.identifier?delete w.touch0:w.touch1&&w.touch1[2]===L.identifier&&delete w.touch1;if(w.touch1&&!w.touch0&&(w.touch0=w.touch1,delete w.touch1),w.touch0)w.touch0[1]=this.__zoom.invert(w.touch0[0]);else if(w.end(),w.taps===2&&(L=ie(L,this),Math.hypot(u[0]-L[0],u[1]-L[1])<m)){var N=Vt(this).on("dblclick.zoom");N&&N.apply(this,arguments)}}}return y.wheelDelta=function(v){return arguments.length?(r=typeof v=="function"?v:En(+v),y):r},y.filter=function(v){return arguments.length?(n=typeof v=="function"?v:En(!!v),y):n},y.touchable=function(v){return arguments.length?(i=typeof v=="function"?v:En(!!v),y):i},y.extent=function(v){return arguments.length?(t=typeof v=="function"?v:En([[+v[0][0],+v[0][1]],[+v[1][0],+v[1][1]]]),y):t},y.scaleExtent=function(v){return arguments.length?(s[0]=+v[0],s[1]=+v[1],y):[s[0],s[1]]},y.translateExtent=function(v){return arguments.length?(o[0][0]=+v[0][0],o[1][0]=+v[1][0],o[0][1]=+v[0][1],o[1][1]=+v[1][1],y):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},y.constrain=function(v){return arguments.length?(e=v,y):e},y.duration=function(v){return arguments.length?(a=+v,y):a},y.interpolate=function(v){return arguments.length?(h=v,y):h},y.on=function(){var v=c.on.apply(c,arguments);return v===c?y:v},y.clickDistance=function(v){return arguments.length?(g=(v=+v)*v,y):Math.sqrt(g)},y.tapDistance=function(v){return arguments.length?(m=+v,y):m},y}const L0=.1,D0=256;class Qx{constructor(t,e,r={maxZoomLevel:D0,minZoomLevel:L0}){this.xBounds=[0,1],this.yBounds=[0,1],this.translateBoundsX=[0,1],this.translateBoundsY=[0,1],this._zFactor=1,this._enableTranslateExtent=!1,this.container=Vt(t),this.options=r,this.onRescale=e,this.onZoom=this.onZoom.bind(this),this.calculateTransform=this.calculateTransform.bind(this),this.applyTransform=this.applyTransform.bind(this),this.recalculateZoomTransform=this.recalculateZoomTransform.bind(this),this.rescale=this.rescale.bind(this),this.adjustToSize=this.adjustToSize.bind(this),this.setViewport=this.setViewport.bind(this),this.currentStateAsEvent=this.currentStateAsEvent.bind(this),this.updateTranslateExtent=this.updateTranslateExtent.bind(this),this.scaleX=sr().domain(this.xBounds).range([0,1]),this.scaleY=sr().domain(this.yBounds).range([0,1]),this.init()}get width(){return this.scaleX.range()[1]??0}get height(){return this.scaleY.range()[1]??0}get xSpan(){const{xBounds:t}=this;return Math.abs(t[1]-t[0])}get ySpan(){const{yBounds:t}=this;return Math.abs(t[1]-t[0])}get viewportRatio(){return this.width/(this.height||1)}get xRatio(){const t=this.scaleX.domain();return Math.abs(this.width/(t[1]-t[0]))}get yRatio(){const t=this.scaleY.domain();return Math.abs(this.height/(t[1]-t[0]))}get zFactor(){return this._zFactor}set zFactor(t){this._zFactor=t,this.recalculateZoomTransform()}get isXInverted(){return this.xBounds[1]<this.xBounds[0]}get isYInverted(){return this.yBounds[1]<this.yBounds[0]}get enableTranslateExtent(){return this._enableTranslateExtent}set enableTranslateExtent(t){this._enableTranslateExtent=t,this.updateTranslateExtent()}updateTranslateExtent(){const{width:t,xSpan:e,zFactor:r,enableTranslateExtent:i,translateBoundsX:s,translateBoundsY:o}=this;let a=-1/0,h=-1/0,c=1/0,l=1/0;if(i){const u=t/e;a=s[0]*u,c=s[1]*u,h=o[0]*u*r,l=o[1]*u*r}this.zoom.translateExtent([[a,h],[c,l]])}currentStateAsEvent(){const{scaleX:t,scaleY:e,xBounds:r,yBounds:i,zFactor:s,viewportRatio:o,currentTransform:a,xRatio:h,yRatio:c,width:l,height:u}=this;return{xScale:t.copy(),yScale:e.copy(),xBounds:r,yBounds:i,zFactor:s,viewportRatio:o,xRatio:h,yRatio:c,width:l,height:u,transform:Object.assign({},a)}}rescale(){const{currentStateAsEvent:t}=this;this.onRescale(t())}init(){this.zoom=B0().scaleExtent([this.options.minZoomLevel,this.options.maxZoomLevel]).on("zoom",this.onZoom),this.container.call(this.zoom)}onZoom(t){const{transform:e}=t;e&&(this.applyTransform(e),this.rescale())}applyTransform(t){const{width:e,scaleX:r,scaleY:i,xSpan:s,xBounds:o,yBounds:a,zFactor:h}=this,{viewportRatio:c,isXInverted:l,isYInverted:u}=this,d=e*t.k,f=s/d,p=s/t.k,g=p/h/c,m=f*t.x,y=f/h*t.y,x=o[0]-(l?-m:m),_=a[0]-(u?-y:y);r.domain([x,x+(l?-p:p)]),i.domain([_,_+(u?-g:g)]),this.currentTransform=t}setViewport(t,e,r,i){const{zoom:s,container:o,calculateTransform:a,scaleX:h,scaleY:c,isXInverted:l}=this;if(t==null||r==null||isNaN(t)||isNaN(r)){const g=h.domain(),m=g[1]-g[0];(t==null||isNaN(t))&&(t=g[0]+m/2||0),(r==null||isNaN(r))&&(r=Math.abs(m)||1)}if(e==null||isNaN(e)){const g=c.domain();e=g[0]+(g[1]-g[0])/2||0}const u=l?-r:r,d=t-u/2,f=d+u,p=a(d,f,e);i!=null&&Number.isFinite(i)&&i>0?s.transform(o.transition().duration(i),p):s.transform(o,p)}setBounds(t,e){this.xBounds=t,this.yBounds=e,this.recalculateZoomTransform()}setTranslateBounds(t,e){this.translateBoundsX=t,this.translateBoundsY=e,this.updateTranslateExtent()}adjustToSize(t,e,r=!1){const{width:i,height:s,scaleX:o,scaleY:a,recalculateZoomTransform:h}=this;let c=0,l=0;if(typeof t=="number"&&typeof e=="number")l=e,c=t;else{const f=this.container.node();if(f){const{width:p,height:g}=f.getBoundingClientRect();c=p,l=g}}const u=Math.max(1,c),d=Math.max(1,l);!r&&i===u&&s===d||(o.range([0,u]),a.range([0,d]),h(),this.onRescale(this.currentStateAsEvent()))}calculateTransform(t,e,r){const{scaleX:i,xSpan:s,xBounds:o,yBounds:a,zFactor:h,viewportRatio:c,isXInverted:l,isYInverted:u}=this,[d,f]=i.range(),p=Math.abs(e-t),g=s/p,m=p/(f-d),y=r-(u?-p:p)/h/c/2,x=(o[0]-t)/(l?-m:m),_=(a[0]-y)/((u?-m:m)/h);return gs.translate(x,_).scale(g)}recalculateZoomTransform(){const{scaleX:t,scaleY:e,container:r,calculateTransform:i,updateTranslateExtent:s}=this,[o,a]=t.domain(),[h,c]=e.domain(),l=h+(c-h)/2,u=i(o,a,l);s(),this.zoom.transform(r,u)}setZoomLevelBoundary(t){return this.zoom.scaleExtent(t),this}setMaxZoomLevel(t){const e=this.zoom.scaleExtent();return this.zoom.scaleExtent([e[0],t]),this}setMinZoomLevel(t){const e=this.zoom.scaleExtent();return this.zoom.scaleExtent([t,e[1]]),this}}const G0={order:1,layerOpacity:1,interactive:!1};class Ch{constructor(t,e){this._interactive=!1,this._id=t||`layer-${Math.floor(Math.random()*1e3)}`;const r=e||G0;this._order=r.order||1,this._options={...r},this.loading=!1,this._element=void 0,this._opacity=r.layerOpacity||1,this._visible=!0,this._interactive=r.interactive||!1,e&&e.data&&this.setData(e.data),this._referenceSystem=e==null?void 0:e.referenceSystem,this.onMount=this.onMount.bind(this),this.onUnmount=this.onUnmount.bind(this),this.onUpdate=this.onUpdate.bind(this),this.onRescale=this.onRescale.bind(this),this.onResize=this.onResize.bind(this),this.onOrderChanged=this.onOrderChanged.bind(this),this.onOpacityChanged=this.onOpacityChanged.bind(this),this.setVisibility=this.setVisibility.bind(this)}get id(){return this._id}get element(){return this._element}get options(){return this._options}set options(t){this._options=t}set isLoading(t){this.loading=t}get isLoading(){return this.loading}set opacity(t){this._opacity=t,this.onOpacityChanged(t)}get opacity(){return this._opacity}set order(t){this._order=t,this.onOrderChanged(t)}get order(){return this._order}set interactive(t){this._interactive=t,this.onInteractivityChanged(t)}get interactive(){return this._interactive}get referenceSystem(){return this._referenceSystem}set referenceSystem(t){this._referenceSystem=t}get data(){return this.getData()}set data(t){this.setData(t)}get isVisible(){return this._visible}getData(){return this._data}setData(t){this._data=t,this.element&&t!=null&&this.onUpdate({data:t})}clearData(t=!0){this._data=void 0,t&&(this.referenceSystem=void 0),this.onUpdate({})}setVisibility(t,e){this._visible=t}onMount(t){this._element=t.elm,this._options.onMount&&this._options.onMount(t,this)}onUnmount(t){this._options.onUnmount&&t!=null&&this._options.onUnmount(t,this)}onResize(t){this._options.onResize&&this._options.onResize(t,this)}onUpdate(t){t.data&&(this._data=t.data),this._options.onUpdate&&this._options.onUpdate(t,this)}onRescale(t){this.optionsRescale(t)}optionsRescale(t){this._options.onRescale&&this._options.onRescale(t,this)}getInternalLayerIds(){return[]}}const Mh=200,Sh=300,Jx=40,t_=30,O0=100,z0=.6,N0=.3,U0=8,$0=16,qt=64,e_=1;class n_ extends Ch{onOpacityChanged(t){this.canvas&&this.updateStyle()}onOrderChanged(t){this.canvas&&this.updateStyle()}onInteractivityChanged(t){this.canvas&&this.updateStyle()}setVisibility(t){super.setVisibility(t),this.canvas&&this.updateStyle(t)}updateStyle(t){var s;const r=t||this.isVisible?"visible":"hidden",i=this.interactive?"auto":"none";(s=this.canvas)==null||s.setAttribute("style",`position:absolute;pointer-events:${i};z-index:${this.order};opacity:${this.opacity};visibility:${r}`)}onMount(t){super.onMount(t);const{elm:e}=t,r=t.width||parseInt((e==null?void 0:e.getAttribute("width"))??"",10)||Mh,i=t.height||parseInt((e==null?void 0:e.getAttribute("height"))??"",10)||Sh;this.elm=e;let s;this.canvas||(s=document.createElement("canvas"),this.canvas=s,t.elm.appendChild(s)),this.canvas.setAttribute("id",`${this.id}`),this.canvas.setAttribute("width",`${r}px`),this.canvas.setAttribute("height",`${i}px`),this.canvas.setAttribute("class","canvas-layer"),this.updateStyle(),this.ctx=this.canvas.getContext("2d")??void 0}onUnmount(){var t;super.onUnmount(),(t=this.canvas)==null||t.remove(),this.canvas=void 0}onResize(t){const{ctx:e}=this,{width:r,height:i}=t;e==null||e.canvas.setAttribute("width",`${r}px`),e==null||e.canvas.setAttribute("height",`${i}px`)}onUpdate(t){super.onUpdate(t)}resetTransform(){var t;(t=this.ctx)==null||t.resetTransform()}setTransform(t){var i,s;this.resetTransform();const e=t.xBounds[0]>t.xBounds[1],r=t.yBounds[0]>t.yBounds[1];(i=this.ctx)==null||i.translate(t.xScale(0),t.yScale(0)),(s=this.ctx)==null||s.scale(t.xRatio*(e?-1:1),t.yRatio*(r?-1:1))}clearCanvas(){const{ctx:t,canvas:e}=this;t==null||t.save(),t==null||t.resetTransform(),t==null||t.clearRect(0,0,(e==null?void 0:e.width)??0,(e==null?void 0:e.height)??0),t==null||t.restore()}}var F=(n=>(n.Application="application",n.WebGLPipes="webgl-pipes",n.WebGLPipesAdaptor="webgl-pipes-adaptor",n.WebGLSystem="webgl-system",n.WebGPUPipes="webgpu-pipes",n.WebGPUPipesAdaptor="webgpu-pipes-adaptor",n.WebGPUSystem="webgpu-system",n.CanvasSystem="canvas-system",n.CanvasPipesAdaptor="canvas-pipes-adaptor",n.CanvasPipes="canvas-pipes",n.Asset="asset",n.LoadParser="load-parser",n.ResolveParser="resolve-parser",n.CacheParser="cache-parser",n.DetectionParser="detection-parser",n.MaskEffect="mask-effect",n.BlendMode="blend-mode",n.TextureSource="texture-source",n.Environment="environment",n.ShapeBuilder="shape-builder",n.Batcher="batcher",n))(F||{});const Fi=n=>{if(typeof n=="function"||typeof n=="object"&&n.extension){if(!n.extension)throw new Error("Extension class must have an extension object");n={...typeof n.extension!="object"?{type:n.extension}:n.extension,ref:n}}if(typeof n=="object")n={...n};else throw new Error("Invalid extension type");return typeof n.type=="string"&&(n.type=[n.type]),n},In=(n,t)=>Fi(n).priority??t,tt={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...n){return n.map(Fi).forEach(t=>{t.type.forEach(e=>{var r,i;return(i=(r=this._removeHandlers)[e])==null?void 0:i.call(r,t)})}),this},add(...n){return n.map(Fi).forEach(t=>{t.type.forEach(e=>{var s,o;const r=this._addHandlers,i=this._queue;r[e]?(o=r[e])==null||o.call(r,t):(i[e]=i[e]||[],(s=i[e])==null||s.push(t))})}),this},handle(n,t,e){var o;const r=this._addHandlers,i=this._removeHandlers;if(r[n]||i[n])throw new Error(`Extension type ${n} already has a handler`);r[n]=t,i[n]=e;const s=this._queue;return s[n]&&((o=s[n])==null||o.forEach(a=>t(a)),delete s[n]),this},handleByMap(n,t){return this.handle(n,e=>{e.name&&(t[e.name]=e.ref)},e=>{e.name&&delete t[e.name]})},handleByNamedList(n,t,e=-1){return this.handle(n,r=>{t.findIndex(s=>s.name===r.name)>=0||(t.push({name:r.name,value:r.ref}),t.sort((s,o)=>In(o.value,e)-In(s.value,e)))},r=>{const i=t.findIndex(s=>s.name===r.name);i!==-1&&t.splice(i,1)})},handleByList(n,t,e=-1){return this.handle(n,r=>{t.includes(r.ref)||(t.push(r.ref),t.sort((i,s)=>In(s,e)-In(i,e)))},r=>{const i=t.indexOf(r.ref);i!==-1&&t.splice(i,1)})},mixin(n,...t){for(const e of t)Object.defineProperties(n.prototype,Object.getOwnPropertyDescriptors(e))}},H0={extension:{type:F.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await Ce(()=>import("./browserAll-B_uz20Fh.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url)}},V0={extension:{type:F.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await Ce(()=>import("./webworkerAll-CrVqv5Cp.js"),__vite__mapDeps([1,2,3,4]),import.meta.url)}};class st{constructor(t,e,r){this._x=e||0,this._y=r||0,this._observer=t}clone(t){return new st(t??this._observer,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this._observer._onUpdate(this)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this._observer._onUpdate(this)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=${this._x} y=${this._y} scope=${this._observer}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this._observer._onUpdate(this))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this._observer._onUpdate(this))}}var zr={exports:{}},Co;function W0(){return Co||(Co=1,(function(n){var t=Object.prototype.hasOwnProperty,e="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(e=!1));function i(h,c,l){this.fn=h,this.context=c,this.once=l||!1}function s(h,c,l,u,d){if(typeof l!="function")throw new TypeError("The listener must be a function");var f=new i(l,u||h,d),p=e?e+c:c;return h._events[p]?h._events[p].fn?h._events[p]=[h._events[p],f]:h._events[p].push(f):(h._events[p]=f,h._eventsCount++),h}function o(h,c){--h._eventsCount===0?h._events=new r:delete h._events[c]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],l,u;if(this._eventsCount===0)return c;for(u in l=this._events)t.call(l,u)&&c.push(e?u.slice(1):u);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(l)):c},a.prototype.listeners=function(c){var l=e?e+c:c,u=this._events[l];if(!u)return[];if(u.fn)return[u.fn];for(var d=0,f=u.length,p=new Array(f);d<f;d++)p[d]=u[d].fn;return p},a.prototype.listenerCount=function(c){var l=e?e+c:c,u=this._events[l];return u?u.fn?1:u.length:0},a.prototype.emit=function(c,l,u,d,f,p){var g=e?e+c:c;if(!this._events[g])return!1;var m=this._events[g],y=arguments.length,x,_;if(m.fn){switch(m.once&&this.removeListener(c,m.fn,void 0,!0),y){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,l),!0;case 3:return m.fn.call(m.context,l,u),!0;case 4:return m.fn.call(m.context,l,u,d),!0;case 5:return m.fn.call(m.context,l,u,d,f),!0;case 6:return m.fn.call(m.context,l,u,d,f,p),!0}for(_=1,x=new Array(y-1);_<y;_++)x[_-1]=arguments[_];m.fn.apply(m.context,x)}else{var b=m.length,M;for(_=0;_<b;_++)switch(m[_].once&&this.removeListener(c,m[_].fn,void 0,!0),y){case 1:m[_].fn.call(m[_].context);break;case 2:m[_].fn.call(m[_].context,l);break;case 3:m[_].fn.call(m[_].context,l,u);break;case 4:m[_].fn.call(m[_].context,l,u,d);break;default:if(!x)for(M=1,x=new Array(y-1);M<y;M++)x[M-1]=arguments[M];m[_].fn.apply(m[_].context,x)}}return!0},a.prototype.on=function(c,l,u){return s(this,c,l,u,!1)},a.prototype.once=function(c,l,u){return s(this,c,l,u,!0)},a.prototype.removeListener=function(c,l,u,d){var f=e?e+c:c;if(!this._events[f])return this;if(!l)return o(this,f),this;var p=this._events[f];if(p.fn)p.fn===l&&(!d||p.once)&&(!u||p.context===u)&&o(this,f);else{for(var g=0,m=[],y=p.length;g<y;g++)(p[g].fn!==l||d&&!p[g].once||u&&p[g].context!==u)&&m.push(p[g]);m.length?this._events[f]=m.length===1?m[0]:m:o(this,f)}return this},a.prototype.removeAllListeners=function(c){var l;return c?(l=e?e+c:c,this._events[l]&&o(this,l)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=e,a.EventEmitter=a,n.exports=a})(zr)),zr.exports}var X0=W0();const Ut=Na(X0),Y0=Math.PI*2,q0=180/Math.PI,j0=Math.PI/180;class V{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new V(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return Nr.x=0,Nr.y=0,Nr}}const Nr=new V;class z{constructor(t=1,e=0,r=0,i=1,s=0,o=0){this.array=null,this.a=t,this.b=e,this.c=r,this.d=i,this.tx=s,this.ty=o}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,r,i,s,o){return this.a=t,this.b=e,this.c=r,this.d=i,this.tx=s,this.ty=o,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const r=e||this.array;return t?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r}apply(t,e){e=e||new V;const r=t.x,i=t.y;return e.x=this.a*r+this.c*i+this.tx,e.y=this.b*r+this.d*i+this.ty,e}applyInverse(t,e){e=e||new V;const r=this.a,i=this.b,s=this.c,o=this.d,a=this.tx,h=this.ty,c=1/(r*o+s*-i),l=t.x,u=t.y;return e.x=o*c*l+-s*c*u+(h*s-a*o)*c,e.y=r*c*u+-i*c*l+(-h*r+a*i)*c,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),r=Math.sin(t),i=this.a,s=this.c,o=this.tx;return this.a=i*e-this.b*r,this.b=i*r+this.b*e,this.c=s*e-this.d*r,this.d=s*r+this.d*e,this.tx=o*e-this.ty*r,this.ty=o*r+this.ty*e,this}append(t){const e=this.a,r=this.b,i=this.c,s=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*r+t.b*s,this.c=t.c*e+t.d*i,this.d=t.c*r+t.d*s,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*r+t.ty*s+this.ty,this}appendFrom(t,e){const r=t.a,i=t.b,s=t.c,o=t.d,a=t.tx,h=t.ty,c=e.a,l=e.b,u=e.c,d=e.d;return this.a=r*c+i*u,this.b=r*l+i*d,this.c=s*c+o*u,this.d=s*l+o*d,this.tx=a*c+h*u+e.tx,this.ty=a*l+h*d+e.ty,this}setTransform(t,e,r,i,s,o,a,h,c){return this.a=Math.cos(a+c)*s,this.b=Math.sin(a+c)*s,this.c=-Math.sin(a-h)*o,this.d=Math.cos(a-h)*o,this.tx=t-(r*this.a+i*this.c),this.ty=e-(r*this.b+i*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const r=this.a,i=this.c;this.a=r*t.a+this.b*t.c,this.b=r*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,r=this.b,i=this.c,s=this.d,o=t.pivot,a=-Math.atan2(-i,s),h=Math.atan2(r,e),c=Math.abs(a+h);return c<1e-5||Math.abs(Y0-c)<1e-5?(t.rotation=h,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=h),t.scale.x=Math.sqrt(e*e+r*r),t.scale.y=Math.sqrt(i*i+s*s),t.position.x=this.tx+(o.x*e+o.y*i),t.position.y=this.ty+(o.x*r+o.y*s),t}invert(){const t=this.a,e=this.b,r=this.c,i=this.d,s=this.tx,o=t*i-e*r;return this.a=i/o,this.b=-e/o,this.c=-r/o,this.d=t/o,this.tx=(r*this.ty-i*s)/o,this.ty=-(t*this.ty-e*s)/o,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new z;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}equals(t){return t.a===this.a&&t.b===this.b&&t.c===this.c&&t.d===this.d&&t.tx===this.tx&&t.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return K0.identity()}static get shared(){return Z0.identity()}}const Z0=new z,K0=new z,ae=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],he=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],ce=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],le=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Bi=[],Ph=[],Rn=Math.sign;function Q0(){for(let n=0;n<16;n++){const t=[];Bi.push(t);for(let e=0;e<16;e++){const r=Rn(ae[n]*ae[e]+ce[n]*he[e]),i=Rn(he[n]*ae[e]+le[n]*he[e]),s=Rn(ae[n]*ce[e]+ce[n]*le[e]),o=Rn(he[n]*ce[e]+le[n]*le[e]);for(let a=0;a<16;a++)if(ae[a]===r&&he[a]===i&&ce[a]===s&&le[a]===o){t.push(a);break}}}for(let n=0;n<16;n++){const t=new z;t.set(ae[n],he[n],ce[n],le[n],0,0),Ph.push(t)}}Q0();const $={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:n=>ae[n],uY:n=>he[n],vX:n=>ce[n],vY:n=>le[n],inv:n=>n&8?n&15:-n&7,add:(n,t)=>Bi[n][t],sub:(n,t)=>Bi[n][$.inv(t)],rotate180:n=>n^4,isVertical:n=>(n&3)===2,byDirection:(n,t)=>Math.abs(n)*2<=Math.abs(t)?t>=0?$.S:$.N:Math.abs(t)*2<=Math.abs(n)?n>0?$.E:$.W:t>0?n>0?$.SE:$.SW:n>0?$.NE:$.NW,matrixAppendRotationInv:(n,t,e=0,r=0,i=0,s=0)=>{const o=Ph[$.inv(t)],a=o.a,h=o.b,c=o.c,l=o.d,u=e-Math.min(0,a*i,c*s,a*i+c*s),d=r-Math.min(0,h*i,l*s,h*i+l*s),f=n.a,p=n.b,g=n.c,m=n.d;n.a=a*f+h*g,n.b=a*p+h*m,n.c=c*f+l*g,n.d=c*p+l*m,n.tx=u*f+d*g+n.tx,n.ty=u*p+d*m+n.ty},transformRectCoords:(n,t,e,r)=>{const{x:i,y:s,width:o,height:a}=n,{x:h,y:c,width:l,height:u}=t;return e===$.E?(r.set(i+h,s+c,o,a),r):e===$.S?r.set(l-s-a+h,i+c,a,o):e===$.W?r.set(l-i-o+h,u-s-a+c,o,a):e===$.N?r.set(s+h,u-i-o+c,a,o):r.set(i+h,s+c,o,a)}},Fn=[new V,new V,new V,new V];class Y{constructor(t=0,e=0,r=0,i=0){this.type="rectangle",this.x=Number(t),this.y=Number(e),this.width=Number(r),this.height=Number(i)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new Y(0,0,0,0)}clone(){return new Y(this.x,this.y,this.width,this.height)}copyFromBounds(t){return this.x=t.minX,this.y=t.minY,this.width=t.maxX-t.minX,this.height=t.maxY-t.minY,this}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}strokeContains(t,e,r,i=.5){const{width:s,height:o}=this;if(s<=0||o<=0)return!1;const a=this.x,h=this.y,c=r*(1-i),l=r-c,u=a-c,d=a+s+c,f=h-c,p=h+o+c,g=a+l,m=a+s-l,y=h+l,x=h+o-l;return t>=u&&t<=d&&e>=f&&e<=p&&!(t>g&&t<m&&e>y&&e<x)}intersects(t,e){if(!e){const E=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=E)return!1;const T=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>T}const r=this.left,i=this.right,s=this.top,o=this.bottom;if(i<=r||o<=s)return!1;const a=Fn[0].set(t.left,t.top),h=Fn[1].set(t.left,t.bottom),c=Fn[2].set(t.right,t.top),l=Fn[3].set(t.right,t.bottom);if(c.x<=a.x||h.y<=a.y)return!1;const u=Math.sign(e.a*e.d-e.b*e.c);if(u===0||(e.apply(a,a),e.apply(h,h),e.apply(c,c),e.apply(l,l),Math.max(a.x,h.x,c.x,l.x)<=r||Math.min(a.x,h.x,c.x,l.x)>=i||Math.max(a.y,h.y,c.y,l.y)<=s||Math.min(a.y,h.y,c.y,l.y)>=o))return!1;const d=u*(h.y-a.y),f=u*(a.x-h.x),p=d*r+f*s,g=d*i+f*s,m=d*r+f*o,y=d*i+f*o;if(Math.max(p,g,m,y)<=d*a.x+f*a.y||Math.min(p,g,m,y)>=d*l.x+f*l.y)return!1;const x=u*(a.y-c.y),_=u*(c.x-a.x),b=x*r+_*s,M=x*i+_*s,C=x*r+_*o,A=x*i+_*o;return!(Math.max(b,M,C,A)<=x*a.x+_*a.y||Math.min(b,M,C,A)>=x*l.x+_*l.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),r=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),s=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(r-e,0),this.y=i,this.height=Math.max(s-i,0),this}ceil(t=1,e=.001){const r=Math.ceil((this.x+this.width-e)*t)/t,i=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=r-this.x,this.height=i-this.y,this}scale(t,e=t){return this.x*=t,this.y*=e,this.width*=t,this.height*=e,this}enlarge(t){const e=Math.min(this.x,t.x),r=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),s=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=r-e,this.y=i,this.height=s-i,this}getBounds(t){return t||(t=new Y),t.copyFrom(this),t}containsRect(t){if(this.width<=0||this.height<=0)return!1;const e=t.x,r=t.y,i=t.x+t.width,s=t.y+t.height;return e>=this.x&&e<this.x+this.width&&r>=this.y&&r<this.y+this.height&&i>=this.x&&i<this.x+this.width&&s>=this.y&&s<this.y+this.height}set(t,e,r,i){return this.x=t,this.y=e,this.width=r,this.height=i,this}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const Ur={default:-1};function Z(n="default"){return Ur[n]===void 0&&(Ur[n]=-1),++Ur[n]}const Mo=new Set,W="8.0.0",J0="8.3.4",Ae={quiet:!1,noColor:!1},U=((n,t,e=3)=>{if(Ae.quiet||Mo.has(t))return;let r=new Error().stack;const i=`${t}
Deprecated since v${n}`,s=typeof console.groupCollapsed=="function"&&!Ae.noColor;typeof r>"u"?console.warn("PixiJS Deprecation Warning: ",i):(r=r.split(`
`).splice(e).join(`
`),s?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",i),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",i),console.warn(r))),Mo.add(t)});Object.defineProperties(U,{quiet:{get:()=>Ae.quiet,set:n=>{Ae.quiet=n},enumerable:!0,configurable:!1},noColor:{get:()=>Ae.noColor,set:n=>{Ae.noColor=n},enumerable:!0,configurable:!1}});const Th=()=>{};function So(n){return n+=n===0?1:0,--n,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n+1}function Po(n){return!(n&n-1)&&!!n}function dr(n){const t={};for(const e in n)n[e]!==void 0&&(t[e]=n[e]);return t}const To=Object.create(null);function tp(n){const t=To[n];return t===void 0&&(To[n]=Z("resource")),t}const kh=class Eh extends Ut{constructor(t={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,t={...Eh.defaultOptions,...t},this.addressMode=t.addressMode,this.addressModeU=t.addressModeU??this.addressModeU,this.addressModeV=t.addressModeV??this.addressModeV,this.addressModeW=t.addressModeW??this.addressModeW,this.scaleMode=t.scaleMode,this.magFilter=t.magFilter??this.magFilter,this.minFilter=t.minFilter??this.minFilter,this.mipmapFilter=t.mipmapFilter??this.mipmapFilter,this.lodMinClamp=t.lodMinClamp,this.lodMaxClamp=t.lodMaxClamp,this.compare=t.compare,this.maxAnisotropy=t.maxAnisotropy??1}set addressMode(t){this.addressModeU=t,this.addressModeV=t,this.addressModeW=t}get addressMode(){return this.addressModeU}set wrapMode(t){U(W,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=t}get wrapMode(){return this.addressMode}set scaleMode(t){this.magFilter=t,this.minFilter=t,this.mipmapFilter=t}get scaleMode(){return this.magFilter}set maxAnisotropy(t){this._maxAnisotropy=Math.min(t,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this._sharedResourceId=null,this.emit("change",this)}_generateResourceId(){const t=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=tp(t),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};kh.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let Ih=kh;const Rh=class Fh extends Ut{constructor(t={}){super(),this.options=t,this._gpuData=Object.create(null),this._gcLastUsed=-1,this.uid=Z("textureSource"),this._resourceType="textureSource",this._resourceId=Z("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.viewDimension="2d",this.arrayLayerCount=1,this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,t={...Fh.defaultOptions,...t},this.label=t.label??"",this.resource=t.resource,this.autoGarbageCollect=t.autoGarbageCollect,this._resolution=t.resolution,t.width?this.pixelWidth=t.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,t.height?this.pixelHeight=t.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=t.format,this.dimension=t.dimensions,this.viewDimension=t.viewDimension??t.dimensions,this.arrayLayerCount=t.arrayLayerCount,this.mipLevelCount=t.mipLevelCount,this.autoGenerateMipmaps=t.autoGenerateMipmaps,this.sampleCount=t.sampleCount,this.antialias=t.antialias,this.alphaMode=t.alphaMode,this.style=new Ih(dr(t)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(t){var e,r;this.style!==t&&((e=this._style)==null||e.off("change",this._onStyleChange,this),this._style=t,(r=this._style)==null||r.on("change",this._onStyleChange,this),this._onStyleChange())}set maxAnisotropy(t){this._style.maxAnisotropy=t}get maxAnisotropy(){return this._style.maxAnisotropy}get addressMode(){return this._style.addressMode}set addressMode(t){this._style.addressMode=t}get repeatMode(){return this._style.addressMode}set repeatMode(t){this._style.addressMode=t}get magFilter(){return this._style.magFilter}set magFilter(t){this._style.magFilter=t}get minFilter(){return this._style.minFilter}set minFilter(t){this._style.minFilter=t}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(t){this._style.mipmapFilter=t}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(t){this._style.lodMinClamp=t}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(t){this._style.lodMaxClamp=t}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const t=this._resolution;if(this.resize(this.resourceWidth/t,this.resourceHeight/t))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.unload(),this.emit("destroy",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){var t,e;this._resourceId=Z("resource"),this.emit("change",this),this.emit("unload",this);for(const r in this._gpuData)(e=(t=this._gpuData[r])==null?void 0:t.destroy)==null||e.call(t);this._gpuData=Object.create(null)}get resourceWidth(){const{resource:t}=this;return t.naturalWidth||t.videoWidth||t.displayWidth||t.width}get resourceHeight(){const{resource:t}=this;return t.naturalHeight||t.videoHeight||t.displayHeight||t.height}get resolution(){return this._resolution}set resolution(t){this._resolution!==t&&(this._resolution=t,this.width=this.pixelWidth/t,this.height=this.pixelHeight/t)}resize(t,e,r){r||(r=this._resolution),t||(t=this.width),e||(e=this.height);const i=Math.round(t*r),s=Math.round(e*r);return this.width=i/r,this.height=s/r,this._resolution=r,this.pixelWidth===i&&this.pixelHeight===s?!1:(this._refreshPOT(),this.pixelWidth=i,this.pixelHeight=s,this.emit("resize",this),this._resourceId=Z("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(t){this._style.wrapMode=t}get wrapMode(){return this._style.wrapMode}set scaleMode(t){this._style.scaleMode=t}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=Po(this.pixelWidth)&&Po(this.pixelHeight)}static test(t){throw new Error("Unimplemented")}};Rh.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",viewDimension:"2d",arrayLayerCount:1,mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let Pt=Rh;class ms extends Pt{constructor(t){const e=t.resource||new Float32Array(t.width*t.height*4);let r=t.format;r||(e instanceof Float32Array?r="rgba32float":e instanceof Int32Array||e instanceof Uint32Array?r="rgba32uint":e instanceof Int16Array||e instanceof Uint16Array?r="rgba16uint":(e instanceof Int8Array,r="bgra8unorm")),super({...t,resource:e,format:r}),this.uploadMethodId="buffer"}static test(t){return t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}ms.extension=F.TextureSource;const ko=new z;class ep{constructor(t,e){this.mapCoord=new z,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof e>"u"?this.clampMargin=t.width<10?0:.5:this.clampMargin=e,this.isSimple=!1,this.texture=t}get texture(){return this._texture}set texture(t){var e;this.texture!==t&&((e=this._texture)==null||e.removeListener("update",this.update,this),this._texture=t,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(t,e){e===void 0&&(e=t);const r=this.mapCoord;for(let i=0;i<t.length;i+=2){const s=t[i],o=t[i+1];e[i]=s*r.a+o*r.c+r.tx,e[i+1]=s*r.b+o*r.d+r.ty}return e}update(){const t=this._texture;this._updateID++;const e=t.uvs;this.mapCoord.set(e.x1-e.x0,e.y1-e.y0,e.x3-e.x0,e.y3-e.y0,e.x0,e.y0);const r=t.orig,i=t.trim;i&&(ko.set(r.width/i.width,0,0,r.height/i.height,-i.x/i.width,-i.y/i.height),this.mapCoord.append(ko));const s=t.source,o=this.uClampFrame,a=this.clampMargin/s._resolution,h=this.clampOffset/s._resolution;return o[0]=(t.frame.x+a+h)/s.width,o[1]=(t.frame.y+a+h)/s.height,o[2]=(t.frame.x+t.frame.width-a+h)/s.width,o[3]=(t.frame.y+t.frame.height-a+h)/s.height,this.uClampOffset[0]=this.clampOffset/s.pixelWidth,this.uClampOffset[1]=this.clampOffset/s.pixelHeight,this.isSimple=t.frame.width===s.width&&t.frame.height===s.height&&t.rotate===0,!0}}class D extends Ut{constructor({source:t,label:e,frame:r,orig:i,trim:s,defaultAnchor:o,defaultBorders:a,rotate:h,dynamic:c}={}){if(super(),this.uid=Z("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new Y,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=e,this.source=(t==null?void 0:t.source)??new Pt,this.noFrame=!r,r)this.frame.copyFrom(r);else{const{width:l,height:u}=this._source;this.frame.width=l,this.frame.height=u}this.orig=i||this.frame,this.trim=s,this.rotate=h??0,this.defaultAnchor=o,this.defaultBorders=a,this.destroyed=!1,this.dynamic=c||!1,this.updateUvs()}set source(t){this._source&&this._source.off("resize",this.update,this),this._source=t,t.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new ep(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:t,frame:e}=this,{width:r,height:i}=this._source,s=e.x/r,o=e.y/i,a=e.width/r,h=e.height/i;let c=this.rotate;if(c){const l=a/2,u=h/2,d=s+l,f=o+u;c=$.add(c,$.NW),t.x0=d+l*$.uX(c),t.y0=f+u*$.uY(c),c=$.add(c,2),t.x1=d+l*$.uX(c),t.y1=f+u*$.uY(c),c=$.add(c,2),t.x2=d+l*$.uX(c),t.y2=f+u*$.uY(c),c=$.add(c,2),t.x3=d+l*$.uX(c),t.y3=f+u*$.uY(c)}else t.x0=s,t.y0=o,t.x1=s+a,t.y1=o,t.x2=s+a,t.y2=o+h,t.x3=s,t.y3=o+h}destroy(t=!1){this._source&&(this._source.off("resize",this.update,this),t&&(this._source.destroy(),this._source=null)),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return U(W,"Texture.baseTexture is now Texture.source"),this._source}}D.EMPTY=new D({label:"EMPTY",source:new Pt({label:"EMPTY"})});D.EMPTY.destroy=Th;D.WHITE=new D({source:new ms({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});D.WHITE.destroy=Th;function np(n,t,e){const{width:r,height:i}=e.orig,s=e.trim;if(s){const o=s.width,a=s.height;n.minX=s.x-t._x*r,n.maxX=n.minX+o,n.minY=s.y-t._y*i,n.maxY=n.minY+a}else n.minX=-t._x*r,n.maxX=n.minX+r,n.minY=-t._y*i,n.maxY=n.minY+i}const Eo=new z;class Mt{constructor(t=1/0,e=1/0,r=-1/0,i=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=Eo,this.minX=t,this.minY=e,this.maxX=r,this.maxY=i}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new Y);const t=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(t.x=0,t.y=0,t.width=0,t.height=0):t.copyFromBounds(this),t}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=Eo,this}set(t,e,r,i){this.minX=t,this.minY=e,this.maxX=r,this.maxY=i}addFrame(t,e,r,i,s){s||(s=this.matrix);const o=s.a,a=s.b,h=s.c,c=s.d,l=s.tx,u=s.ty;let d=this.minX,f=this.minY,p=this.maxX,g=this.maxY,m=o*t+h*e+l,y=a*t+c*e+u;m<d&&(d=m),y<f&&(f=y),m>p&&(p=m),y>g&&(g=y),m=o*r+h*e+l,y=a*r+c*e+u,m<d&&(d=m),y<f&&(f=y),m>p&&(p=m),y>g&&(g=y),m=o*t+h*i+l,y=a*t+c*i+u,m<d&&(d=m),y<f&&(f=y),m>p&&(p=m),y>g&&(g=y),m=o*r+h*i+l,y=a*r+c*i+u,m<d&&(d=m),y<f&&(f=y),m>p&&(p=m),y>g&&(g=y),this.minX=d,this.minY=f,this.maxX=p,this.maxY=g}addRect(t,e){this.addFrame(t.x,t.y,t.x+t.width,t.y+t.height,e)}addBounds(t,e){this.addFrame(t.minX,t.minY,t.maxX,t.maxY,e)}addBoundsMask(t){this.minX=this.minX>t.minX?this.minX:t.minX,this.minY=this.minY>t.minY?this.minY:t.minY,this.maxX=this.maxX<t.maxX?this.maxX:t.maxX,this.maxY=this.maxY<t.maxY?this.maxY:t.maxY}applyMatrix(t){const e=this.minX,r=this.minY,i=this.maxX,s=this.maxY,{a:o,b:a,c:h,d:c,tx:l,ty:u}=t;let d=o*e+h*r+l,f=a*e+c*r+u;this.minX=d,this.minY=f,this.maxX=d,this.maxY=f,d=o*i+h*r+l,f=a*i+c*r+u,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY,d=o*e+h*s+l,f=a*e+c*s+u,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY,d=o*i+h*s+l,f=a*i+c*s+u,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY}fit(t){return this.minX<t.left&&(this.minX=t.left),this.maxX>t.right&&(this.maxX=t.right),this.minY<t.top&&(this.minY=t.top),this.maxY>t.bottom&&(this.maxY=t.bottom),this}fitBounds(t,e,r,i){return this.minX<t&&(this.minX=t),this.maxX>e&&(this.maxX=e),this.minY<r&&(this.minY=r),this.maxY>i&&(this.maxY=i),this}pad(t,e=t){return this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new Mt(this.minX,this.minY,this.maxX,this.maxY)}scale(t,e=t){return this.minX*=t,this.minY*=e,this.maxX*=t,this.maxY*=e,this}get x(){return this.minX}set x(t){const e=this.maxX-this.minX;this.minX=t,this.maxX=t+e}get y(){return this.minY}set y(t){const e=this.maxY-this.minY;this.minY=t,this.maxY=t+e}get width(){return this.maxX-this.minX}set width(t){this.maxX=this.minX+t}get height(){return this.maxY-this.minY}set height(t){this.maxY=this.minY+t}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(t,e,r,i){let s=this.minX,o=this.minY,a=this.maxX,h=this.maxY;i||(i=this.matrix);const c=i.a,l=i.b,u=i.c,d=i.d,f=i.tx,p=i.ty;for(let g=e;g<r;g+=2){const m=t[g],y=t[g+1],x=c*m+u*y+f,_=l*m+d*y+p;s=x<s?x:s,o=_<o?_:o,a=x>a?x:a,h=_>h?_:h}this.minX=s,this.minY=o,this.maxX=a,this.maxY=h}containsPoint(t,e){return this.minX<=t&&this.minY<=e&&this.maxX>=t&&this.maxY>=e}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(t){return this.minX=t.minX,this.minY=t.minY,this.maxX=t.maxX,this.maxY=t.maxY,this}}var rp={grad:.9,turn:360,rad:360/(2*Math.PI)},Lt=function(n){return typeof n=="string"?n.length>0:typeof n=="number"},et=function(n,t,e){return t===void 0&&(t=0),e===void 0&&(e=Math.pow(10,t)),Math.round(e*n)/e+0},xt=function(n,t,e){return t===void 0&&(t=0),e===void 0&&(e=1),n>e?e:n>t?n:t},Bh=function(n){return(n=isFinite(n)?n%360:0)>0?n:n+360},Io=function(n){return{r:xt(n.r,0,255),g:xt(n.g,0,255),b:xt(n.b,0,255),a:xt(n.a)}},$r=function(n){return{r:et(n.r),g:et(n.g),b:et(n.b),a:et(n.a,3)}},ip=/^#([0-9a-f]{3,8})$/i,Bn=function(n){var t=n.toString(16);return t.length<2?"0"+t:t},Lh=function(n){var t=n.r,e=n.g,r=n.b,i=n.a,s=Math.max(t,e,r),o=s-Math.min(t,e,r),a=o?s===t?(e-r)/o:s===e?2+(r-t)/o:4+(t-e)/o:0;return{h:60*(a<0?a+6:a),s:s?o/s*100:0,v:s/255*100,a:i}},Dh=function(n){var t=n.h,e=n.s,r=n.v,i=n.a;t=t/360*6,e/=100,r/=100;var s=Math.floor(t),o=r*(1-e),a=r*(1-(t-s)*e),h=r*(1-(1-t+s)*e),c=s%6;return{r:255*[r,a,o,o,h,r][c],g:255*[h,r,r,a,o,o][c],b:255*[o,o,h,r,r,a][c],a:i}},Ro=function(n){return{h:Bh(n.h),s:xt(n.s,0,100),l:xt(n.l,0,100),a:xt(n.a)}},Fo=function(n){return{h:et(n.h),s:et(n.s),l:et(n.l),a:et(n.a,3)}},Bo=function(n){return Dh((e=(t=n).s,{h:t.h,s:(e*=((r=t.l)<50?r:100-r)/100)>0?2*e/(r+e)*100:0,v:r+e,a:t.a}));var t,e,r},sn=function(n){return{h:(t=Lh(n)).h,s:(i=(200-(e=t.s))*(r=t.v)/100)>0&&i<200?e*r/100/(i<=100?i:200-i)*100:0,l:i/2,a:t.a};var t,e,r,i},sp=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,op=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ap=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,hp=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Li={string:[[function(n){var t=ip.exec(n);return t?(n=t[1]).length<=4?{r:parseInt(n[0]+n[0],16),g:parseInt(n[1]+n[1],16),b:parseInt(n[2]+n[2],16),a:n.length===4?et(parseInt(n[3]+n[3],16)/255,2):1}:n.length===6||n.length===8?{r:parseInt(n.substr(0,2),16),g:parseInt(n.substr(2,2),16),b:parseInt(n.substr(4,2),16),a:n.length===8?et(parseInt(n.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(n){var t=ap.exec(n)||hp.exec(n);return t?t[2]!==t[4]||t[4]!==t[6]?null:Io({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(n){var t=sp.exec(n)||op.exec(n);if(!t)return null;var e,r,i=Ro({h:(e=t[1],r=t[2],r===void 0&&(r="deg"),Number(e)*(rp[r]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return Bo(i)},"hsl"]],object:[[function(n){var t=n.r,e=n.g,r=n.b,i=n.a,s=i===void 0?1:i;return Lt(t)&&Lt(e)&&Lt(r)?Io({r:Number(t),g:Number(e),b:Number(r),a:Number(s)}):null},"rgb"],[function(n){var t=n.h,e=n.s,r=n.l,i=n.a,s=i===void 0?1:i;if(!Lt(t)||!Lt(e)||!Lt(r))return null;var o=Ro({h:Number(t),s:Number(e),l:Number(r),a:Number(s)});return Bo(o)},"hsl"],[function(n){var t=n.h,e=n.s,r=n.v,i=n.a,s=i===void 0?1:i;if(!Lt(t)||!Lt(e)||!Lt(r))return null;var o=(function(a){return{h:Bh(a.h),s:xt(a.s,0,100),v:xt(a.v,0,100),a:xt(a.a)}})({h:Number(t),s:Number(e),v:Number(r),a:Number(s)});return Dh(o)},"hsv"]]},Lo=function(n,t){for(var e=0;e<t.length;e++){var r=t[e][0](n);if(r)return[r,t[e][1]]}return[null,void 0]},cp=function(n){return typeof n=="string"?Lo(n.trim(),Li.string):typeof n=="object"&&n!==null?Lo(n,Li.object):[null,void 0]},Hr=function(n,t){var e=sn(n);return{h:e.h,s:xt(e.s+100*t,0,100),l:e.l,a:e.a}},Vr=function(n){return(299*n.r+587*n.g+114*n.b)/1e3/255},Do=function(n,t){var e=sn(n);return{h:e.h,s:e.s,l:xt(e.l+100*t,0,100),a:e.a}},Di=(function(){function n(t){this.parsed=cp(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return n.prototype.isValid=function(){return this.parsed!==null},n.prototype.brightness=function(){return et(Vr(this.rgba),2)},n.prototype.isDark=function(){return Vr(this.rgba)<.5},n.prototype.isLight=function(){return Vr(this.rgba)>=.5},n.prototype.toHex=function(){return t=$r(this.rgba),e=t.r,r=t.g,i=t.b,o=(s=t.a)<1?Bn(et(255*s)):"","#"+Bn(e)+Bn(r)+Bn(i)+o;var t,e,r,i,s,o},n.prototype.toRgb=function(){return $r(this.rgba)},n.prototype.toRgbString=function(){return t=$r(this.rgba),e=t.r,r=t.g,i=t.b,(s=t.a)<1?"rgba("+e+", "+r+", "+i+", "+s+")":"rgb("+e+", "+r+", "+i+")";var t,e,r,i,s},n.prototype.toHsl=function(){return Fo(sn(this.rgba))},n.prototype.toHslString=function(){return t=Fo(sn(this.rgba)),e=t.h,r=t.s,i=t.l,(s=t.a)<1?"hsla("+e+", "+r+"%, "+i+"%, "+s+")":"hsl("+e+", "+r+"%, "+i+"%)";var t,e,r,i,s},n.prototype.toHsv=function(){return t=Lh(this.rgba),{h:et(t.h),s:et(t.s),v:et(t.v),a:et(t.a,3)};var t},n.prototype.invert=function(){return Tt({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},n.prototype.saturate=function(t){return t===void 0&&(t=.1),Tt(Hr(this.rgba,t))},n.prototype.desaturate=function(t){return t===void 0&&(t=.1),Tt(Hr(this.rgba,-t))},n.prototype.grayscale=function(){return Tt(Hr(this.rgba,-1))},n.prototype.lighten=function(t){return t===void 0&&(t=.1),Tt(Do(this.rgba,t))},n.prototype.darken=function(t){return t===void 0&&(t=.1),Tt(Do(this.rgba,-t))},n.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},n.prototype.alpha=function(t){return typeof t=="number"?Tt({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):et(this.rgba.a,3);var e},n.prototype.hue=function(t){var e=sn(this.rgba);return typeof t=="number"?Tt({h:t,s:e.s,l:e.l,a:e.a}):et(e.h)},n.prototype.isEqual=function(t){return this.toHex()===Tt(t).toHex()},n})(),Tt=function(n){return n instanceof Di?n:new Di(n)},Go=[],lp=function(n){n.forEach(function(t){Go.indexOf(t)<0&&(t(Di,Li),Go.push(t))})};function up(n,t){var e={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},r={};for(var i in e)r[e[i]]=i;var s={};n.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,h,c=r[this.toHex()];if(c)return c;if(o!=null&&o.closest){var l=this.toRgb(),u=1/0,d="black";if(!s.length)for(var f in e)s[f]=new n(e[f]).toRgb();for(var p in e){var g=(a=l,h=s[p],Math.pow(a.r-h.r,2)+Math.pow(a.g-h.g,2)+Math.pow(a.b-h.b,2));g<u&&(u=g,d=p)}return d}},t.string.push([function(o){var a=o.toLowerCase(),h=a==="transparent"?"#0000":e[a];return h?new n(h).toRgb():null},"name"])}lp([up]);const Re=class Je{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof Je)this._value=this._cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,t))&&(this._value=this._cloneSource(t),this._normalize(this._value))}}get value(){return this._value}_cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}_isSourceEqual(t,e){const r=typeof t;if(r!==typeof e)return!1;if(r==="number"||r==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((s,o)=>s===e[o]);if(t!==null&&e!==null){const s=Object.keys(t),o=Object.keys(e);return s.length!==o.length?!1:s.every(a=>t[a]===e[a])}return t===e}toRgba(){const[t,e,r,i]=this._components;return{r:t,g:e,b:r,a:i}}toRgb(){const[t,e,r]=this._components;return{r:t,g:e,b:r}}toRgbaString(){const[t,e,r]=this.toUint8RgbArray();return`rgba(${t},${e},${r},${this.alpha})`}toUint8RgbArray(t){const[e,r,i]=this._components;return this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb),t[0]=Math.round(e*255),t[1]=Math.round(r*255),t[2]=Math.round(i*255),t}toArray(t){this._arrayRgba||(this._arrayRgba=[]),t||(t=this._arrayRgba);const[e,r,i,s]=this._components;return t[0]=e,t[1]=r,t[2]=i,t[3]=s,t}toRgbArray(t){this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb);const[e,r,i]=this._components;return t[0]=e,t[1]=r,t[2]=i,t}toNumber(){return this._int}toBgrNumber(){const[t,e,r]=this.toUint8RgbArray();return(r<<16)+(e<<8)+t}toLittleEndianNumber(){const t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){const[e,r,i,s]=Je._temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=r,this._components[2]*=i,this._components[3]*=s,this._refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this._refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let r=this._int>>16&255,i=this._int>>8&255,s=this._int&255;return e&&(r=r*t+.5|0,i=i*t+.5|0,s=s*t+.5|0),(t*255<<24)+(r<<16)+(i<<8)+s}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(t){return this._components[3]=this._clamp(t),this}_normalize(t){let e,r,i,s;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){const o=t;e=(o>>16&255)/255,r=(o>>8&255)/255,i=(o&255)/255,s=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,r,i,s=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,r,i,s=255]=t,e/=255,r/=255,i/=255,s/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){const a=Je.HEX_PATTERN.exec(t);a&&(t=`#${a[2]}`)}const o=Tt(t);o.isValid()&&({r:e,g:r,b:i,a:s}=o.rgba,e/=255,r/=255,i/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=r,this._components[2]=i,this._components[3]=s,this._refreshInt();else throw new Error(`Unable to convert color ${t}`)}_refreshInt(){this._clamp(this._components);const[t,e,r]=this._components;this._int=(t*255<<16)+(e*255<<8)+(r*255|0)}_clamp(t,e=0,r=1){return typeof t=="number"?Math.min(Math.max(t,e),r):(t.forEach((i,s)=>{t[s]=Math.min(Math.max(i,e),r)}),t)}static isColorLike(t){return typeof t=="number"||typeof t=="string"||t instanceof Number||t instanceof Je||Array.isArray(t)||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Float32Array||t.r!==void 0&&t.g!==void 0&&t.b!==void 0||t.r!==void 0&&t.g!==void 0&&t.b!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0&&t.a!==void 0}};Re.shared=new Re;Re._temp=new Re;Re.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let _t=Re;const dp={cullArea:null,cullable:!1,cullableChildren:!0};let Wr=0;const Oo=500;function j(...n){Wr!==Oo&&(Wr++,Wr===Oo?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...n))}const br={_registeredResources:new Set,register(n){this._registeredResources.add(n)},unregister(n){this._registeredResources.delete(n)},release(){this._registeredResources.forEach(n=>n.clear())},get registeredCount(){return this._registeredResources.size},isRegistered(n){return this._registeredResources.has(n)},reset(){this._registeredResources.clear()}};class fp{constructor(t,e){this._pool=[],this._count=0,this._index=0,this._classType=t,e&&this.prepopulate(e)}prepopulate(t){for(let e=0;e<t;e++)this._pool[this._index++]=new this._classType;this._count+=t}get(t){var r;let e;return this._index>0?e=this._pool[--this._index]:(e=new this._classType,this._count++),(r=e.init)==null||r.call(e,t),e}return(t){var e;(e=t.reset)==null||e.call(t),this._pool[this._index++]=t}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){if(this._pool.length>0&&this._pool[0].destroy)for(let t=0;t<this._index;t++)this._pool[t].destroy();this._pool.length=0,this._count=0,this._index=0}}class pp{constructor(){this._poolsByClass=new Map}prepopulate(t,e){this.getPool(t).prepopulate(e)}get(t,e){return this.getPool(t).get(e)}return(t){this.getPool(t.constructor).return(t)}getPool(t){return this._poolsByClass.has(t)||this._poolsByClass.set(t,new fp(t)),this._poolsByClass.get(t)}stats(){const t={};return this._poolsByClass.forEach(e=>{const r=t[e._classType.name]?e._classType.name+e._classType.ID:e._classType.name;t[r]={free:e.totalFree,used:e.totalUsed,size:e.totalSize}}),t}clear(){this._poolsByClass.forEach(t=>t.clear()),this._poolsByClass.clear()}}const ut=new pp;br.register(ut);const gp={get isCachedAsTexture(){var n;return!!((n=this.renderGroup)!=null&&n.isCachedAsTexture)},cacheAsTexture(n){typeof n=="boolean"&&n===!1?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(n===!0?{}:n))},updateCacheTexture(){var n;(n=this.renderGroup)==null||n.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(n){U("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(n)}};function mp(n,t,e){const r=n.length;let i;if(t>=r||e===0)return;e=t+e>r?r-t:e;const s=r-e;for(i=t;i<s;++i)n[i]=n[i+e];n.length=s}const yp={allowChildren:!0,removeChildren(n=0,t){var s;const e=t??this.children.length,r=e-n,i=[];if(r>0&&r<=e){for(let a=e-1;a>=n;a--){const h=this.children[a];h&&(i.push(h),h.parent=null)}mp(this.children,n,e);const o=this.renderGroup||this.parentRenderGroup;o&&o.removeChildren(i);for(let a=0;a<i.length;++a){const h=i[a];(s=h.parentRenderLayer)==null||s.detach(h),this.emit("childRemoved",h,this,a),i[a].emit("removed",this)}return i.length>0&&this._didViewChangeTick++,i}else if(r===0&&this.children.length===0)return i;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(n){const t=this.getChildAt(n);return this.removeChild(t)},getChildAt(n){if(n<0||n>=this.children.length)throw new Error(`getChildAt: Index (${n}) does not exist.`);return this.children[n]},setChildIndex(n,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);this.getChildIndex(n),this.addChildAt(n,t)},getChildIndex(n){const t=this.children.indexOf(n);if(t===-1)throw new Error("The supplied Container must be a child of the caller");return t},addChildAt(n,t){this.allowChildren||U(W,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:e}=this;if(t<0||t>e.length)throw new Error(`${n}addChildAt: The index ${t} supplied is out of bounds ${e.length}`);if(n.parent){const i=n.parent.children.indexOf(n);if(n.parent===this&&i===t)return n;i!==-1&&n.parent.children.splice(i,1)}t===e.length?e.push(n):e.splice(t,0,n),n.parent=this,n.didChange=!0,n._updateFlags=15;const r=this.renderGroup||this.parentRenderGroup;return r&&r.addChild(n),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",n,this,t),n.emit("added",this),n},swapChildren(n,t){if(n===t)return;const e=this.getChildIndex(n),r=this.getChildIndex(t);this.children[e]=t,this.children[r]=n;const i=this.renderGroup||this.parentRenderGroup;i&&(i.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){var n;(n=this.parent)==null||n.removeChild(this)},reparentChild(...n){return n.length===1?this.reparentChildAt(n[0],this.children.length):(n.forEach(t=>this.reparentChildAt(t,this.children.length)),n[0])},reparentChildAt(n,t){if(n.parent===this)return this.setChildIndex(n,t),n;const e=n.worldTransform.clone();n.removeFromParent(),this.addChildAt(n,t);const r=this.worldTransform.clone();return r.invert(),e.prepend(r),n.setFromMatrix(e),n},replaceChild(n,t){n.updateLocalTransform(),this.addChildAt(t,this.getChildIndex(n)),t.setFromMatrix(n.localTransform),t.updateLocalTransform(),this.removeChild(n)}},xp={collectRenderables(n,t,e){this.parentRenderLayer&&this.parentRenderLayer!==e||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(n,t,e):this.renderGroup?t.renderPipes.renderGroup.addRenderGroup(this.renderGroup,n):this.collectRenderablesWithEffects(n,t,e))},collectRenderablesSimple(n,t,e){const r=this.children,i=r.length;for(let s=0;s<i;s++)r[s].collectRenderables(n,t,e)},collectRenderablesWithEffects(n,t,e){const{renderPipes:r}=t;for(let i=0;i<this.effects.length;i++){const s=this.effects[i];r[s.pipe].push(s,this,n)}this.collectRenderablesSimple(n,t,e);for(let i=this.effects.length-1;i>=0;i--){const s=this.effects[i];r[s.pipe].pop(s,this,n)}}};class zo{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let t=0;t<this.filters.length;t++)this.filters[t].destroy();this.filters=null,this.filterArea=null}}class _p{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(t=>{this.add({test:t.test,maskClass:t})}))}add(t){this._tests.push(t)}getMaskEffect(t){this._initialized||this.init();for(let e=0;e<this._tests.length;e++){const r=this._tests[e];if(r.test(t))return ut.get(r.maskClass,t)}return t}returnMaskEffect(t){ut.return(t)}}const Gi=new _p;tt.handleByList(F.MaskEffect,Gi._effectClasses);const bp={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const n=this.renderGroup||this.parentRenderGroup;n&&(n.structureDidChange=!0)},addEffect(n){this.effects.indexOf(n)===-1&&(this.effects.push(n),this.effects.sort((e,r)=>e.priority-r.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(n){const t=this.effects.indexOf(n);t!==-1&&(this.effects.splice(t,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(n){const t=this._maskEffect;(t==null?void 0:t.mask)!==n&&(t&&(this.removeEffect(t),Gi.returnMaskEffect(t),this._maskEffect=null),n!=null&&(this._maskEffect=Gi.getMaskEffect(n),this.addEffect(this._maskEffect)))},get mask(){var n;return(n=this._maskEffect)==null?void 0:n.mask},setMask(n){this._maskOptions={...this._maskOptions,...n},n.mask&&(this.mask=n.mask),this._markStructureAsChanged()},set filters(n){var s;!Array.isArray(n)&&n&&(n=[n]);const t=this._filterEffect||(this._filterEffect=new zo);n=n;const e=(n==null?void 0:n.length)>0,r=((s=t.filters)==null?void 0:s.length)>0,i=e!==r;n=Array.isArray(n)?n.slice(0):n,t.filters=Object.freeze(n),i&&(e?this.addEffect(t):(this.removeEffect(t),t.filters=n??null))},get filters(){var n;return(n=this._filterEffect)==null?void 0:n.filters},set filterArea(n){this._filterEffect||(this._filterEffect=new zo),this._filterEffect.filterArea=n},get filterArea(){var n;return(n=this._filterEffect)==null?void 0:n.filterArea}},vp={label:null,get name(){return U(W,"Container.name property has been removed, use Container.label instead"),this.label},set name(n){U(W,"Container.name property has been removed, use Container.label instead"),this.label=n},getChildByName(n,t=!1){return this.getChildByLabel(n,t)},getChildByLabel(n,t=!1){const e=this.children;for(let r=0;r<e.length;r++){const i=e[r];if(i.label===n||n instanceof RegExp&&n.test(i.label))return i}if(t)for(let r=0;r<e.length;r++){const s=e[r].getChildByLabel(n,!0);if(s)return s}return null},getChildrenByLabel(n,t=!1,e=[]){const r=this.children;for(let i=0;i<r.length;i++){const s=r[i];(s.label===n||n instanceof RegExp&&n.test(s.label))&&e.push(s)}if(t)for(let i=0;i<r.length;i++)r[i].getChildrenByLabel(n,!0,e);return e}},at=ut.getPool(z),Ot=ut.getPool(Mt),wp=new z,Ap={getFastGlobalBounds(n,t){t||(t=new Mt),t.clear(),this._getGlobalBoundsRecursive(!!n,t,this.parentRenderLayer),t.isValid||t.set(0,0,0,0);const e=this.renderGroup||this.parentRenderGroup;return t.applyMatrix(e.worldTransform),t},_getGlobalBoundsRecursive(n,t,e){let r=t;if(n&&this.parentRenderLayer&&this.parentRenderLayer!==e||this.localDisplayStatus!==7||!this.measurable)return;const i=!!this.effects.length;if((this.renderGroup||i)&&(r=Ot.get().clear()),this.boundsArea)t.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){const o=this.bounds;r.addFrame(o.minX,o.minY,o.maxX,o.maxY,this.groupTransform)}const s=this.children;for(let o=0;o<s.length;o++)s[o]._getGlobalBoundsRecursive(n,r,e)}if(i){let s=!1;const o=this.renderGroup||this.parentRenderGroup;for(let a=0;a<this.effects.length;a++)this.effects[a].addBounds&&(s||(s=!0,r.applyMatrix(o.worldTransform)),this.effects[a].addBounds(r,!0));s&&r.applyMatrix(o.worldTransform.copyTo(wp).invert()),t.addBounds(r),Ot.return(r)}else this.renderGroup&&(t.addBounds(r,this.relativeGroupTransform),Ot.return(r))}};function Gh(n,t,e){e.clear();let r,i;return n.parent?t?r=n.parent.worldTransform:(i=at.get().identity(),r=ys(n,i)):r=z.IDENTITY,Oh(n,e,r,t),i&&at.return(i),e.isValid||e.set(0,0,0,0),e}function Oh(n,t,e,r){var a,h;if(!n.visible||!n.measurable)return;let i;r?i=n.worldTransform:(n.updateLocalTransform(),i=at.get(),i.appendFrom(n.localTransform,e));const s=t,o=!!n.effects.length;if(o&&(t=Ot.get().clear()),n.boundsArea)t.addRect(n.boundsArea,i);else{const c=n.bounds;c&&!c.isEmpty()&&(t.matrix=i,t.addBounds(c));for(let l=0;l<n.children.length;l++)Oh(n.children[l],t,i,r)}if(o){for(let c=0;c<n.effects.length;c++)(h=(a=n.effects[c]).addBounds)==null||h.call(a,t);s.addBounds(t,z.IDENTITY),Ot.return(t)}r||at.return(i)}function ys(n,t){const e=n.parent;return e&&(ys(e,t),e.updateLocalTransform(),t.append(e.localTransform)),t}function zh(n,t){if(n===16777215||!t)return t;if(t===16777215||!n)return n;const e=n>>16&255,r=n>>8&255,i=n&255,s=t>>16&255,o=t>>8&255,a=t&255,h=e*s/255|0,c=r*o/255|0,l=i*a/255|0;return(h<<16)+(c<<8)+l}const No=16777215;function Uo(n,t){return n===No?t:t===No?n:zh(n,t)}function Kn(n){return((n&255)<<16)+(n&65280)+(n>>16&255)}const Cp={getGlobalAlpha(n){if(n)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let t=this.alpha,e=this.parent;for(;e;)t*=e.alpha,e=e.parent;return t},getGlobalTransform(n=new z,t){if(t)return n.copyFrom(this.worldTransform);this.updateLocalTransform();const e=ys(this,at.get().identity());return n.appendFrom(this.localTransform,e),at.return(e),n},getGlobalTint(n){if(n)return this.renderGroup?Kn(this.renderGroup.worldColor):this.parentRenderGroup?Kn(Uo(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let t=this.localColor,e=this.parent;for(;e;)t=Uo(t,e.localColor),e=e.parent;return Kn(t)}};function Nh(n,t,e){return t.clear(),e||(e=z.IDENTITY),Uh(n,t,e,n,!0),t.isValid||t.set(0,0,0,0),t}function Uh(n,t,e,r,i){var h,c;let s;if(i)s=at.get(),s=e.copyTo(s);else{if(!n.visible||!n.measurable)return;n.updateLocalTransform();const l=n.localTransform;s=at.get(),s.appendFrom(l,e)}const o=t,a=!!n.effects.length;if(a&&(t=Ot.get().clear()),n.boundsArea)t.addRect(n.boundsArea,s);else{n.renderPipeId&&(t.matrix=s,t.addBounds(n.bounds));const l=n.children;for(let u=0;u<l.length;u++)Uh(l[u],t,s,r,!1)}if(a){for(let l=0;l<n.effects.length;l++)(c=(h=n.effects[l]).addLocalBounds)==null||c.call(h,t,r);o.addBounds(t,z.IDENTITY),Ot.return(t)}at.return(s)}function $h(n,t){const e=n.children;for(let r=0;r<e.length;r++){const i=e[r],s=i.uid,o=(i._didViewChangeTick&65535)<<16|i._didContainerChangeTick&65535,a=t.index;(t.data[a]!==s||t.data[a+1]!==o)&&(t.data[t.index]=s,t.data[t.index+1]=o,t.didChange=!0),t.index=a+2,i.children.length&&$h(i,t)}return t.didChange}const Mp=new z,Sp={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(n,t){const e=Math.sign(this.scale.x)||1;t!==0?this.scale.x=n/t*e:this.scale.x=e},_setHeight(n,t){const e=Math.sign(this.scale.y)||1;t!==0?this.scale.y=n/t*e:this.scale.y=e},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new Mt});const n=this._localBoundsCacheData;return n.index=1,n.didChange=!1,n.data[0]!==this._didViewChangeTick&&(n.didChange=!0,n.data[0]=this._didViewChangeTick),$h(this,n),n.didChange&&Nh(this,n.localBounds,Mp),n.localBounds},getBounds(n,t){return Gh(this,n,t||new Mt)}},Pp={_onRender:null,set onRender(n){const t=this.renderGroup||this.parentRenderGroup;if(!n){this._onRender&&(t==null||t.removeOnRender(this)),this._onRender=null;return}this._onRender||t==null||t.addOnRender(this),this._onRender=n},get onRender(){return this._onRender}},Tp={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(n){this._zIndex!==n&&(this._zIndex=n,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(kp))}};function kp(n,t){return n._zIndex-t._zIndex}const Ep={getGlobalPosition(n=new V,t=!1){return this.parent?this.parent.toGlobal(this._position,n,t):(n.x=this._position.x,n.y=this._position.y),n},toGlobal(n,t,e=!1){const r=this.getGlobalTransform(at.get(),e);return t=r.apply(n,t),at.return(r),t},toLocal(n,t,e,r){t&&(n=t.toGlobal(n,e,r));const i=this.getGlobalTransform(at.get(),r);return e=i.applyInverse(n,e),at.return(i),e}};class xs{constructor(){this.uid=Z("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}destroy(){this.instructions.length=0,this.renderables.length=0,this.renderPipes=null,this.gcTick=0}add(t){this.instructions[this.instructionSize++]=t}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}let Ip=0;class Rp{constructor(t){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this.textureStyle=new Ih(this.textureOptions)}createTexture(t,e,r){const i=new Pt({...this.textureOptions,width:t,height:e,resolution:1,antialias:r,autoGarbageCollect:!1});return new D({source:i,label:`texturePool_${Ip++}`})}getOptimalTexture(t,e,r=1,i){let s=Math.ceil(t*r-1e-6),o=Math.ceil(e*r-1e-6);s=So(s),o=So(o);const a=(s<<17)+(o<<1)+(i?1:0);this._texturePool[a]||(this._texturePool[a]=[]);let h=this._texturePool[a].pop();return h||(h=this.createTexture(s,o,i)),h.source._resolution=r,h.source.width=s/r,h.source.height=o/r,h.source.pixelWidth=s,h.source.pixelHeight=o,h.frame.x=0,h.frame.y=0,h.frame.width=t,h.frame.height=e,h.updateUvs(),this._poolKeyHash[h.uid]=a,h}getSameSizeTexture(t,e=!1){const r=t.source;return this.getOptimalTexture(t.width,t.height,r._resolution,e)}returnTexture(t,e=!1){const r=this._poolKeyHash[t.uid];e&&(t.source.style=this.textureStyle),this._texturePool[r].push(t)}clear(t){if(t=t!==!1,t)for(const e in this._texturePool){const r=this._texturePool[e];if(r)for(let i=0;i<r.length;i++)r[i].destroy(!0)}this._texturePool={}}}const Hh=new Rp;br.register(Hh);class Fp{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new z,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new xs,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(t){this.root=t,t._onRender&&this.addOnRender(t),t.didChange=!0;const e=t.children;for(let r=0;r<e.length;r++){const i=e[r];i._updateFlags=15,this.addChild(i)}}enableCacheAsTexture(t={}){this.textureOptions=t,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(Hh.returnTexture(this.texture,!0),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0;const t=this._parentCacheAsTextureRenderGroup;t&&!t.textureNeedsUpdate&&t.updateCacheTexture()}reset(){this.renderGroupChildren.length=0;for(const t in this.childrenToUpdate){const e=this.childrenToUpdate[t];e.list.fill(null),e.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(t){t.renderGroupParent&&t.renderGroupParent._removeRenderGroupChild(t),t.renderGroupParent=this,this.renderGroupChildren.push(t)}_removeRenderGroupChild(t){const e=this.renderGroupChildren.indexOf(t);e>-1&&this.renderGroupChildren.splice(e,1),t.renderGroupParent=null}addChild(t){if(this.structureDidChange=!0,t.parentRenderGroup=this,t.updateTick=-1,t.parent===this.root?t.relativeRenderGroupDepth=1:t.relativeRenderGroupDepth=t.parent.relativeRenderGroupDepth+1,t.didChange=!0,this.onChildUpdate(t),t.renderGroup){this.addRenderGroupChild(t.renderGroup);return}t._onRender&&this.addOnRender(t);const e=t.children;for(let r=0;r<e.length;r++)this.addChild(e[r])}removeChild(t){if(this.structureDidChange=!0,t._onRender&&(t.renderGroup||this.removeOnRender(t)),t.parentRenderGroup=null,t.renderGroup){this._removeRenderGroupChild(t.renderGroup);return}const e=t.children;for(let r=0;r<e.length;r++)this.removeChild(e[r])}removeChildren(t){for(let e=0;e<t.length;e++)this.removeChild(t[e])}onChildUpdate(t){let e=this.childrenToUpdate[t.relativeRenderGroupDepth];e||(e=this.childrenToUpdate[t.relativeRenderGroupDepth]={index:0,list:[]}),e.list[e.index++]=t}updateRenderable(t){t.globalDisplayStatus<7||(this.instructionSet.renderPipes[t.renderPipeId].updateRenderable(t),t.didViewUpdate=!1)}onChildViewUpdate(t){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=t}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(t){this._onRenderContainers.push(t)}removeOnRender(t){this._onRenderContainers.splice(this._onRenderContainers.indexOf(t),1)}runOnRender(t){for(let e=0;e<this._onRenderContainers.length;e++)this._onRenderContainers[e]._onRender(t)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(t=[]){const e=this.root.children;for(let r=0;r<e.length;r++)this._getChildren(e[r],t);return t}_getChildren(t,e=[]){if(e.push(t),t.renderGroup)return e;const r=t.children;for(let i=0;i<r.length;i++)this._getChildren(r[i],e);return e}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return(this._matrixDirty&1)===0?this._inverseWorldTransform:(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new z),this._inverseWorldTransform.copyFrom(this.worldTransform).invert())}get textureOffsetInverseTransform(){return(this._matrixDirty&2)===0?this._textureOffsetInverseTransform:(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new z),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y))}get inverseParentTextureTransform(){if((this._matrixDirty&4)===0)return this._inverseParentTextureTransform;this._matrixDirty&=-5;const t=this._parentCacheAsTextureRenderGroup;return t?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new z),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(t.inverseWorldTransform).translate(-t._textureBounds.x,-t._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this.isCachedAsTexture?this.textureOffsetInverseTransform:this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}function Bp(n,t,e={}){for(const r in t)!e[r]&&t[r]!==void 0&&(n[r]=t[r])}const Xr=new st(null),Ln=new st(null),Yr=new st(null,1,1),Dn=new st(null),$o=1,Lp=2,qr=4;class Kt extends Ut{constructor(t={}){var e,r;super(),this.uid=Z("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.parentRenderLayer=null,this.updateTick=-1,this.localTransform=new z,this.relativeGroupTransform=new z,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new st(this,0,0),this._scale=Yr,this._pivot=Ln,this._origin=Dn,this._skew=Xr,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],Bp(this,t,{children:!0,parent:!0,effects:!0}),(e=t.children)==null||e.forEach(i=>this.addChild(i)),(r=t.parent)==null||r.addChild(this)}static mixin(t){U("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),tt.mixin(Kt,t)}set _didChangeId(t){this._didViewChangeTick=t>>12&4095,this._didContainerChangeTick=t&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...t){if(this.allowChildren||U(W,"addChild: Only Containers will be allowed to add children in v8.0.0"),t.length>1){for(let i=0;i<t.length;i++)this.addChild(t[i]);return t[0]}const e=t[0],r=this.renderGroup||this.parentRenderGroup;return e.parent===this?(this.children.splice(this.children.indexOf(e),1),this.children.push(e),r&&(r.structureDidChange=!0),e):(e.parent&&e.parent.removeChild(e),this.children.push(e),this.sortableChildren&&(this.sortDirty=!0),e.parent=this,e.didChange=!0,e._updateFlags=15,r&&r.addChild(e),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this),this._didViewChangeTick++,e._zIndex!==0&&e.depthOfChildModified(),e)}removeChild(...t){if(t.length>1){for(let i=0;i<t.length;i++)this.removeChild(t[i]);return t[0]}const e=t[0],r=this.children.indexOf(e);return r>-1&&(this._didViewChangeTick++,this.children.splice(r,1),this.renderGroup?this.renderGroup.removeChild(e):this.parentRenderGroup&&this.parentRenderGroup.removeChild(e),e.parentRenderLayer&&e.parentRenderLayer.detach(e),e.parent=null,this.emit("childRemoved",e,this,r),e.emit("removed",this)),e}_onUpdate(t){t&&t===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(t){!!this.renderGroup!==t&&(t?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const t=this.parentRenderGroup;t==null||t.removeChild(this),this.renderGroup=ut.get(Fp,this),this.groupTransform=z.IDENTITY,t==null||t.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const t=this.parentRenderGroup;t==null||t.removeChild(this),ut.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,t==null||t.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new z),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(t){this._position.x=t}get y(){return this._position.y}set y(t){this._position.y=t}get position(){return this._position}set position(t){this._position.copyFrom(t)}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this._onUpdate(this._skew))}get angle(){return this.rotation*q0}set angle(t){this.rotation=t*j0}get pivot(){return this._pivot===Ln&&(this._pivot=new st(this,0,0)),this._pivot}set pivot(t){this._pivot===Ln&&(this._pivot=new st(this,0,0),this._origin!==Dn&&j("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),typeof t=="number"?this._pivot.set(t):this._pivot.copyFrom(t)}get skew(){return this._skew===Xr&&(this._skew=new st(this,0,0)),this._skew}set skew(t){this._skew===Xr&&(this._skew=new st(this,0,0)),this._skew.copyFrom(t)}get scale(){return this._scale===Yr&&(this._scale=new st(this,1,1)),this._scale}set scale(t){this._scale===Yr&&(this._scale=new st(this,0,0)),typeof t=="string"&&(t=parseFloat(t)),typeof t=="number"?this._scale.set(t):this._scale.copyFrom(t)}get origin(){return this._origin===Dn&&(this._origin=new st(this,0,0)),this._origin}set origin(t){this._origin===Dn&&(this._origin=new st(this,0,0),this._pivot!==Ln&&j("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),typeof t=="number"?this._origin.set(t):this._origin.copyFrom(t)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(t){const e=this.getLocalBounds().width;this._setWidth(t,e)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(t){const e=this.getLocalBounds().height;this._setHeight(t,e)}getSize(t){t||(t={});const e=this.getLocalBounds();return t.width=Math.abs(this.scale.x*e.width),t.height=Math.abs(this.scale.y*e.height),t}setSize(t,e){const r=this.getLocalBounds();typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,r.width),e!==void 0&&this._setHeight(e,r.height)}_updateSkew(){const t=this._rotation,e=this._skew;this._cx=Math.cos(t+e._y),this._sx=Math.sin(t+e._y),this._cy=-Math.sin(t-e._x),this._sy=Math.cos(t-e._x)}updateTransform(t){return this.position.set(typeof t.x=="number"?t.x:this.position.x,typeof t.y=="number"?t.y:this.position.y),this.scale.set(typeof t.scaleX=="number"?t.scaleX||1:this.scale.x,typeof t.scaleY=="number"?t.scaleY||1:this.scale.y),this.rotation=typeof t.rotation=="number"?t.rotation:this.rotation,this.skew.set(typeof t.skewX=="number"?t.skewX:this.skew.x,typeof t.skewY=="number"?t.skewY:this.skew.y),this.pivot.set(typeof t.pivotX=="number"?t.pivotX:this.pivot.x,typeof t.pivotY=="number"?t.pivotY:this.pivot.y),this.origin.set(typeof t.originX=="number"?t.originX:this.origin.x,typeof t.originY=="number"?t.originY:this.origin.y),this}setFromMatrix(t){t.decompose(this)}updateLocalTransform(){const t=this._didContainerChangeTick;if(this._didLocalTransformChangeId===t)return;this._didLocalTransformChangeId=t;const e=this.localTransform,r=this._scale,i=this._pivot,s=this._origin,o=this._position,a=r._x,h=r._y,c=i._x,l=i._y,u=-s._x,d=-s._y;e.a=this._cx*a,e.b=this._sx*a,e.c=this._cy*h,e.d=this._sy*h,e.tx=o._x-(c*e.a+l*e.c)+(u*e.a+d*e.c)-u,e.ty=o._y-(c*e.b+l*e.d)+(u*e.b+d*e.d)-d}set alpha(t){t!==this.localAlpha&&(this.localAlpha=t,this._updateFlags|=$o,this._onUpdate())}get alpha(){return this.localAlpha}set tint(t){const r=_t.shared.setValue(t??16777215).toBgrNumber();r!==this.localColor&&(this.localColor=r,this._updateFlags|=$o,this._onUpdate())}get tint(){return Kn(this.localColor)}set blendMode(t){this.localBlendMode!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Lp,this.localBlendMode=t,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(t){const e=t?2:0;(this.localDisplayStatus&2)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=qr,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(t){const e=t?0:4;(this.localDisplayStatus&4)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=qr,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(t){const e=t?1:0;(this.localDisplayStatus&1)!==e&&(this._updateFlags|=qr,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(t=!1){var i;if(this.destroyed)return;this.destroyed=!0;let e;if(this.children.length&&(e=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._origin=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),(typeof t=="boolean"?t:t==null?void 0:t.children)&&e)for(let s=0;s<e.length;++s)e[s].destroy(t);(i=this.renderGroup)==null||i.destroy(),this.renderGroup=null}}tt.mixin(Kt,yp,Ap,Ep,Pp,Sp,bp,vp,Tp,dp,gp,Cp,xp);class _s extends Kt{constructor(t){super(t),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._gpuData=Object.create(null),this.autoGarbageCollect=!0,this._gcLastUsed=-1,this._bounds=new Mt(0,1,0,0),this._boundsDirty=!0,this.autoGarbageCollect=t.autoGarbageCollect??!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(t){this._roundPixels=t?1:0}containsPoint(t){const e=this.bounds,{x:r,y:i}=t;return r>=e.minX&&r<=e.maxX&&i>=e.minY&&i<=e.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const t=this.renderGroup||this.parentRenderGroup;t&&t.onChildViewUpdate(this)}unload(){var t;this.emit("unload",this);for(const e in this._gpuData)(t=this._gpuData[e])==null||t.destroy();this._gpuData=Object.create(null),this.onViewUpdate()}destroy(t){this.unload(),super.destroy(t),this._bounds=null}collectRenderablesSimple(t,e,r){const{renderPipes:i}=e;i.blendMode.pushBlendMode(this,this.groupBlendMode,t);const o=i[this.renderPipeId];o!=null&&o.addRenderable&&o.addRenderable(this,t),this.didViewUpdate=!1;const a=this.children,h=a.length;for(let c=0;c<h;c++)a[c].collectRenderables(t,e,r);i.blendMode.popBlendMode(t)}}class gn extends _s{constructor(t=D.EMPTY){t instanceof D&&(t={texture:t});const{texture:e=D.EMPTY,anchor:r,roundPixels:i,width:s,height:o,...a}=t;super({label:"Sprite",...a}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new st({_onUpdate:()=>{this.onViewUpdate()}}),r?this.anchor=r:e.defaultAnchor&&(this.anchor=e.defaultAnchor),this.texture=e,this.allowChildren=!1,this.roundPixels=i??!1,s!==void 0&&(this.width=s),o!==void 0&&(this.height=o)}static from(t,e=!1){return t instanceof D?new gn(t):new gn(D.from(t,e))}set texture(t){t||(t=D.EMPTY);const e=this._texture;e!==t&&(e&&e.dynamic&&e.off("update",this.onViewUpdate,this),t.dynamic&&t.on("update",this.onViewUpdate,this),this._texture=t,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return np(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return U("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const t=this._anchor,e=this._texture,r=this._bounds,{width:i,height:s}=e.orig;r.minX=-t._x*i,r.maxX=r.minX+i,r.minY=-t._y*s,r.maxY=r.minY+s}destroy(t=!1){if(super.destroy(t),typeof t=="boolean"?t:t==null?void 0:t.texture){const r=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._texture.destroy(r)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this._setWidth(t,this._texture.orig.width),this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this._setHeight(t,this._texture.orig.height),this._height=t}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this._texture.orig.width,t.height=Math.abs(this.scale.y)*this._texture.orig.height,t}setSize(t,e){typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,this._texture.orig.width),e!==void 0&&this._setHeight(e,this._texture.orig.height)}}const Dp=new Mt;function Vh(n,t,e){const r=Dp;n.measurable=!0,Gh(n,e,r),t.addBoundsMask(r),n.measurable=!1}function Wh(n,t,e){const r=Ot.get();n.measurable=!0;const i=at.get().identity(),s=Xh(n,e,i);Nh(n,r,s),n.measurable=!1,t.addBoundsMask(r),at.return(i),Ot.return(r)}function Xh(n,t,e){return n?(n!==t&&(Xh(n.parent,t,e),n.updateLocalTransform(),e.append(n.localTransform)),e):(j("Mask bounds, renderable is not inside the root container"),e)}class Yh{constructor(t){this.priority=0,this.inverse=!1,this.pipe="alphaMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t,this.renderMaskToTexture=!(t instanceof gn),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask!==null&&(this.mask.measurable=!0,this.mask=null)}addBounds(t,e){this.inverse||Vh(this.mask,t,e)}addLocalBounds(t,e){Wh(this.mask,t,e)}containsPoint(t,e){const r=this.mask;return e(r,t)}destroy(){this.reset()}static test(t){return t instanceof gn}}Yh.extension=F.MaskEffect;class qh{constructor(t){this.priority=0,this.pipe="colorMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t}destroy(){}static test(t){return typeof t=="number"}}qh.extension=F.MaskEffect;class jh{constructor(t){this.priority=0,this.pipe="stencilMask",t!=null&&t.mask&&this.init(t.mask)}init(t){this.mask=t,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask!==null&&(this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null)}addBounds(t,e){Vh(this.mask,t,e)}addLocalBounds(t,e){Wh(this.mask,t,e)}containsPoint(t,e){const r=this.mask;return e(r,t)}destroy(){this.reset()}static test(t){return t instanceof Kt}}jh.extension=F.MaskEffect;const Gp={createCanvas:(n,t)=>{const e=document.createElement("canvas");return e.width=n,e.height=t,e},createImage:()=>new Image,getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(n,t)=>fetch(n,t),parseXML:n=>new DOMParser().parseFromString(n,"text/xml")};let Ho=Gp;const K={get(){return Ho},set(n){Ho=n}};class vr extends Pt{constructor(t){t.resource||(t.resource=K.get().createCanvas()),t.width||(t.width=t.resource.width,t.autoDensity||(t.width/=t.resolution)),t.height||(t.height=t.resource.height,t.autoDensity||(t.height/=t.resolution)),super(t),this.uploadMethodId="image",this.autoDensity=t.autoDensity,this.resizeCanvas(),this.transparent=!!t.transparent}resizeCanvas(){this.autoDensity&&"style"in this.resource&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(t=this.width,e=this.height,r=this._resolution){const i=super.resize(t,e,r);return i&&this.resizeCanvas(),i}static test(t){return globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&t instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}vr.extension=F.TextureSource;class Fe extends Pt{constructor(t){super(t),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(t){return globalThis.HTMLImageElement&&t instanceof HTMLImageElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||globalThis.VideoFrame&&t instanceof VideoFrame}}Fe.extension=F.TextureSource;var Oi=(n=>(n[n.INTERACTION=50]="INTERACTION",n[n.HIGH=25]="HIGH",n[n.NORMAL=0]="NORMAL",n[n.LOW=-25]="LOW",n[n.UTILITY=-50]="UTILITY",n))(Oi||{});class jr{constructor(t,e=null,r=0,i=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=t,this._context=e,this.priority=r,this._once=i}match(t,e=null){return this._fn===t&&this._context===e}emit(t){this._fn&&(this._context?this._fn.call(this._context,t):this._fn(t));const e=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const Zh=class dt{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new jr(null,null,1/0),this.deltaMS=1/dt.targetFPMS,this.elapsedMS=1/dt.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,r=Oi.NORMAL){return this._addListener(new jr(t,e,r))}addOnce(t,e,r=Oi.NORMAL){return this._addListener(new jr(t,e,r,!0))}_addListener(t){let e=this._head.next,r=this._head;if(!e)t.connect(r);else{for(;e;){if(t.priority>e.priority){t.connect(r);break}r=e,e=e.next}t.previous||t.connect(r)}return this._startIfPossible(),this}remove(t,e){let r=this._head.next;for(;r;)r.match(t,e)?r=r.destroy():r=r.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const s=t-this._lastFrame|0;if(s<this._minElapsedMS)return;this._lastFrame=t-s%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*dt.targetFPMS;const r=this._head;let i=r.next;for(;i;)i=i.emit(this);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),r=Math.min(Math.max(0,e)/1e3,dt.targetFPMS);this._maxElapsedMS=1/r}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!dt._shared){const t=dt._shared=new dt;t.autoStart=!0,t._protected=!0}return dt._shared}static get system(){if(!dt._system){const t=dt._system=new dt;t.autoStart=!0,t._protected=!0}return dt._system}};Zh.targetFPMS=.06;let Gn=Zh,Zr;async function Kh(){return Zr??(Zr=(async()=>{var o;const t=K.get().createCanvas(1,1).getContext("webgl");if(!t)return"premultiply-alpha-on-upload";const e=await new Promise(a=>{const h=document.createElement("video");h.onloadeddata=()=>a(h),h.onerror=()=>a(null),h.autoplay=!1,h.crossOrigin="anonymous",h.preload="auto",h.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",h.load()});if(!e)return"premultiply-alpha-on-upload";const r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);const s=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,s),t.deleteFramebuffer(i),t.deleteTexture(r),(o=t.getExtension("WEBGL_lose_context"))==null||o.loseContext(),s[0]<=s[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),Zr}const wr=class Qh extends Pt{constructor(t){super(t),this.isReady=!1,this.uploadMethodId="video",t={...Qh.defaultOptions,...t},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this.alphaMode=t.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),t.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const t=Gn.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const t=this.resource,e=this.options;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(e.preload||t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlayThrough),t.addEventListener("error",this._onError,!0)),this.alphaMode=await Kh(),this._load=new Promise((r,i)=>{this.isValid?r(this):(this._resolve=r,this._reject=i,e.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${e.preloadTimeoutMs}ms`))})),t.load())}),this._load}_onError(t){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.resource;return!t.paused&&!t.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const t=this.resource;this.isValid&&(this.isReady=!0,this.resize(t.videoWidth,t.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const t=this.resource;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlayThrough),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(Gn.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(Gn.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(Gn.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement}};wr.extension=F.TextureSource;wr.defaultOptions={...Pt.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};wr.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let on=wr;const Ct=(n,t,e=!1)=>(Array.isArray(n)||(n=[n]),t?n.map(r=>typeof r=="string"||e?t(r):r):n);class Op{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||j(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const r=Ct(t);let i;for(let h=0;h<this.parsers.length;h++){const c=this.parsers[h];if(c.test(e)){i=c.getCacheableAssets(r,e);break}}const s=new Map(Object.entries(i||{}));i||r.forEach(h=>{s.set(h,e)});const o=[...s.keys()],a={cacheKeys:o,keys:r};r.forEach(h=>{this._cacheMap.set(h,a)}),o.forEach(h=>{const c=i?i[h]:e;this._cache.has(h)&&this._cache.get(h)!==c&&j("[Cache] already has key:",h),this._cache.set(h,s.get(h))})}remove(t){if(!this._cacheMap.has(t)){j(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(i=>{this._cache.delete(i)}),e.keys.forEach(i=>{this._cacheMap.delete(i)})}get parsers(){return this._parsers}}const nt=new Op,zi=[];tt.handleByList(F.TextureSource,zi);function Jh(n={}){const t=n&&n.resource,e=t?n.resource:n,r=t?n:{resource:n};for(let i=0;i<zi.length;i++){const s=zi[i];if(s.test(e))return new s(r)}throw new Error(`Could not find a source type for resource: ${r.resource}`)}function zp(n={},t=!1){const e=n&&n.resource,r=e?n.resource:n,i=e?n:{resource:n};if(!t&&nt.has(r))return nt.get(r);const s=new D({source:Jh(i)});return s.on("destroy",()=>{nt.has(r)&&nt.remove(r)}),t||nt.set(r,s),s}function Np(n,t=!1){return typeof n=="string"?nt.get(n):n instanceof Pt?new D({source:n}):zp(n,t)}D.from=Np;Pt.from=Jh;tt.add(Yh,qh,jh,on,Fe,vr,ms);var Qt=(n=>(n[n.Low=0]="Low",n[n.Normal=1]="Normal",n[n.High=2]="High",n))(Qt||{});function vt(n){if(typeof n!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(n)}`)}function He(n){return n.split("?")[0].split("#")[0]}function Up(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function $p(n,t,e){return n.replace(new RegExp(Up(t),"g"),e)}function Hp(n,t){let e="",r=0,i=-1,s=0,o=-1;for(let a=0;a<=n.length;++a){if(a<n.length)o=n.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(i===a-1||s===1))if(i!==a-1&&s===2){if(e.length<2||r!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const h=e.lastIndexOf("/");if(h!==e.length-1){h===-1?(e="",r=0):(e=e.slice(0,h),r=e.length-1-e.lastIndexOf("/")),i=a,s=0;continue}}else if(e.length===2||e.length===1){e="",r=0,i=a,s=0;continue}}}else e.length>0?e+=`/${n.slice(i+1,a)}`:e=n.slice(i+1,a),r=a-i-1;i=a,s=0}else o===46&&s!==-1?++s:s=-1}return e}const pt={toPosix(n){return $p(n,"\\","/")},isUrl(n){return/^https?:/.test(this.toPosix(n))},isDataUrl(n){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(n)},isBlobUrl(n){return n.startsWith("blob:")},hasProtocol(n){return/^[^/:]+:/.test(this.toPosix(n))},getProtocol(n){vt(n),n=this.toPosix(n);const t=/^file:\/\/\//.exec(n);if(t)return t[0];const e=/^[^/:]+:\/{0,2}/.exec(n);return e?e[0]:""},toAbsolute(n,t,e){if(vt(n),this.isDataUrl(n)||this.isBlobUrl(n))return n;const r=He(this.toPosix(t??K.get().getBaseUrl())),i=He(this.toPosix(e??this.rootname(r)));return n=this.toPosix(n),n.startsWith("/")?pt.join(i,n.slice(1)):this.isAbsolute(n)?n:this.join(r,n)},normalize(n){if(vt(n),n.length===0)return".";if(this.isDataUrl(n)||this.isBlobUrl(n))return n;n=this.toPosix(n);let t="";const e=n.startsWith("/");this.hasProtocol(n)&&(t=this.rootname(n),n=n.slice(t.length));const r=n.endsWith("/");return n=Hp(n),n.length>0&&r&&(n+="/"),e?`/${n}`:t+n},isAbsolute(n){return vt(n),n=this.toPosix(n),this.hasProtocol(n)?!0:n.startsWith("/")},join(...n){if(n.length===0)return".";let t;for(let e=0;e<n.length;++e){const r=n[e];if(vt(r),r.length>0)if(t===void 0)t=r;else{const i=n[e-1]??"";this.joinExtensions.includes(this.extname(i).toLowerCase())?t+=`/../${r}`:t+=`/${r}`}}return t===void 0?".":this.normalize(t)},dirname(n){if(vt(n),n.length===0)return".";n=this.toPosix(n);let t=n.charCodeAt(0);const e=t===47;let r=-1,i=!0;const s=this.getProtocol(n),o=n;n=n.slice(s.length);for(let a=n.length-1;a>=1;--a)if(t=n.charCodeAt(a),t===47){if(!i){r=a;break}}else i=!1;return r===-1?e?"/":this.isUrl(o)?s+n:s:e&&r===1?"//":s+n.slice(0,r)},rootname(n){vt(n),n=this.toPosix(n);let t="";if(n.startsWith("/")?t="/":t=this.getProtocol(n),this.isUrl(n)){const e=n.indexOf("/",t.length);e!==-1?t=n.slice(0,e):t=n,t.endsWith("/")||(t+="/")}return t},basename(n,t){vt(n),t&&vt(t),n=He(this.toPosix(n));let e=0,r=-1,i=!0,s;if(t!==void 0&&t.length>0&&t.length<=n.length){if(t.length===n.length&&t===n)return"";let o=t.length-1,a=-1;for(s=n.length-1;s>=0;--s){const h=n.charCodeAt(s);if(h===47){if(!i){e=s+1;break}}else a===-1&&(i=!1,a=s+1),o>=0&&(h===t.charCodeAt(o)?--o===-1&&(r=s):(o=-1,r=a))}return e===r?r=a:r===-1&&(r=n.length),n.slice(e,r)}for(s=n.length-1;s>=0;--s)if(n.charCodeAt(s)===47){if(!i){e=s+1;break}}else r===-1&&(i=!1,r=s+1);return r===-1?"":n.slice(e,r)},extname(n){vt(n),n=He(this.toPosix(n));let t=-1,e=0,r=-1,i=!0,s=0;for(let o=n.length-1;o>=0;--o){const a=n.charCodeAt(o);if(a===47){if(!i){e=o+1;break}continue}r===-1&&(i=!1,r=o+1),a===46?t===-1?t=o:s!==1&&(s=1):t!==-1&&(s=-1)}return t===-1||r===-1||s===0||s===1&&t===r-1&&t===e+1?"":n.slice(t,r)},parse(n){vt(n);const t={root:"",dir:"",base:"",ext:"",name:""};if(n.length===0)return t;n=He(this.toPosix(n));let e=n.charCodeAt(0);const r=this.isAbsolute(n);let i;t.root=this.rootname(n),r||this.hasProtocol(n)?i=1:i=0;let s=-1,o=0,a=-1,h=!0,c=n.length-1,l=0;for(;c>=i;--c){if(e=n.charCodeAt(c),e===47){if(!h){o=c+1;break}continue}a===-1&&(h=!1,a=c+1),e===46?s===-1?s=c:l!==1&&(l=1):s!==-1&&(l=-1)}return s===-1||a===-1||l===0||l===1&&s===a-1&&s===o+1?a!==-1&&(o===0&&r?t.base=t.name=n.slice(1,a):t.base=t.name=n.slice(o,a)):(o===0&&r?(t.name=n.slice(1,s),t.base=n.slice(1,a)):(t.name=n.slice(o,s),t.base=n.slice(o,a)),t.ext=n.slice(s,a)),t.dir=this.dirname(n),t},sep:"/",delimiter:":",joinExtensions:[".html"]};function tc(n,t,e,r,i){const s=t[e];for(let o=0;o<s.length;o++){const a=s[o];e<t.length-1?tc(n.replace(r[e],a),t,e+1,r,i):i.push(n.replace(r[e],a))}}function Vp(n){const t=/\{(.*?)\}/g,e=n.match(t),r=[];if(e){const i=[];e.forEach(s=>{const o=s.substring(1,s.length-1).split(",");i.push(o)}),tc(n,i,0,e,r)}else r.push(n);return r}const fr=n=>!Array.isArray(n);class Le{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(r=>`${encodeURIComponent(r)}=${encodeURIComponent(e[r])}`).join("&")}}getAlias(t){const{alias:e,src:r}=t;return Ct(e||r,s=>typeof s=="string"?s:Array.isArray(s)?s.map(o=>(o==null?void 0:o.src)??o):s!=null&&s.src?s.src:s,!0)}addManifest(t){this._manifest&&j("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const r=[];let i=e;Array.isArray(e)||(i=Object.entries(e).map(([s,o])=>typeof o=="string"||Array.isArray(o)?{alias:s,src:o}:{alias:s,...o})),i.forEach(s=>{const o=s.src,a=s.alias;let h;if(typeof a=="string"){const c=this._createBundleAssetId(t,a);r.push(c),h=[a,c]}else{const c=a.map(l=>this._createBundleAssetId(t,l));r.push(...c),h=[...a,...c]}this.add({...s,alias:h,src:o})}),this._bundles[t]=r}add(t){const e=[];Array.isArray(t)?e.push(...t):e.push(t);let r;r=s=>{this.hasKey(s)&&j(`[Resolver] already has key: ${s} overwriting`)},Ct(e).forEach(s=>{const{src:o}=s;let{data:a,format:h,loadParser:c,parser:l}=s;const u=Ct(o).map(g=>typeof g=="string"?Vp(g):Array.isArray(g)?g:[g]),d=this.getAlias(s);Array.isArray(d)?d.forEach(r):r(d);const f=[],p=g=>{const m=this._parsers.find(y=>y.test(g));return{src:g,...m==null?void 0:m.parse(g)}};u.forEach(g=>{g.forEach(m=>{let y={};if(typeof m!="object"?y=p(m):(a=m.data??a,h=m.format??h,(m.loadParser||m.parser)&&(c=m.loadParser??c,l=m.parser??l),y={...p(m.src),...m}),!d)throw new Error(`[Resolver] alias is undefined for this asset: ${y.src}`);y=this._buildResolvedAsset(y,{aliases:d,data:a,format:h,loadParser:c,parser:l,progressSize:s.progressSize}),f.push(y)})}),d.forEach(g=>{this._assetMap[g]=f})})}resolveBundle(t){const e=fr(t);t=Ct(t);const r={};return t.forEach(i=>{const s=this._bundles[i];if(s){const o=this.resolve(s),a={};for(const h in o){const c=o[h];a[this._extractAssetIdFromBundle(i,h)]=c}r[i]=a}}),e?r[t[0]]:r}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const r={};for(const i in e)r[i]=e[i].src;return r}return e.src}resolve(t){const e=fr(t);t=Ct(t);const r={};return t.forEach(i=>{if(!this._resolverHash[i])if(this._assetMap[i]){let s=this._assetMap[i];const o=this._getPreferredOrder(s);o==null||o.priority.forEach(a=>{o.params[a].forEach(h=>{const c=s.filter(l=>l[a]?l[a]===h:!1);c.length&&(s=c)})}),this._resolverHash[i]=s[0]}else this._resolverHash[i]=this._buildResolvedAsset({alias:[i],src:i},{});r[i]=this._resolverHash[i]}),e?r[t[0]]:r}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const r=t[e],i=this._preferredOrder.find(s=>s.params.format.includes(r.format));if(i)return i}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}_buildResolvedAsset(t,e){const{aliases:r,data:i,loadParser:s,parser:o,format:a,progressSize:h}=e;return(this._basePath||this._rootPath)&&(t.src=pt.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=r??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...i||{},...t.data},t.loadParser=s??t.loadParser,t.parser=o??t.parser,t.format=a??t.format??Wp(t.src),h!==void 0&&(t.progressSize=h),t}}Le.RETINA_PREFIX=/@([0-9\.]+)x/;function Wp(n){return n.split(".").pop().split("?").shift().split("#").shift()}const Ni=(n,t)=>{const e=t.split("?")[1];return e&&(n+=`?${e}`),n},ec=class tn{constructor(t,e){this.linkedSheets=[];let r=t;(t==null?void 0:t.source)instanceof Pt&&(r={texture:t,data:e});const{texture:i,data:s,cachePrefix:o=""}=r;this.cachePrefix=o,this._texture=i instanceof D?i:null,this.textureSource=i.source,this.textures={},this.animations={},this.data=s;const a=parseFloat(s.meta.scale);a?(this.resolution=a,i.source.resolution=this.resolution):this.resolution=i.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=tn.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}parseSync(){return this._processFrames(0,!0),this._processAnimations(),this.textures}_processFrames(t,e=!1){let r=t;const i=e?1/0:tn.BATCH_SIZE;for(;r-t<i&&r<this._frameKeys.length;){const s=this._frameKeys[r],o=this._frames[s],a=o.frame;if(a){let h=null,c=null;const l=o.trimmed!==!1&&o.sourceSize?o.sourceSize:o.frame,u=new Y(0,0,Math.floor(l.w)/this.resolution,Math.floor(l.h)/this.resolution);o.rotated?h=new Y(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.h)/this.resolution,Math.floor(a.w)/this.resolution):h=new Y(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution),o.trimmed!==!1&&o.spriteSourceSize&&(c=new Y(Math.floor(o.spriteSourceSize.x)/this.resolution,Math.floor(o.spriteSourceSize.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution)),this.textures[s]=new D({source:this.textureSource,frame:h,orig:u,trim:c,rotate:o.rotated?2:0,defaultAnchor:o.anchor,defaultBorders:o.borders,label:s.toString()})}r++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let r=0;r<t[e].length;r++){const i=t[e][r];this.animations[e].push(this.textures[i])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*tn.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*tn.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){var e;for(const r in this.textures)this.textures[r].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&((e=this._texture)==null||e.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};ec.BATCH_SIZE=1e3;let Vo=ec;const Xp=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function nc(n,t,e){const r={};if(n.forEach(i=>{r[i]=t}),Object.keys(t.textures).forEach(i=>{r[`${t.cachePrefix}${i}`]=t.textures[i]}),!e){const i=pt.dirname(n[0]);t.linkedSheets.forEach((s,o)=>{const a=nc([`${i}/${t.data.meta.related_multi_packs[o]}`],s,!0);Object.assign(r,a)})}return r}const Yp={extension:F.Asset,cache:{test:n=>n instanceof Vo,getCacheableAssets:(n,t)=>nc(n,t,!1)},resolver:{extension:{type:F.ResolveParser,name:"resolveSpritesheet"},test:n=>{const e=n.split("?")[0].split("."),r=e.pop(),i=e.pop();return r==="json"&&Xp.includes(i)},parse:n=>{var e;const t=n.split(".");return{resolution:parseFloat(((e=Le.RETINA_PREFIX.exec(n))==null?void 0:e[1])??"1"),format:t[t.length-2],src:n}}},loader:{name:"spritesheetLoader",id:"spritesheet",extension:{type:F.LoadParser,priority:Qt.Normal,name:"spritesheetLoader"},async testParse(n,t){return pt.extname(t.src).toLowerCase()===".json"&&!!n.frames},async parse(n,t,e){var u,d;const{texture:r,imageFilename:i,textureOptions:s,cachePrefix:o}=(t==null?void 0:t.data)??{};let a=pt.dirname(t.src);a&&a.lastIndexOf("/")!==a.length-1&&(a+="/");let h;if(r instanceof D)h=r;else{const f=Ni(a+(i??n.meta.image),t.src);h=(await e.load([{src:f,data:s}]))[f]}const c=new Vo({texture:h.source,data:n,cachePrefix:o});await c.parse();const l=(u=n==null?void 0:n.meta)==null?void 0:u.related_multi_packs;if(Array.isArray(l)){const f=[];for(const g of l){if(typeof g!="string")continue;let m=a+g;(d=t.data)!=null&&d.ignoreMultiPack||(m=Ni(m,t.src),f.push(e.load({src:m,data:{textureOptions:s,ignoreMultiPack:!0}})))}const p=await Promise.all(f);c.linkedSheets=p,p.forEach(g=>{g.linkedSheets=[c].concat(c.linkedSheets.filter(m=>m!==g))})}return c},async unload(n,t,e){await e.unload(n.textureSource._sourceOrigin),n.destroy(!1)}}};tt.add(Yp);const Kr=Object.create(null),Wo=Object.create(null);function bs(n,t){let e=Wo[n];return e===void 0&&(Kr[t]===void 0&&(Kr[t]=1),Wo[n]=e=Kr[t]++),e}let ye;function rc(){return(!ye||ye!=null&&ye.isContextLost())&&(ye=K.get().createCanvas().getContext("webgl",{})),ye}let On;function qp(){if(!On){On="mediump";const n=rc();n&&n.getShaderPrecisionFormat&&(On=n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision?"highp":"mediump")}return On}function jp(n,t,e){return t?n:e?(n=n.replace("out vec4 finalColor;",""),`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${n}
        `):`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${n}
        `}function Zp(n,t,e){const r=e?t.maxSupportedFragmentPrecision:t.maxSupportedVertexPrecision;if(n.substring(0,9)!=="precision"){let i=e?t.requestedFragmentPrecision:t.requestedVertexPrecision;return i==="highp"&&r!=="highp"&&(i="mediump"),`precision ${i} float;
${n}`}else if(r!=="highp"&&n.substring(0,15)==="precision highp")return n.replace("precision highp","precision mediump");return n}function Kp(n,t){return t?`#version 300 es
${n}`:n}const Qp={},Jp={};function tg(n,{name:t="pixi-program"},e=!0){t=t.replace(/\s+/g,"-"),t+=e?"-fragment":"-vertex";const r=e?Qp:Jp;return r[t]?(r[t]++,t+=`-${r[t]}`):r[t]=1,n.indexOf("#define SHADER_NAME")!==-1?n:`${`#define SHADER_NAME ${t}`}
${n}`}function eg(n,t){return t?n.replace("#version 300 es",""):n}const Qr={stripVersion:eg,ensurePrecision:Zp,addProgramDefines:jp,setProgramName:tg,insertVersion:Kp},Ve=Object.create(null),ic=class Ui{constructor(t){t={...Ui.defaultOptions,...t};const e=t.fragment.indexOf("#version 300 es")!==-1,r={stripVersion:e,ensurePrecision:{requestedFragmentPrecision:t.preferredFragmentPrecision,requestedVertexPrecision:t.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:qp()},setProgramName:{name:t.name},addProgramDefines:e,insertVersion:e};let i=t.fragment,s=t.vertex;Object.keys(Qr).forEach(o=>{const a=r[o];i=Qr[o](i,a,!0),s=Qr[o](s,a,!1)}),this.fragment=i,this.vertex=s,this.transformFeedbackVaryings=t.transformFeedbackVaryings,this._key=bs(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null,Ve[this._cacheKey]=null}static from(t){const e=`${t.vertex}:${t.fragment}`;return Ve[e]||(Ve[e]=new Ui(t),Ve[e]._cacheKey=e),Ve[e]}};ic.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let sc=ic;const Xo={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function ng(n){return Xo[n]??Xo.float32}const rg={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",vec2i:"sint32x2",vec3i:"sint32x3",vec4i:"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",vec2u:"uint32x2",vec3u:"uint32x3",vec4u:"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"},Yo=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|\)|$)/g;function qo(n,t){let e;for(;(e=Yo.exec(n))!==null;){const r=rg[e[3]]??"float32";t[e[2]]={location:parseInt(e[1],10),format:r,stride:ng(r).stride,offset:0,instance:!1,start:0}}Yo.lastIndex=0}function ig(n){return n.replace(/\/\/.*$/gm,"").replace(/\/\*[\s\S]*?\*\//g,"")}function sg({source:n,entryPoint:t}){const e={},r=ig(n),i=r.indexOf(`fn ${t}(`);if(i===-1)return e;const s=r.indexOf("->",i);if(s===-1)return e;const o=r.substring(i,s);if(qo(o,e),Object.keys(e).length===0){const a=o.match(/\(\s*\w+\s*:\s*(\w+)/);if(a){const h=a[1],c=new RegExp(`struct\\s+${h}\\s*\\{([^}]+)\\}`,"s"),l=r.match(c);l&&qo(l[1],e)}}return e}function Jr(n){var u,d;const t=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,e=/@group\((\d+)\)/,r=/@binding\((\d+)\)/,i=/var(<[^>]+>)? (\w+)/,s=/:\s*([\w<>]+)/,o=/struct\s+(\w+)\s*{([^}]+)}/g,a=/(\w+)\s*:\s*([\w\<\>]+)/g,h=/struct\s+(\w+)/,c=(u=n.match(t))==null?void 0:u.map(f=>({group:parseInt(f.match(e)[1],10),binding:parseInt(f.match(r)[1],10),name:f.match(i)[2],isUniform:f.match(i)[1]==="<uniform>",type:f.match(s)[1]}));if(!c)return{groups:[],structs:[]};const l=((d=n.match(o))==null?void 0:d.map(f=>{const p=f.match(h)[1],g=f.match(a).reduce((m,y)=>{const[x,_]=y.split(":");return m[x.trim()]=_.trim(),m},{});return g?{name:p,members:g}:null}).filter(({name:f})=>c.some(p=>p.type===f||p.type.includes(`<${f}>`))))??[];return{groups:c,structs:l}}var ue=(n=>(n[n.VERTEX=1]="VERTEX",n[n.FRAGMENT=2]="FRAGMENT",n[n.COMPUTE=4]="COMPUTE",n))(ue||{});function og({groups:n}){const t=[];for(let e=0;e<n.length;e++){const r=n[e];t[r.group]||(t[r.group]=[]),r.isUniform?t[r.group].push({binding:r.binding,visibility:ue.VERTEX|ue.FRAGMENT,buffer:{type:"uniform"}}):r.type==="sampler"?t[r.group].push({binding:r.binding,visibility:ue.FRAGMENT,sampler:{type:"filtering"}}):r.type==="texture_2d"||r.type.startsWith("texture_2d<")?t[r.group].push({binding:r.binding,visibility:ue.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}}):r.type==="texture_2d_array"||r.type.startsWith("texture_2d_array<")?t[r.group].push({binding:r.binding,visibility:ue.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d-array",multisampled:!1}}):(r.type==="texture_cube"||r.type.startsWith("texture_cube<"))&&t[r.group].push({binding:r.binding,visibility:ue.FRAGMENT,texture:{sampleType:"float",viewDimension:"cube",multisampled:!1}})}for(let e=0;e<t.length;e++)t[e]||(t[e]=[]);return t}function ag({groups:n}){const t=[];for(let e=0;e<n.length;e++){const r=n[e];t[r.group]||(t[r.group]={}),t[r.group][r.name]=r.binding}return t}function hg(n,t){const e=new Set,r=new Set,i=[...n.structs,...t.structs].filter(o=>e.has(o.name)?!1:(e.add(o.name),!0)),s=[...n.groups,...t.groups].filter(o=>{const a=`${o.name}-${o.binding}`;return r.has(a)?!1:(r.add(a),!0)});return{structs:i,groups:s}}const We=Object.create(null);class Ar{constructor(t){var a,h;this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:e,vertex:r,layout:i,gpuLayout:s,name:o}=t;if(this.name=o,this.fragment=e,this.vertex=r,e.source===r.source){const c=Jr(e.source);this.structsAndGroups=c}else{const c=Jr(r.source),l=Jr(e.source);this.structsAndGroups=hg(c,l)}this.layout=i??ag(this.structsAndGroups),this.gpuLayout=s??og(this.structsAndGroups),this.autoAssignGlobalUniforms=((a=this.layout[0])==null?void 0:a.globalUniforms)!==void 0,this.autoAssignLocalUniforms=((h=this.layout[1])==null?void 0:h.localUniforms)!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:t,fragment:e}=this,r=t.source+e.source+t.entryPoint+e.entryPoint;this._layoutKey=bs(r,"program")}get attributeData(){return this._attributeData??(this._attributeData=sg(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null,We[this._cacheKey]=null}static from(t){const e=`${t.vertex.source}:${t.fragment.source}:${t.fragment.entryPoint}:${t.vertex.entryPoint}`;return We[e]||(We[e]=new Ar(t),We[e]._cacheKey=e),We[e]}}const oc=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],cg=oc.reduce((n,t)=>(n[t]=!0,n),{});function lg(n,t){switch(n){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*t);case"vec3<f32>":return new Float32Array(3*t);case"vec4<f32>":return new Float32Array(4*t);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const ac=class hc{constructor(t,e){this._touched=0,this.uid=Z("uniform"),this._resourceType="uniformGroup",this._resourceId=Z("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,e={...hc.defaultOptions,...e},this.uniformStructures=t;const r={};for(const i in t){const s=t[i];if(s.name=i,s.size=s.size??1,!cg[s.type]){const o=s.type.match(/^array<(\w+(?:<\w+>)?),\s*(\d+)>$/);if(o){const[,a,h]=o;throw new Error(`Uniform type ${s.type} is not supported. Use type: '${a}', size: ${h} instead.`)}throw new Error(`Uniform type ${s.type} is not supported. Supported uniform types are: ${oc.join(", ")}`)}s.value??(s.value=lg(s.type,s.size)),r[i]=s.value}this.uniforms=r,this._dirtyId=1,this.ubo=e.ubo,this.isStatic=e.isStatic,this._signature=bs(Object.keys(r).map(i=>`${i}-${t[i].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};ac.defaultOptions={ubo:!1,isStatic:!1};let vs=ac;class an{constructor(t){this.resources=Object.create(null),this._dirty=!0;let e=0;for(const r in t){const i=t[r];this.setResource(i,e++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const t=[];let e=0;for(const r in this.resources)t[e++]=this.resources[r]._resourceId;this._key=t.join("|")}setResource(t,e){var i,s;const r=this.resources[e];t!==r&&(r&&((i=t.off)==null||i.call(t,"change",this.onResourceChange,this)),(s=t.on)==null||s.call(t,"change",this.onResourceChange,this),this.resources[e]=t,this._dirty=!0)}getResource(t){return this.resources[t]}_touch(t,e){const r=this.resources;for(const i in r)r[i]._gcLastUsed=t,r[i]._touched=e}destroy(){var e;const t=this.resources;for(const r in t){const i=t[r];(e=i==null?void 0:i.off)==null||e.call(i,"change",this.onResourceChange,this)}this.resources=null}onResourceChange(t){if(this._dirty=!0,t.destroyed){const e=this.resources;for(const r in e)e[r]===t&&(e[r]=null)}else this._updateKey()}}var $i=(n=>(n[n.WEBGL=1]="WEBGL",n[n.WEBGPU=2]="WEBGPU",n[n.CANVAS=4]="CANVAS",n[n.BOTH=3]="BOTH",n))($i||{});class ws extends Ut{constructor(t){super(),this.uid=Z("shader"),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[],this._destroyed=!1;let{gpuProgram:e,glProgram:r,groups:i,resources:s,compatibleRenderers:o,groupMap:a}=t;this.gpuProgram=e,this.glProgram=r,o===void 0&&(o=0,e&&(o|=$i.WEBGPU),r&&(o|=$i.WEBGL)),this.compatibleRenderers=o;const h={};if(!s&&!i&&(s={}),s&&i)throw new Error("[Shader] Cannot have both resources and groups");if(!e&&i&&!a)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!e&&i&&a)for(const c in a)for(const l in a[c]){const u=a[c][l];h[u]={group:c,binding:l,name:u}}else if(e&&i&&!a){const c=e.structsAndGroups.groups;a={},c.forEach(l=>{a[l.group]=a[l.group]||{},a[l.group][l.binding]=l.name,h[l.name]=l})}else if(s){i={},a={},e&&e.structsAndGroups.groups.forEach(u=>{a[u.group]=a[u.group]||{},a[u.group][u.binding]=u.name,h[u.name]=u});let c=0;for(const l in s)h[l]||(i[99]||(i[99]=new an,this._ownedBindGroups.push(i[99])),h[l]={group:99,binding:c,name:l},a[99]=a[99]||{},a[99][c]=l,c++);for(const l in s){const u=l;let d=s[l];!d.source&&!d._resourceType&&(d=new vs(d));const f=h[u];f&&(i[f.group]||(i[f.group]=new an,this._ownedBindGroups.push(i[f.group])),i[f.group].setResource(d,f.binding))}}this.groups=i,this._uniformBindMap=a,this.resources=this._buildResourceAccessor(i,h)}addResource(t,e,r){var i,s;(i=this._uniformBindMap)[e]||(i[e]={}),(s=this._uniformBindMap[e])[r]||(s[r]=t),this.groups[e]||(this.groups[e]=new an,this._ownedBindGroups.push(this.groups[e]))}_buildResourceAccessor(t,e){const r={};for(const i in e){const s=e[i];Object.defineProperty(r,s.name,{get(){return t[s.group].getResource(s.binding)},set(o){t[s.group].setResource(o,s.binding)}})}return r}destroy(t=!1){var e,r;this._destroyed||(this._destroyed=!0,this.emit("destroy",this),t&&((e=this.gpuProgram)==null||e.destroy(),(r=this.glProgram)==null||r.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(i=>{i.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null)}static from(t){const{gpu:e,gl:r,...i}=t;let s,o;return e&&(s=Ar.from(e)),r&&(o=sc.from(r)),new ws({gpuProgram:s,glProgram:o,...i})}}const ug={normal:0,add:1,multiply:2,screen:3,overlay:4,erase:5,"normal-npm":6,"add-npm":7,"screen-npm":8,min:9,max:10},ti=0,ei=1,ni=2,ri=3,ii=4,si=5,Hi=class cc{constructor(){this.data=0,this.blendMode="normal",this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<ti)}set blend(t){!!(this.data&1<<ti)!==t&&(this.data^=1<<ti)}get offsets(){return!!(this.data&1<<ei)}set offsets(t){!!(this.data&1<<ei)!==t&&(this.data^=1<<ei)}set cullMode(t){if(t==="none"){this.culling=!1;return}this.culling=!0,this.clockwiseFrontFace=t==="front"}get cullMode(){return this.culling?this.clockwiseFrontFace?"front":"back":"none"}get culling(){return!!(this.data&1<<ni)}set culling(t){!!(this.data&1<<ni)!==t&&(this.data^=1<<ni)}get depthTest(){return!!(this.data&1<<ri)}set depthTest(t){!!(this.data&1<<ri)!==t&&(this.data^=1<<ri)}get depthMask(){return!!(this.data&1<<si)}set depthMask(t){!!(this.data&1<<si)!==t&&(this.data^=1<<si)}get clockwiseFrontFace(){return!!(this.data&1<<ii)}set clockwiseFrontFace(t){!!(this.data&1<<ii)!==t&&(this.data^=1<<ii)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!=="none",this._blendMode=t,this._blendModeId=ug[t]||0}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[pixi.js/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new cc;return t.depthTest=!1,t.blend=!0,t}};Hi.default2d=Hi.for2d();let As=Hi;const Vi=[];tt.handleByNamedList(F.Environment,Vi);async function dg(n){if(!n)for(let t=0;t<Vi.length;t++){const e=Vi[t];if(e.value.test()){await e.value.load();return}}}let Xe;function fg(){if(typeof Xe=="boolean")return Xe;try{Xe=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{Xe=!1}return Xe}function jo(n,t,e=2){const r=t&&t.length,i=r?t[0]*e:n.length;let s=lc(n,0,i,e,!0);const o=[];if(!s||s.next===s.prev)return o;let a,h,c;if(r&&(s=xg(n,t,s,e)),n.length>80*e){a=n[0],h=n[1];let l=a,u=h;for(let d=e;d<i;d+=e){const f=n[d],p=n[d+1];f<a&&(a=f),p<h&&(h=p),f>l&&(l=f),p>u&&(u=p)}c=Math.max(l-a,u-h),c=c!==0?32767/c:0}return mn(s,o,e,a,h,c,0),o}function lc(n,t,e,r,i){let s;if(i===kg(n,t,e,r)>0)for(let o=t;o<e;o+=r)s=Zo(o/r|0,n[o],n[o+1],s);else for(let o=e-r;o>=t;o-=r)s=Zo(o/r|0,n[o],n[o+1],s);return s&&Be(s,s.next)&&(xn(s),s=s.next),s}function me(n,t){if(!n)return n;t||(t=n);let e=n,r;do if(r=!1,!e.steiner&&(Be(e,e.next)||X(e.prev,e,e.next)===0)){if(xn(e),e=t=e.prev,e===e.next)break;r=!0}else e=e.next;while(r||e!==t);return t}function mn(n,t,e,r,i,s,o){if(!n)return;!o&&s&&Ag(n,r,i,s);let a=n;for(;n.prev!==n.next;){const h=n.prev,c=n.next;if(s?gg(n,r,i,s):pg(n)){t.push(h.i,n.i,c.i),xn(n),n=c.next,a=c.next;continue}if(n=c,n===a){o?o===1?(n=mg(me(n),t),mn(n,t,e,r,i,s,2)):o===2&&yg(n,t,e,r,i,s):mn(me(n),t,e,r,i,s,1);break}}}function pg(n){const t=n.prev,e=n,r=n.next;if(X(t,e,r)>=0)return!1;const i=t.x,s=e.x,o=r.x,a=t.y,h=e.y,c=r.y,l=Math.min(i,s,o),u=Math.min(a,h,c),d=Math.max(i,s,o),f=Math.max(a,h,c);let p=r.next;for(;p!==t;){if(p.x>=l&&p.x<=d&&p.y>=u&&p.y<=f&&en(i,a,s,h,o,c,p.x,p.y)&&X(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function gg(n,t,e,r){const i=n.prev,s=n,o=n.next;if(X(i,s,o)>=0)return!1;const a=i.x,h=s.x,c=o.x,l=i.y,u=s.y,d=o.y,f=Math.min(a,h,c),p=Math.min(l,u,d),g=Math.max(a,h,c),m=Math.max(l,u,d),y=Wi(f,p,t,e,r),x=Wi(g,m,t,e,r);let _=n.prevZ,b=n.nextZ;for(;_&&_.z>=y&&b&&b.z<=x;){if(_.x>=f&&_.x<=g&&_.y>=p&&_.y<=m&&_!==i&&_!==o&&en(a,l,h,u,c,d,_.x,_.y)&&X(_.prev,_,_.next)>=0||(_=_.prevZ,b.x>=f&&b.x<=g&&b.y>=p&&b.y<=m&&b!==i&&b!==o&&en(a,l,h,u,c,d,b.x,b.y)&&X(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;_&&_.z>=y;){if(_.x>=f&&_.x<=g&&_.y>=p&&_.y<=m&&_!==i&&_!==o&&en(a,l,h,u,c,d,_.x,_.y)&&X(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;b&&b.z<=x;){if(b.x>=f&&b.x<=g&&b.y>=p&&b.y<=m&&b!==i&&b!==o&&en(a,l,h,u,c,d,b.x,b.y)&&X(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function mg(n,t){let e=n;do{const r=e.prev,i=e.next.next;!Be(r,i)&&dc(r,e,e.next,i)&&yn(r,i)&&yn(i,r)&&(t.push(r.i,e.i,i.i),xn(e),xn(e.next),e=n=i),e=e.next}while(e!==n);return me(e)}function yg(n,t,e,r,i,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&Sg(o,a)){let h=fc(o,a);o=me(o,o.next),h=me(h,h.next),mn(o,t,e,r,i,s,0),mn(h,t,e,r,i,s,0);return}a=a.next}o=o.next}while(o!==n)}function xg(n,t,e,r){const i=[];for(let s=0,o=t.length;s<o;s++){const a=t[s]*r,h=s<o-1?t[s+1]*r:n.length,c=lc(n,a,h,r,!1);c===c.next&&(c.steiner=!0),i.push(Mg(c))}i.sort(_g);for(let s=0;s<i.length;s++)e=bg(i[s],e);return e}function _g(n,t){let e=n.x-t.x;if(e===0&&(e=n.y-t.y,e===0)){const r=(n.next.y-n.y)/(n.next.x-n.x),i=(t.next.y-t.y)/(t.next.x-t.x);e=r-i}return e}function bg(n,t){const e=vg(n,t);if(!e)return t;const r=fc(e,n);return me(r,r.next),me(e,e.next)}function vg(n,t){let e=t;const r=n.x,i=n.y;let s=-1/0,o;if(Be(n,e))return e;do{if(Be(n,e.next))return e.next;if(i<=e.y&&i>=e.next.y&&e.next.y!==e.y){const u=e.x+(i-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(u<=r&&u>s&&(s=u,o=e.x<e.next.x?e:e.next,u===r))return o}e=e.next}while(e!==t);if(!o)return null;const a=o,h=o.x,c=o.y;let l=1/0;e=o;do{if(r>=e.x&&e.x>=h&&r!==e.x&&uc(i<c?r:s,i,h,c,i<c?s:r,i,e.x,e.y)){const u=Math.abs(i-e.y)/(r-e.x);yn(e,n)&&(u<l||u===l&&(e.x>o.x||e.x===o.x&&wg(o,e)))&&(o=e,l=u)}e=e.next}while(e!==a);return o}function wg(n,t){return X(n.prev,n,t.prev)<0&&X(t.next,n,n.next)<0}function Ag(n,t,e,r){let i=n;do i.z===0&&(i.z=Wi(i.x,i.y,t,e,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==n);i.prevZ.nextZ=null,i.prevZ=null,Cg(i)}function Cg(n){let t,e=1;do{let r=n,i;n=null;let s=null;for(t=0;r;){t++;let o=r,a=0;for(let c=0;c<e&&(a++,o=o.nextZ,!!o);c++);let h=e;for(;a>0||h>0&&o;)a!==0&&(h===0||!o||r.z<=o.z)?(i=r,r=r.nextZ,a--):(i=o,o=o.nextZ,h--),s?s.nextZ=i:n=i,i.prevZ=s,s=i;r=o}s.nextZ=null,e*=2}while(t>1);return n}function Wi(n,t,e,r,i){return n=(n-e)*i|0,t=(t-r)*i|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,n|t<<1}function Mg(n){let t=n,e=n;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==n);return e}function uc(n,t,e,r,i,s,o,a){return(i-o)*(t-a)>=(n-o)*(s-a)&&(n-o)*(r-a)>=(e-o)*(t-a)&&(e-o)*(s-a)>=(i-o)*(r-a)}function en(n,t,e,r,i,s,o,a){return!(n===o&&t===a)&&uc(n,t,e,r,i,s,o,a)}function Sg(n,t){return n.next.i!==t.i&&n.prev.i!==t.i&&!Pg(n,t)&&(yn(n,t)&&yn(t,n)&&Tg(n,t)&&(X(n.prev,n,t.prev)||X(n,t.prev,t))||Be(n,t)&&X(n.prev,n,n.next)>0&&X(t.prev,t,t.next)>0)}function X(n,t,e){return(t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y)}function Be(n,t){return n.x===t.x&&n.y===t.y}function dc(n,t,e,r){const i=Nn(X(n,t,e)),s=Nn(X(n,t,r)),o=Nn(X(e,r,n)),a=Nn(X(e,r,t));return!!(i!==s&&o!==a||i===0&&zn(n,e,t)||s===0&&zn(n,r,t)||o===0&&zn(e,n,r)||a===0&&zn(e,t,r))}function zn(n,t,e){return t.x<=Math.max(n.x,e.x)&&t.x>=Math.min(n.x,e.x)&&t.y<=Math.max(n.y,e.y)&&t.y>=Math.min(n.y,e.y)}function Nn(n){return n>0?1:n<0?-1:0}function Pg(n,t){let e=n;do{if(e.i!==n.i&&e.next.i!==n.i&&e.i!==t.i&&e.next.i!==t.i&&dc(e,e.next,n,t))return!0;e=e.next}while(e!==n);return!1}function yn(n,t){return X(n.prev,n,n.next)<0?X(n,t,n.next)>=0&&X(n,n.prev,t)>=0:X(n,t,n.prev)<0||X(n,n.next,t)<0}function Tg(n,t){let e=n,r=!1;const i=(n.x+t.x)/2,s=(n.y+t.y)/2;do e.y>s!=e.next.y>s&&e.next.y!==e.y&&i<(e.next.x-e.x)*(s-e.y)/(e.next.y-e.y)+e.x&&(r=!r),e=e.next;while(e!==n);return r}function fc(n,t){const e=Xi(n.i,n.x,n.y),r=Xi(t.i,t.x,t.y),i=n.next,s=t.prev;return n.next=t,t.prev=n,e.next=i,i.prev=e,r.next=e,e.prev=r,s.next=r,r.prev=s,r}function Zo(n,t,e,r){const i=Xi(n,t,e);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function xn(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function Xi(n,t,e){return{i:n,x:t,y:e,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function kg(n,t,e,r){let i=0;for(let s=t,o=e-r;s<e;s+=r)i+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return i}const Eg=jo.default||jo;var pc=(n=>(n[n.NONE=0]="NONE",n[n.COLOR=16384]="COLOR",n[n.STENCIL=1024]="STENCIL",n[n.DEPTH=256]="DEPTH",n[n.COLOR_DEPTH=16640]="COLOR_DEPTH",n[n.COLOR_STENCIL=17408]="COLOR_STENCIL",n[n.DEPTH_STENCIL=1280]="DEPTH_STENCIL",n[n.ALL=17664]="ALL",n))(pc||{});class Ig{constructor(t){this.items=[],this._name=t}emit(t,e,r,i,s,o,a,h){const{name:c,items:l}=this;for(let u=0,d=l.length;u<d;u++)l[u][c](t,e,r,i,s,o,a,h);return this}add(t){return t[this._name]&&(this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&this.items.splice(e,1),this}contains(t){return this.items.indexOf(t)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const Rg=["init","destroy","contextChange","resolutionChange","resetState","renderEnd","renderStart","render","update","postrender","prerender"],gc=class mc extends Ut{constructor(t){super(),this.tick=0,this.uid=Z("renderer"),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=t.type,this.name=t.name,this.config=t;const e=[...Rg,...this.config.runners??[]];this._addRunners(...e),this._unsafeEvalCheck()}async init(t={}){const e=t.skipExtensionImports===!0?!0:t.manageImports===!1;await dg(e),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const r in this._systemsHash)t={...this._systemsHash[r].constructor.defaultOptions,...t};t={...mc.defaultOptions,...t},this._roundPixels=t.roundPixels?1:0;for(let r=0;r<this.runners.init.items.length;r++)await this.runners.init.items[r].init(t);this._initOptions=t}render(t,e){this.tick++;let r=t;if(r instanceof Kt&&(r={container:r},e&&(U(W,"passing a second argument is deprecated, please use render options instead"),r.target=e.renderTexture)),r.target||(r.target=this.view.renderTarget),r.target===this.view.renderTarget&&(this._lastObjectRendered=r.container,r.clearColor??(r.clearColor=this.background.colorRgba),r.clear??(r.clear=this.background.clearBeforeRender)),r.clearColor){const i=Array.isArray(r.clearColor)&&r.clearColor.length===4;r.clearColor=i?r.clearColor:_t.shared.setValue(r.clearColor).toArray()}r.transform||(r.container.updateLocalTransform(),r.transform=r.container.localTransform),r.container.visible&&(r.container.enableRenderGroup(),this.runners.prerender.emit(r),this.runners.renderStart.emit(r),this.runners.render.emit(r),this.runners.renderEnd.emit(r),this.runners.postrender.emit(r))}resize(t,e,r){const i=this.view.resolution;this.view.resize(t,e,r),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),r!==void 0&&r!==i&&this.runners.resolutionChange.emit(r)}clear(t={}){const e=this;t.target||(t.target=e.renderTarget.renderTarget),t.clearColor||(t.clearColor=this.background.colorRgba),t.clear??(t.clear=pc.ALL);const{clear:r,clearColor:i,target:s,mipLevel:o,layer:a}=t;_t.shared.setValue(i??this.background.colorRgba),e.renderTarget.clear(s,r,_t.shared.toArray(),o??0,a??0)}get resolution(){return this.view.resolution}set resolution(t){this.view.resolution=t,this.runners.resolutionChange.emit(t)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...t){t.forEach(e=>{this.runners[e]=new Ig(e)})}_addSystems(t){let e;for(e in t){const r=t[e];this._addSystem(r.value,r.name)}}_addSystem(t,e){const r=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=r,this._systemsHash[e]=r;for(const i in this.runners)this.runners[i].add(r);return this}_addPipes(t,e){const r=e.reduce((i,s)=>(i[s.name]=s.value,i),{});t.forEach(i=>{const s=i.value,o=i.name,a=r[o];this.renderPipes[o]=new s(this,a?new a:null),this.runners.destroy.add(this.renderPipes[o])})}destroy(t=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(t),(t===!0||typeof t=="object"&&t.releaseGlobalResources)&&br.release(),Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(t){return this.textureGenerator.generateTexture(t)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!fg())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}resetState(){this.runners.resetState.emit()}};gc.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let yc=gc,Un;function Fg(n){return Un!==void 0||(Un=(()=>{var e;const t={stencil:!0,failIfMajorPerformanceCaveat:n??yc.defaultOptions.failIfMajorPerformanceCaveat};try{if(!K.get().getWebGLRenderingContext())return!1;let i=K.get().createCanvas().getContext("webgl",t);const s=!!((e=i==null?void 0:i.getContextAttributes())!=null&&e.stencil);if(i){const o=i.getExtension("WEBGL_lose_context");o&&o.loseContext()}return i=null,s}catch{return!1}})()),Un}let $n;async function Bg(n={}){return $n!==void 0||($n=await(async()=>{const t=K.get().getNavigator().gpu;if(!t)return!1;try{return await(await t.requestAdapter(n)).requestDevice(),!0}catch{return!1}})()),$n}const Ko=["webgl","webgpu","canvas"];async function Lg(n){let t=[];n.preference?(t.push(n.preference),Ko.forEach(s=>{s!==n.preference&&t.push(s)})):t=Ko.slice();let e,r={};for(let s=0;s<t.length;s++){const o=t[s];if(o==="webgpu"&&await Bg()){const{WebGPURenderer:a}=await Ce(async()=>{const{WebGPURenderer:h}=await import("./WebGPURenderer-csR-RqTU.js");return{WebGPURenderer:h}},__vite__mapDeps([5,6,7,2,8,3,4]),import.meta.url);e=a,r={...n,...n.webgpu};break}else if(o==="webgl"&&Fg(n.failIfMajorPerformanceCaveat??yc.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:a}=await Ce(async()=>{const{WebGLRenderer:h}=await import("./WebGLRenderer-BxNg1U4q.js");return{WebGLRenderer:h}},__vite__mapDeps([9,6,7,2,3,4]),import.meta.url);e=a,r={...n,...n.webgl};break}else if(o==="canvas"){const{CanvasRenderer:a}=await Ce(async()=>{const{CanvasRenderer:h}=await import("./CanvasRenderer-Cjc8IK-Z.js");return{CanvasRenderer:h}},__vite__mapDeps([10,7,2,3,4]),import.meta.url);e=a,r={...n,...n.canvasOptions};break}}if(delete r.webgpu,delete r.webgl,delete r.canvasOptions,!e)throw new Error("No available renderer for the current environment");const i=new e;return await i.init(r),i}const oi={test(n){return typeof n=="string"&&n.startsWith("info face=")},parse(n){const t=n.match(/^[a-z]+\s+.+$/gm),e={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const u in t){const d=t[u].match(/^[a-z]+/gm)[0],f=t[u].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),p={};for(const g in f){const m=f[g].split("="),y=m[0],x=m[1].replace(/"/gm,""),_=parseFloat(x),b=isNaN(_)?x:_;p[y]=b}e[d].push(p)}const r={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[i]=e.info,[s]=e.common,[o]=e.distanceField??[];o&&(r.distanceField={range:parseInt(o.distanceRange,10),type:o.fieldType}),r.fontSize=parseInt(i.size,10),r.fontFamily=i.face,r.lineHeight=parseInt(s.lineHeight,10);const a=e.page;for(let u=0;u<a.length;u++)r.pages.push({id:parseInt(a[u].id,10)||0,file:a[u].file});const h={};r.baseLineOffset=r.lineHeight-parseInt(s.base,10);const c=e.char;for(let u=0;u<c.length;u++){const d=c[u],f=parseInt(d.id,10);let p=d.letter??d.char??String.fromCharCode(f);p==="space"&&(p=" "),h[f]=p,r.chars[p]={id:f,page:parseInt(d.page,10)||0,x:parseInt(d.x,10),y:parseInt(d.y,10),width:parseInt(d.width,10),height:parseInt(d.height,10),xOffset:parseInt(d.xoffset,10),yOffset:parseInt(d.yoffset,10),xAdvance:parseInt(d.xadvance,10),kerning:{}}}const l=e.kerning||[];for(let u=0;u<l.length;u++){const d=parseInt(l[u].first,10),f=parseInt(l[u].second,10),p=parseInt(l[u].amount,10);r.chars[h[f]].kerning[h[d]]=p}return r}},Qo={test(n){const t=n;return typeof t!="string"&&"getElementsByTagName"in t&&t.getElementsByTagName("page").length&&t.getElementsByTagName("info")[0].getAttribute("face")!==null},parse(n){const t={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},e=n.getElementsByTagName("info")[0],r=n.getElementsByTagName("common")[0],i=n.getElementsByTagName("distanceField")[0];i&&(t.distanceField={type:i.getAttribute("fieldType"),range:parseInt(i.getAttribute("distanceRange"),10)});const s=n.getElementsByTagName("page"),o=n.getElementsByTagName("char"),a=n.getElementsByTagName("kerning");t.fontSize=parseInt(e.getAttribute("size"),10),t.fontFamily=e.getAttribute("face"),t.lineHeight=parseInt(r.getAttribute("lineHeight"),10);for(let c=0;c<s.length;c++)t.pages.push({id:parseInt(s[c].getAttribute("id"),10)||0,file:s[c].getAttribute("file")});const h={};t.baseLineOffset=t.lineHeight-parseInt(r.getAttribute("base"),10);for(let c=0;c<o.length;c++){const l=o[c],u=parseInt(l.getAttribute("id"),10);let d=l.getAttribute("letter")??l.getAttribute("char")??String.fromCharCode(u);d==="space"&&(d=" "),h[u]=d,t.chars[d]={id:u,page:parseInt(l.getAttribute("page"),10)||0,x:parseInt(l.getAttribute("x"),10),y:parseInt(l.getAttribute("y"),10),width:parseInt(l.getAttribute("width"),10),height:parseInt(l.getAttribute("height"),10),xOffset:parseInt(l.getAttribute("xoffset"),10),yOffset:parseInt(l.getAttribute("yoffset"),10),xAdvance:parseInt(l.getAttribute("xadvance"),10),kerning:{}}}for(let c=0;c<a.length;c++){const l=parseInt(a[c].getAttribute("first"),10),u=parseInt(a[c].getAttribute("second"),10),d=parseInt(a[c].getAttribute("amount"),10);t.chars[h[u]].kerning[h[l]]=d}return t}},Jo={test(n){return typeof n=="string"&&n.match(/<font(\s|>)/)?Qo.test(K.get().parseXML(n)):!1},parse(n){return Qo.parse(K.get().parseXML(n))}},Dg=[".xml",".fnt"],Gg={extension:{type:F.CacheParser,name:"cacheBitmapFont"},test:n=>!!(n!=null&&n.pages)&&!!(n!=null&&n.chars)&&typeof(n==null?void 0:n.fontFamily)=="string",getCacheableAssets(n,t){const e={};return n.forEach(r=>{e[r]=t,e[`${r}-bitmap`]=t}),e[`${t.fontFamily}-bitmap`]=t,e}},Og={extension:{type:F.LoadParser,priority:Qt.Normal},name:"loadBitmapFont",id:"bitmap-font",test(n){return Dg.includes(pt.extname(n).toLowerCase())},async testParse(n){return oi.test(n)||Jo.test(n)},async parse(n,t,e){const r=oi.test(n)?oi.parse(n):Jo.parse(n),{src:i}=t,{pages:s}=r,o=[],a=r.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let d=0;d<s.length;++d){const f=s[d].file;let p=pt.join(pt.dirname(i),f);p=Ni(p,i),o.push({src:p,data:a})}const[h,{BitmapFont:c}]=await Promise.all([e.load(o),Ce(()=>import("./BitmapFont-CgnA3fMx.js"),__vite__mapDeps([11,8,3,4]),import.meta.url)]),l=o.map(d=>h[d.src]);return new c({data:r,textures:l},i)},async load(n,t){return await(await K.get().fetch(n)).text()},async unload(n,t,e){await Promise.all(n.pages.map(r=>e.unload(r.texture.source._sourceOrigin))),n.destroy()}};class zg{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let r=0;r<e;r++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}const Ng={extension:{type:F.CacheParser,name:"cacheTextureArray"},test:n=>Array.isArray(n)&&n.every(t=>t instanceof D),getCacheableAssets:(n,t)=>{const e={};return n.forEach(r=>{t.forEach((i,s)=>{e[r+(s===0?"":s+1)]=i})}),e}};async function xc(n){if("Image"in globalThis)return new Promise(t=>{const e=new Image;e.onload=()=>{t(!0)},e.onerror=()=>{t(!1)},e.src=n});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const t=await(await fetch(n)).blob();await createImageBitmap(t)}catch{return!1}return!0}return!1}const Ug={extension:{type:F.DetectionParser,priority:1},test:async()=>xc("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async n=>[...n,"avif"],remove:async n=>n.filter(t=>t!=="avif")},ta=["png","jpg","jpeg"],$g={extension:{type:F.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async n=>[...n,...ta],remove:async n=>n.filter(t=>!ta.includes(t))},Hg="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Cr(n){return Hg?!1:document.createElement("video").canPlayType(n)!==""}const Vg={extension:{type:F.DetectionParser,priority:0},test:async()=>Cr("video/mp4"),add:async n=>[...n,"mp4","m4v"],remove:async n=>n.filter(t=>t!=="mp4"&&t!=="m4v")},Wg={extension:{type:F.DetectionParser,priority:0},test:async()=>Cr("video/ogg"),add:async n=>[...n,"ogv"],remove:async n=>n.filter(t=>t!=="ogv")},Xg={extension:{type:F.DetectionParser,priority:0},test:async()=>Cr("video/webm"),add:async n=>[...n,"webm"],remove:async n=>n.filter(t=>t!=="webm")},Yg={extension:{type:F.DetectionParser,priority:0},test:async()=>xc("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async n=>[...n,"webp"],remove:async n=>n.filter(t=>t!=="webp")},_c=class Qn{constructor(){this.loadOptions={...Qn.defaultOptions},this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,r)=>(this._parsersValidated=!1,t[e]=r,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const r={promise:null,parser:null};return r.promise=(async()=>{var o,a;let i=null,s=null;if((e.parser||e.loadParser)&&(s=this._parserHash[e.parser||e.loadParser],e.loadParser&&j(`[Assets] "loadParser" is deprecated, use "parser" instead for ${t}`),s||j(`[Assets] specified load parser "${e.parser||e.loadParser}" not found while loading ${t}`)),!s){for(let h=0;h<this.parsers.length;h++){const c=this.parsers[h];if(c.load&&((o=c.test)!=null&&o.call(c,t,e,this))){s=c;break}}if(!s)return j(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}i=await s.load(t,e,this),r.parser=s;for(let h=0;h<this.parsers.length;h++){const c=this.parsers[h];c.parse&&c.parse&&await((a=c.testParse)==null?void 0:a.call(c,i,e,this))&&(i=await c.parse(i,e,this)||i,r.parser=c)}return i})(),r}async load(t,e){this._parsersValidated||this._validateParsers();const r=typeof e=="function"?{...Qn.defaultOptions,...this.loadOptions,onProgress:e}:{...Qn.defaultOptions,...this.loadOptions,...e||{}},{onProgress:i,onError:s,strategy:o,retryCount:a,retryDelay:h}=r;let c=0;const l={},u=fr(t),d=Ct(t,g=>({alias:[g],src:g,data:{}})),f=d.reduce((g,m)=>g+(m.progressSize||1),0),p=d.map(async g=>{const m=pt.toAbsolute(g.src);l[g.src]||(await this._loadAssetWithRetry(m,g,{onProgress:i,onError:s,strategy:o,retryCount:a,retryDelay:h},l),c+=g.progressSize||1,i&&i(c/f))});return await Promise.all(p),u?l[d[0].src]:l}async unload(t){const r=Ct(t,i=>({alias:[i],src:i})).map(async i=>{var a,h;const s=pt.toAbsolute(i.src),o=this.promiseCache[s];if(o){const c=await o.promise;delete this.promiseCache[s],await((h=(a=o.parser)==null?void 0:a.unload)==null?void 0:h.call(a,c,i,this))}});await Promise.all(r)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name||t.id).reduce((t,e)=>(!e.name&&!e.id?j("[Assets] parser should have an id"):(t[e.name]||t[e.id])&&j(`[Assets] parser id conflict "${e.id}"`),t[e.name]=e,e.id&&(t[e.id]=e),t),{})}async _loadAssetWithRetry(t,e,r,i){let s=0;const{onError:o,strategy:a,retryCount:h,retryDelay:c}=r,l=u=>new Promise(d=>setTimeout(d,u));for(;;)try{this.promiseCache[t]||(this.promiseCache[t]=this._getLoadPromiseAndParser(t,e)),i[e.src]=await this.promiseCache[t].promise;return}catch(u){delete this.promiseCache[t],delete i[e.src],s++;const d=a!=="retry"||s>h;if(a==="retry"&&!d){o&&o(u,e),await l(c);continue}if(a==="skip"){o&&o(u,e);return}o&&o(u,e);const f=new Error(`[Loader.load] Failed to load ${t}.
${u}`);throw u instanceof Error&&u.stack&&(f.stack=u.stack),f}}};_c.defaultOptions={onProgress:void 0,onError:void 0,strategy:"throw",retryCount:3,retryDelay:250};let qg=_c;function De(n,t){if(Array.isArray(t)){for(const e of t)if(n.startsWith(`data:${e}`))return!0;return!1}return n.startsWith(`data:${t}`)}function Ge(n,t){const e=n.split("?")[0],r=pt.extname(e).toLowerCase();return Array.isArray(t)?t.includes(r):r===t}const jg=".json",Zg="application/json",Kg={extension:{type:F.LoadParser,priority:Qt.Low},name:"loadJson",id:"json",test(n){return De(n,Zg)||Ge(n,jg)},async load(n){return await(await K.get().fetch(n)).json()}},Qg=".txt",Jg="text/plain",tm={name:"loadTxt",id:"text",extension:{type:F.LoadParser,priority:Qt.Low,name:"loadTxt"},test(n){return De(n,Jg)||Ge(n,Qg)},async load(n){return await(await K.get().fetch(n)).text()}},em=["normal","bold","100","200","300","400","500","600","700","800","900"],nm=[".ttf",".otf",".woff",".woff2"],rm=["font/ttf","font/otf","font/woff","font/woff2"],im=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function sm(n){const t=pt.extname(n),i=pt.basename(n,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1));let s=i.length>0;for(const a of i)if(!a.match(im)){s=!1;break}let o=i.join(" ");return s||(o=`"${o.replace(/[\\"]/g,"\\$&")}"`),o}const om=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function am(n){return om.test(n)?n:encodeURI(n)}const hm={extension:{type:F.LoadParser,priority:Qt.Low},name:"loadWebFont",id:"web-font",test(n){return De(n,rm)||Ge(n,nm)},async load(n,t){var r,i,s;const e=K.get().getFontFaceSet();if(e){const o=[],a=((r=t.data)==null?void 0:r.family)??sm(n),h=((s=(i=t.data)==null?void 0:i.weights)==null?void 0:s.filter(l=>em.includes(l)))??["normal"],c=t.data??{};for(let l=0;l<h.length;l++){const u=h[l],d=new FontFace(a,`url(${am(n)})`,{...c,weight:u});await d.load(),e.add(d),o.push(d)}return nt.has(`${a}-and-url`)?nt.get(`${a}-and-url`).entries.push({url:n,faces:o}):nt.set(`${a}-and-url`,{entries:[{url:n,faces:o}]}),o.length===1?o[0]:o}return j("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(n){const t=Array.isArray(n)?n:[n],e=t[0].family,r=nt.get(`${e}-and-url`),i=r.entries.find(s=>s.faces.some(o=>t.indexOf(o)!==-1));i.faces=i.faces.filter(s=>t.indexOf(s)===-1),i.faces.length===0&&(r.entries=r.entries.filter(s=>s!==i)),t.forEach(s=>{K.get().getFontFaceSet().delete(s)}),r.entries.length===0&&nt.remove(`${e}-and-url`)}};var ai,ea;function cm(){if(ea)return ai;ea=1,ai=e;var n={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},t=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function e(s){var o=[];return s.replace(t,function(a,h,c){var l=h.toLowerCase();for(c=i(c),l=="m"&&c.length>2&&(o.push([h].concat(c.splice(0,2))),l="l",h=h=="m"?"l":"L");;){if(c.length==n[l])return c.unshift(h),o.push(c);if(c.length<n[l])throw new Error("malformed path data");o.push([h].concat(c.splice(0,n[l])))}}),o}var r=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function i(s){var o=s.match(r);return o?o.map(Number):[]}return ai}var lm=cm();const um=Na(lm);function dm(n,t){const e=um(n),r=[];let i=null,s=0,o=0;for(let a=0;a<e.length;a++){const h=e[a],c=h[0],l=h;switch(c){case"M":s=l[1],o=l[2],t.moveTo(s,o);break;case"m":s+=l[1],o+=l[2],t.moveTo(s,o);break;case"H":s=l[1],t.lineTo(s,o);break;case"h":s+=l[1],t.lineTo(s,o);break;case"V":o=l[1],t.lineTo(s,o);break;case"v":o+=l[1],t.lineTo(s,o);break;case"L":s=l[1],o=l[2],t.lineTo(s,o);break;case"l":s+=l[1],o+=l[2],t.lineTo(s,o);break;case"C":s=l[5],o=l[6],t.bezierCurveTo(l[1],l[2],l[3],l[4],s,o);break;case"c":t.bezierCurveTo(s+l[1],o+l[2],s+l[3],o+l[4],s+l[5],o+l[6]),s+=l[5],o+=l[6];break;case"S":s=l[3],o=l[4],t.bezierCurveToShort(l[1],l[2],s,o);break;case"s":t.bezierCurveToShort(s+l[1],o+l[2],s+l[3],o+l[4]),s+=l[3],o+=l[4];break;case"Q":s=l[3],o=l[4],t.quadraticCurveTo(l[1],l[2],s,o);break;case"q":t.quadraticCurveTo(s+l[1],o+l[2],s+l[3],o+l[4]),s+=l[3],o+=l[4];break;case"T":s=l[1],o=l[2],t.quadraticCurveToShort(s,o);break;case"t":s+=l[1],o+=l[2],t.quadraticCurveToShort(s,o);break;case"A":s=l[6],o=l[7],t.arcToSvg(l[1],l[2],l[3],l[4],l[5],s,o);break;case"a":s+=l[6],o+=l[7],t.arcToSvg(l[1],l[2],l[3],l[4],l[5],s,o);break;case"Z":case"z":t.closePath(),r.length>0&&(i=r.pop(),i?(s=i.startX,o=i.startY):(s=0,o=0)),i=null;break;default:j(`Unknown SVG path command: ${c}`)}c!=="Z"&&c!=="z"&&i===null&&(i={startX:s,startY:o},r.push(i))}return t}class Cs{constructor(t=0,e=0,r=0){this.type="circle",this.x=t,this.y=e,this.radius=r}clone(){return new Cs(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const r=this.radius*this.radius;let i=this.x-t,s=this.y-e;return i*=i,s*=s,i+s<=r}strokeContains(t,e,r,i=.5){if(this.radius===0)return!1;const s=this.x-t,o=this.y-e,a=this.radius,h=(1-i)*r,c=Math.sqrt(s*s+o*o);return c<=a+h&&c>a-(r-h)}getBounds(t){return t||(t=new Y),t.x=this.x-this.radius,t.y=this.y-this.radius,t.width=this.radius*2,t.height=this.radius*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Ms{constructor(t=0,e=0,r=0,i=0){this.type="ellipse",this.x=t,this.y=e,this.halfWidth=r,this.halfHeight=i}clone(){return new Ms(this.x,this.y,this.halfWidth,this.halfHeight)}contains(t,e){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let r=(t-this.x)/this.halfWidth,i=(e-this.y)/this.halfHeight;return r*=r,i*=i,r+i<=1}strokeContains(t,e,r,i=.5){const{halfWidth:s,halfHeight:o}=this;if(s<=0||o<=0)return!1;const a=r*(1-i),h=r-a,c=s-h,l=o-h,u=s+a,d=o+a,f=t-this.x,p=e-this.y,g=f*f/(c*c)+p*p/(l*l),m=f*f/(u*u)+p*p/(d*d);return g>1&&m<=1}getBounds(t){return t||(t=new Y),t.x=this.x-this.halfWidth,t.y=this.y-this.halfHeight,t.width=this.halfWidth*2,t.height=this.halfHeight*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function fm(n,t,e,r,i,s){const o=n-e,a=t-r,h=i-e,c=s-r,l=o*h+a*c,u=h*h+c*c;let d=-1;u!==0&&(d=l/u);let f,p;d<0?(f=e,p=r):d>1?(f=i,p=s):(f=e+d*h,p=r+d*c);const g=n-f,m=t-p;return g*g+m*m}let pm,gm;class hn{constructor(...t){this.type="polygon";let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const r=[];for(let i=0,s=e.length;i<s;i++)r.push(e[i].x,e[i].y);e=r}this.points=e,this.closePath=!0}isClockwise(){let t=0;const e=this.points,r=e.length;for(let i=0;i<r;i+=2){const s=e[i],o=e[i+1],a=e[(i+2)%r],h=e[(i+3)%r];t+=(a-s)*(h+o)}return t<0}containsPolygon(t){const e=this.getBounds(pm),r=t.getBounds(gm);if(!e.containsRect(r))return!1;const i=t.points;for(let s=0;s<i.length;s+=2){const o=i[s],a=i[s+1];if(!this.contains(o,a))return!1}return!0}clone(){const t=this.points.slice(),e=new hn(t);return e.closePath=this.closePath,e}contains(t,e){let r=!1;const i=this.points.length/2;for(let s=0,o=i-1;s<i;o=s++){const a=this.points[s*2],h=this.points[s*2+1],c=this.points[o*2],l=this.points[o*2+1];h>e!=l>e&&t<(c-a)*((e-h)/(l-h))+a&&(r=!r)}return r}strokeContains(t,e,r,i=.5){const s=r*r,o=s*(1-i),a=s-o,{points:h}=this,c=h.length-(this.closePath?0:2);for(let l=0;l<c;l+=2){const u=h[l],d=h[l+1],f=h[(l+2)%h.length],p=h[(l+3)%h.length],g=fm(t,e,u,d,f,p),m=Math.sign((f-u)*(e-d)-(p-d)*(t-u));if(g<=(m<0?a:o))return!0}return!1}getBounds(t){t||(t=new Y);const e=this.points;let r=1/0,i=-1/0,s=1/0,o=-1/0;for(let a=0,h=e.length;a<h;a+=2){const c=e[a],l=e[a+1];r=c<r?c:r,i=c>i?c:i,s=l<s?l:s,o=l>o?l:o}return t.x=r,t.width=i-r,t.y=s,t.height=o-s,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return U("8.11.0","Polygon.lastX is deprecated, please use Polygon.lastX instead."),this.points[this.points.length-2]}get y(){return U("8.11.0","Polygon.y is deprecated, please use Polygon.lastY instead."),this.points[this.points.length-1]}get startX(){return this.points[0]}get startY(){return this.points[1]}}const Hn=(n,t,e,r,i,s,o)=>{const a=n-e,h=t-r,c=Math.sqrt(a*a+h*h);return c>=i-s&&c<=i+o};class Ss{constructor(t=0,e=0,r=0,i=0,s=20){this.type="roundedRectangle",this.x=t,this.y=e,this.width=r,this.height=i,this.radius=s}getBounds(t){return t||(t=new Y),t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new Ss(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const r=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+r&&e<=this.y+this.height-r||t>=this.x+r&&t<=this.x+this.width-r)return!0;let i=t-(this.x+r),s=e-(this.y+r);const o=r*r;if(i*i+s*s<=o||(i=t-(this.x+this.width-r),i*i+s*s<=o)||(s=e-(this.y+this.height-r),i*i+s*s<=o)||(i=t-(this.x+r),i*i+s*s<=o))return!0}return!1}strokeContains(t,e,r,i=.5){const{x:s,y:o,width:a,height:h,radius:c}=this,l=r*(1-i),u=r-l,d=s+c,f=o+c,p=a-c*2,g=h-c*2,m=s+a,y=o+h;return(t>=s-l&&t<=s+u||t>=m-u&&t<=m+l)&&e>=f&&e<=f+g||(e>=o-l&&e<=o+u||e>=y-u&&e<=y+l)&&t>=d&&t<=d+p?!0:t<d&&e<f&&Hn(t,e,d,f,c,u,l)||t>m-c&&e<f&&Hn(t,e,m-c,f,c,u,l)||t>m-c&&e>y-c&&Hn(t,e,m-c,y-c,c,u,l)||t<d&&e>y-c&&Hn(t,e,d,y-c,c,u,l)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const bc={};function mm(n,t,e){let r=2166136261;for(let i=0;i<t;i++)r^=n[i].uid,r=Math.imul(r,16777619),r>>>=0;return bc[r]||ym(n,t,r,e)}function ym(n,t,e,r){const i={};let s=0;for(let a=0;a<r;a++){const h=a<t?n[a]:D.EMPTY.source;i[s++]=h.source,i[s++]=h.style}const o=new an(i);return bc[e]=o,o}class na{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this.uint32View=null,this.float32View=null,this.uint16View=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._int32View=null,this._float64Array=null,this._bigUint64Array=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}function ra(n,t,e,r){if(e??(e=0),r??(r=Math.min(n.byteLength-e,t.byteLength)),!(e&7)&&!(r&7)){const i=r/8;new Float64Array(t,0,i).set(new Float64Array(n,e,i))}else if(!(e&3)&&!(r&3)){const i=r/4;new Float32Array(t,0,i).set(new Float32Array(n,e,i))}else new Uint8Array(t).set(new Uint8Array(n,e,r))}const xm={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var _m=(n=>(n[n.DISABLED=0]="DISABLED",n[n.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",n[n.MASK_ACTIVE=2]="MASK_ACTIVE",n[n.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",n[n.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",n[n.NONE=5]="NONE",n))(_m||{});function Yi(n,t){return t.alphaMode==="no-premultiply-alpha"&&xm[n]||n}const bm=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function vm(n){let t="";for(let e=0;e<n;++e)e>0&&(t+=`
else `),e<n-1&&(t+=`if(test == ${e}.0){}`);return t}function wm(n,t){if(n===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);try{for(;;){const r=bm.replace(/%forloop%/gi,vm(n));if(t.shaderSource(e,r),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))n=n/2|0;else break}}finally{t.deleteShader(e)}return n}let xe=null;function Am(){var t;if(xe)return xe;const n=rc();return xe=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),xe=wm(xe,n),(t=n.getExtension("WEBGL_lose_context"))==null||t.loseContext(),xe}class Cm{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let t=0;t<this.count;t++){const e=this.textures[t];this.textures[t]=null,this.ids[e.uid]=null}this.count=0}}class Mm{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new Cm,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null,this.elements=null}}const cn=[];let pr=0;br.register({clear:()=>{if(cn.length>0)for(const n of cn)n&&n.destroy();cn.length=0,pr=0}});function ia(){return pr>0?cn[--pr]:new Mm}function sa(n){n.elements=null,cn[pr++]=n}let Ye=0;const vc=class wc{constructor(t){this.uid=Z("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],t={...wc.defaultOptions,...t},t.maxTextures||(U("v8.8.0","maxTextures is a required option for Batcher now, please pass it in the options"),t.maxTextures=Am());const{maxTextures:e,attributesInitialSize:r,indicesInitialSize:i}=t;this.attributeBuffer=new na(r*4),this.indexBuffer=new Uint16Array(i),this.maxTextures=e}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let t=0;t<this.batchIndex;t++)sa(this.batches[t]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(t){this._elements[this.elementSize++]=t,t._indexStart=this.indexSize,t._attributeStart=this.attributeSize,t._batcher=this,this.indexSize+=t.indexSize,this.attributeSize+=t.attributeSize*this.vertexSize}checkAndUpdateTexture(t,e){const r=t._batch.textures.ids[e._source.uid];return!r&&r!==0?!1:(t._textureId=r,t.texture=e,!0)}updateElement(t){this.dirty=!0;const e=this.attributeBuffer;t.packAsQuad?this.packQuadAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId):this.packAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId)}break(t){const e=this._elements;if(!e[this.elementStart])return;let r=ia(),i=r.textures;i.clear();const s=e[this.elementStart];let o=Yi(s.blendMode,s.texture._source),a=s.topology;this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const h=this.attributeBuffer.float32View,c=this.attributeBuffer.uint32View,l=this.indexBuffer;let u=this._batchIndexSize,d=this._batchIndexStart,f="startBatch",p=[];const g=this.maxTextures;for(let m=this.elementStart;m<this.elementSize;++m){const y=e[m];e[m]=null;const _=y.texture._source,b=Yi(y.blendMode,_),M=o!==b||a!==y.topology;if(_._batchTick===Ye&&!M){y._textureId=_._textureBindLocation,u+=y.indexSize,y.packAsQuad?(this.packQuadAttributes(y,h,c,y._attributeStart,y._textureId),this.packQuadIndex(l,y._indexStart,y._attributeStart/this.vertexSize)):(this.packAttributes(y,h,c,y._attributeStart,y._textureId),this.packIndex(y,l,y._indexStart,y._attributeStart/this.vertexSize)),y._batch=r,p.push(y);continue}_._batchTick=Ye,(i.count>=g||M)&&(this._finishBatch(r,d,u-d,i,o,a,t,f,p),f="renderBatch",d=u,o=b,a=y.topology,r=ia(),i=r.textures,i.clear(),p=[],++Ye),y._textureId=_._textureBindLocation=i.count,i.ids[_.uid]=i.count,i.textures[i.count++]=_,y._batch=r,p.push(y),u+=y.indexSize,y.packAsQuad?(this.packQuadAttributes(y,h,c,y._attributeStart,y._textureId),this.packQuadIndex(l,y._indexStart,y._attributeStart/this.vertexSize)):(this.packAttributes(y,h,c,y._attributeStart,y._textureId),this.packIndex(y,l,y._indexStart,y._attributeStart/this.vertexSize))}i.count>0&&(this._finishBatch(r,d,u-d,i,o,a,t,f,p),d=u,++Ye),this.elementStart=this.elementSize,this._batchIndexStart=d,this._batchIndexSize=u}_finishBatch(t,e,r,i,s,o,a,h,c){t.gpuBindGroup=null,t.bindGroup=null,t.action=h,t.batcher=this,t.textures=i,t.blendMode=s,t.topology=o,t.start=e,t.size=r,t.elements=c,++Ye,this.batches[this.batchIndex++]=t,a.add(t)}finish(t){this.break(t)}ensureAttributeBuffer(t){t*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(t*4)}ensureIndexBuffer(t){t<=this.indexBuffer.length||this._resizeIndexBuffer(t)}_resizeAttributeBuffer(t){const e=Math.max(t,this.attributeBuffer.size*2),r=new na(e);ra(this.attributeBuffer.rawBinaryData,r.rawBinaryData),this.attributeBuffer=r}_resizeIndexBuffer(t){const e=this.indexBuffer;let r=Math.max(t,e.length*1.5);r+=r%2;const i=r>65535?new Uint32Array(r):new Uint16Array(r);if(i.BYTES_PER_ELEMENT!==e.BYTES_PER_ELEMENT)for(let s=0;s<e.length;s++)i[s]=e[s];else ra(e.buffer,i.buffer);this.indexBuffer=i}packQuadIndex(t,e,r){t[e]=r+0,t[e+1]=r+1,t[e+2]=r+2,t[e+3]=r+0,t[e+4]=r+2,t[e+5]=r+3}packIndex(t,e,r,i){const s=t.indices,o=t.indexSize,a=t.indexOffset,h=t.attributeOffset;for(let c=0;c<o;c++)e[r++]=i+s[c+a]-h}destroy(t={}){var e;if(this.batches!==null){for(let r=0;r<this.batchIndex;r++)sa(this.batches[r]);this.batches=null,this.geometry.destroy(!0),this.geometry=null,t.shader&&((e=this.shader)==null||e.destroy(),this.shader=null);for(let r=0;r<this._elements.length;r++)this._elements[r]&&(this._elements[r]._batch=null);this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}}};vc.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let Sm=vc;var J=(n=>(n[n.MAP_READ=1]="MAP_READ",n[n.MAP_WRITE=2]="MAP_WRITE",n[n.COPY_SRC=4]="COPY_SRC",n[n.COPY_DST=8]="COPY_DST",n[n.INDEX=16]="INDEX",n[n.VERTEX=32]="VERTEX",n[n.UNIFORM=64]="UNIFORM",n[n.STORAGE=128]="STORAGE",n[n.INDIRECT=256]="INDIRECT",n[n.QUERY_RESOLVE=512]="QUERY_RESOLVE",n[n.STATIC=1024]="STATIC",n))(J||{});class Xt extends Ut{constructor(t){let{data:e,size:r}=t;const{usage:i,label:s,shrinkToFit:o}=t;super(),this._gpuData=Object.create(null),this._gcLastUsed=-1,this.autoGarbageCollect=!0,this.uid=Z("buffer"),this._resourceType="buffer",this._resourceId=Z("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,e instanceof Array&&(e=new Float32Array(e)),this._data=e,r??(r=e==null?void 0:e.byteLength);const a=!!e;this.descriptor={size:r,usage:i,mappedAtCreation:a,label:s},this.shrinkToFit=o??!0}get data(){return this._data}set data(t){this.setDataWithSize(t,t.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&J.STATIC)}set static(t){t?this.descriptor.usage|=J.STATIC:this.descriptor.usage&=~J.STATIC}setDataWithSize(t,e,r){if(this._updateID++,this._updateSize=e*t.BYTES_PER_ELEMENT,this._data===t){r&&this.emit("update",this);return}const i=this._data;if(this._data=t,this._dataInt32=null,!i||i.length!==t.length){!this.shrinkToFit&&i&&t.byteLength<i.byteLength?r&&this.emit("update",this):(this.descriptor.size=t.byteLength,this._resourceId=Z("resource"),this.emit("change",this));return}r&&this.emit("update",this)}update(t){this._updateSize=t??this._updateSize,this._updateID++,this.emit("update",this)}unload(){var t;this.emit("unload",this);for(const e in this._gpuData)(t=this._gpuData[e])==null||t.destroy();this._gpuData=Object.create(null)}destroy(){this.destroyed=!0,this.unload(),this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}function Ac(n,t){if(!(n instanceof Xt)){let e=t?J.INDEX:J.VERTEX;n instanceof Array&&(t?(n=new Uint32Array(n),e=J.INDEX|J.COPY_DST):(n=new Float32Array(n),e=J.VERTEX|J.COPY_DST)),n=new Xt({data:n,label:t?"index-mesh-buffer":"vertex-mesh-buffer",usage:e})}return n}function Pm(n,t,e){const r=n.getAttribute(t);if(!r)return e.minX=0,e.minY=0,e.maxX=0,e.maxY=0,e;const i=r.buffer.data;let s=1/0,o=1/0,a=-1/0,h=-1/0;const c=i.BYTES_PER_ELEMENT,l=(r.offset||0)/c,u=(r.stride||8)/c;for(let d=l;d<i.length;d+=u){const f=i[d],p=i[d+1];f>a&&(a=f),p>h&&(h=p),f<s&&(s=f),p<o&&(o=p)}return e.minX=s,e.minY=o,e.maxX=a,e.maxY=h,e}function Tm(n){return(n instanceof Xt||Array.isArray(n)||n.BYTES_PER_ELEMENT)&&(n={buffer:n}),n.buffer=Ac(n.buffer,!1),n}class Ps extends Ut{constructor(t={}){super(),this._gpuData=Object.create(null),this.autoGarbageCollect=!0,this._gcLastUsed=-1,this.uid=Z("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new Mt,this._boundsDirty=!0;const{attributes:e,indexBuffer:r,topology:i}=t;if(this.buffers=[],this.attributes={},e)for(const s in e)this.addAttribute(s,e[s]);this.instanceCount=t.instanceCount??1,r&&this.addIndex(r),this.topology=i||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(t){return this.attributes[t]}getIndex(){return this.indexBuffer}getBuffer(t){return this.getAttribute(t).buffer}getSize(){for(const t in this.attributes){const e=this.attributes[t];return e.buffer.data.length/(e.stride/4||e.size)}return 0}addAttribute(t,e){const r=Tm(e);this.buffers.indexOf(r.buffer)===-1&&(this.buffers.push(r.buffer),r.buffer.on("update",this.onBufferUpdate,this),r.buffer.on("change",this.onBufferUpdate,this)),this.attributes[t]=r}addIndex(t){this.indexBuffer=Ac(t,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,Pm(this,"aPosition",this._bounds)):this._bounds}unload(){var t;this.emit("unload",this);for(const e in this._gpuData)(t=this._gpuData[e])==null||t.destroy();this._gpuData=Object.create(null)}destroy(t=!1){var e;this.emit("destroy",this),this.removeAllListeners(),t&&this.buffers.forEach(r=>r.destroy()),this.unload(),(e=this.indexBuffer)==null||e.destroy(),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const km=new Float32Array(1),Em=new Uint32Array(1);class Im extends Ps{constructor(){const e=new Xt({data:km,label:"attribute-batch-buffer",usage:J.VERTEX|J.COPY_DST,shrinkToFit:!1}),r=new Xt({data:Em,label:"index-batch-buffer",usage:J.INDEX|J.COPY_DST,shrinkToFit:!1}),i=24;super({attributes:{aPosition:{buffer:e,format:"float32x2",stride:i,offset:0},aUV:{buffer:e,format:"float32x2",stride:i,offset:8},aColor:{buffer:e,format:"unorm8x4",stride:i,offset:16},aTextureIdAndRound:{buffer:e,format:"uint16x2",stride:i,offset:20}},indexBuffer:r})}}function oa(n,t,e){if(n)for(const r in n){const i=r.toLocaleLowerCase(),s=t[i];if(s){let o=n[r];r==="header"&&(o=o.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),e&&s.push(`//----${e}----//`),s.push(o)}else j(`${r} placement hook does not exist in shader`)}}const Rm=/\{\{(.*?)\}\}/g;function aa(n){var r;const t={};return(((r=n.match(Rm))==null?void 0:r.map(i=>i.replace(/[{()}]/g,"")))??[]).forEach(i=>{t[i]=[]}),t}function ha(n,t){let e;const r=/@in\s+([^;]+);/g;for(;(e=r.exec(n))!==null;)t.push(e[1])}function ca(n,t,e=!1){const r=[];ha(t,r),n.forEach(a=>{a.header&&ha(a.header,r)});const i=r;e&&i.sort();const s=i.map((a,h)=>`       @location(${h}) ${a},`).join(`
`);let o=t.replace(/@in\s+[^;]+;\s*/g,"");return o=o.replace("{{in}}",`
${s}
`),o}function la(n,t){let e;const r=/@out\s+([^;]+);/g;for(;(e=r.exec(n))!==null;)t.push(e[1])}function Fm(n){const e=/\b(\w+)\s*:/g.exec(n);return e?e[1]:""}function Bm(n){const t=/@.*?\s+/g;return n.replace(t,"")}function Lm(n,t){const e=[];la(t,e),n.forEach(h=>{h.header&&la(h.header,e)});let r=0;const i=e.sort().map(h=>h.indexOf("builtin")>-1?h:`@location(${r++}) ${h}`).join(`,
`),s=e.sort().map(h=>`       var ${Bm(h)};`).join(`
`),o=`return VSOutput(
            ${e.sort().map(h=>` ${Fm(h)}`).join(`,
`)});`;let a=t.replace(/@out\s+[^;]+;\s*/g,"");return a=a.replace("{{struct}}",`
${i}
`),a=a.replace("{{start}}",`
${s}
`),a=a.replace("{{return}}",`
${o}
`),a}function ua(n,t){let e=n;for(const r in t){const i=t[r];i.join(`
`).length?e=e.replace(`{{${r}}}`,`//-----${r} START-----//
${i.join(`
`)}
//----${r} FINISH----//`):e=e.replace(`{{${r}}}`,"")}return e}const Wt=Object.create(null),hi=new Map;let Dm=0;function Gm({template:n,bits:t}){const e=Cc(n,t);if(Wt[e])return Wt[e];const{vertex:r,fragment:i}=zm(n,t);return Wt[e]=Mc(r,i,t),Wt[e]}function Om({template:n,bits:t}){const e=Cc(n,t);return Wt[e]||(Wt[e]=Mc(n.vertex,n.fragment,t)),Wt[e]}function zm(n,t){const e=t.map(o=>o.vertex).filter(o=>!!o),r=t.map(o=>o.fragment).filter(o=>!!o);let i=ca(e,n.vertex,!0);i=Lm(e,i);const s=ca(r,n.fragment,!0);return{vertex:i,fragment:s}}function Cc(n,t){return t.map(e=>(hi.has(e)||hi.set(e,Dm++),hi.get(e))).sort((e,r)=>e-r).join("-")+n.vertex+n.fragment}function Mc(n,t,e){const r=aa(n),i=aa(t);return e.forEach(s=>{oa(s.vertex,r,s.name),oa(s.fragment,i,s.name)}),{vertex:ua(n,r),fragment:ua(t,i)}}const Nm=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}

        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);

        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,Um=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;

    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {

        {{start}}

        var outColor:vec4<f32>;

        {{main}}

        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,$m=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;

        {{start}}

        vColor = vec4(1.);

        {{main}}

        vUV = uv;

        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,Hm=`

    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {

        {{start}}

        vec4 outColor;

        {{main}}

        finalColor = outColor * vColor;

        {{end}}
    }
`,Vm={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},Wm={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function Xm({bits:n,name:t}){const e=Gm({template:{fragment:Um,vertex:Nm},bits:[Vm,...n]});return Ar.from({name:t,vertex:{source:e.vertex,entryPoint:"main"},fragment:{source:e.fragment,entryPoint:"main"}})}function Ym({bits:n,name:t}){return new sc({name:t,...Om({template:{vertex:$m,fragment:Hm},bits:[Wm,...n]})})}const qm={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},jm={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},ci={};function Zm(n){const t=[];if(n===1)t.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),t.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let e=0;for(let r=0;r<n;r++)t.push(`@group(1) @binding(${e++}) var textureSource${r+1}: texture_2d<f32>;`),t.push(`@group(1) @binding(${e++}) var textureSampler${r+1}: sampler;`)}return t.join(`
`)}function Km(n){const t=[];if(n===1)t.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{t.push("switch vTextureId {");for(let e=0;e<n;e++)e===n-1?t.push("  default:{"):t.push(`  case ${e}:{`),t.push(`      outColor = textureSampleGrad(textureSource${e+1}, textureSampler${e+1}, vUV, uvDx, uvDy);`),t.push("      break;}");t.push("}")}return t.join(`
`)}function Qm(n){return ci[n]||(ci[n]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${Zm(n)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${Km(n)}
            `}}),ci[n]}const li={};function Jm(n){const t=[];for(let e=0;e<n;e++)e>0&&t.push("else"),e<n-1&&t.push(`if(vTextureId < ${e}.5)`),t.push("{"),t.push(`	outColor = texture(uTextures[${e}], vUV);`),t.push("}");return t.join(`
`)}function t1(n){return li[n]||(li[n]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${n}];

            `,main:`

                ${Jm(n)}
            `}}),li[n]}const e1={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32>
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},n1={name:"round-pixels-bit",vertex:{header:`
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},da={};function r1(n){let t=da[n];if(t)return t;const e=new Int32Array(n);for(let r=0;r<n;r++)e[r]=r;return t=da[n]=new vs({uTextures:{value:e,type:"i32",size:n}},{isStatic:!0}),t}class fa extends ws{constructor(t){const e=Ym({name:"batch",bits:[jm,t1(t),n1]}),r=Xm({name:"batch",bits:[qm,Qm(t),e1]});super({glProgram:e,gpuProgram:r,resources:{batchSamplers:r1(t)}}),this.maxTextures=t}}let qe=null;const Sc=class Pc extends Sm{constructor(t){super(t),this.geometry=new Im,this.name=Pc.extension.name,this.vertexSize=6,qe??(qe=new fa(t.maxTextures)),this.shader=qe}packAttributes(t,e,r,i,s){const o=s<<16|t.roundPixels&65535,a=t.transform,h=a.a,c=a.b,l=a.c,u=a.d,d=a.tx,f=a.ty,{positions:p,uvs:g}=t,m=t.color,y=t.attributeOffset,x=y+t.attributeSize;for(let _=y;_<x;_++){const b=_*2,M=p[b],C=p[b+1];e[i++]=h*M+l*C+d,e[i++]=u*C+c*M+f,e[i++]=g[b],e[i++]=g[b+1],r[i++]=m,r[i++]=o}}packQuadAttributes(t,e,r,i,s){const o=t.texture,a=t.transform,h=a.a,c=a.b,l=a.c,u=a.d,d=a.tx,f=a.ty,p=t.bounds,g=p.maxX,m=p.minX,y=p.maxY,x=p.minY,_=o.uvs,b=t.color,M=s<<16|t.roundPixels&65535;e[i+0]=h*m+l*x+d,e[i+1]=u*x+c*m+f,e[i+2]=_.x0,e[i+3]=_.y0,r[i+4]=b,r[i+5]=M,e[i+6]=h*g+l*x+d,e[i+7]=u*x+c*g+f,e[i+8]=_.x1,e[i+9]=_.y1,r[i+10]=b,r[i+11]=M,e[i+12]=h*g+l*y+d,e[i+13]=u*y+c*g+f,e[i+14]=_.x2,e[i+15]=_.y2,r[i+16]=b,r[i+17]=M,e[i+18]=h*m+l*y+d,e[i+19]=u*y+c*m+f,e[i+20]=_.x3,e[i+21]=_.y3,r[i+22]=b,r[i+23]=M}_updateMaxTextures(t){this.shader.maxTextures!==t&&(qe=new fa(t),this.shader=qe)}destroy(){this.shader=null,super.destroy()}};Sc.extension={type:[F.Batcher],name:"default"};let i1=Sc;class Mr{constructor(t){this.items=Object.create(null);const{renderer:e,type:r,onUnload:i,priority:s,name:o}=t;this._renderer=e,e.gc.addResourceHash(this,"items",r,s??0),this._onUnload=i,this.name=o}add(t){return this.items[t.uid]?!1:(this.items[t.uid]=t,t.once("unload",this.remove,this),t._gcLastUsed=this._renderer.gc.now,!0)}remove(t,...e){var i;if(!this.items[t.uid])return;const r=t._gpuData[this._renderer.uid];r&&((i=this._onUnload)==null||i.call(this,t,...e),r.destroy(),t._gpuData[this._renderer.uid]=null,this.items[t.uid]=null)}removeAll(...t){Object.values(this.items).forEach(e=>e&&this.remove(e,...t))}destroy(...t){this.removeAll(...t),this.items=Object.create(null),this._renderer=null,this._onUnload=null}}function s1(n,t,e,r,i,s,o,a=null){let h=0;e*=t,i*=s;const c=a.a,l=a.b,u=a.c,d=a.d,f=a.tx,p=a.ty;for(;h<o;){const g=n[e],m=n[e+1];r[i]=c*g+u*m+f,r[i+1]=l*g+d*m+p,i+=s,e+=t,h++}}function o1(n,t,e,r){let i=0;for(t*=e;i<r;)n[t]=0,n[t+1]=0,t+=e,i++}function Tc(n,t,e,r,i){const s=t.a,o=t.b,a=t.c,h=t.d,c=t.tx,l=t.ty;e||(e=0),r||(r=2),i||(i=n.length/r-e);let u=e*r;for(let d=0;d<i;d++){const f=n[u],p=n[u+1];n[u]=s*f+a*p+c,n[u+1]=o*f+h*p+l,u+=r}}const a1=new z;class Ts{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.renderable&&this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const t=this.baseColor,e=t>>16|t&65280|(t&255)<<16,r=this.renderable;return r?zh(e,r.groupColor)+(this.alpha*r.groupAlpha*255<<24):e+(this.alpha*255<<24)}get transform(){var t;return((t=this.renderable)==null?void 0:t.groupTransform)||a1}copyTo(t){t.indexOffset=this.indexOffset,t.indexSize=this.indexSize,t.attributeOffset=this.attributeOffset,t.attributeSize=this.attributeSize,t.baseColor=this.baseColor,t.alpha=this.alpha,t.texture=this.texture,t.geometryData=this.geometryData,t.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}destroy(){this.renderable=null,this.texture=null,this.geometryData=null,this._batcher=null,this._batch=null}}const _n={extension:{type:F.ShapeBuilder,name:"circle"},build(n,t){let e,r,i,s,o,a;if(n.type==="circle"){const b=n;if(o=a=b.radius,o<=0)return!1;e=b.x,r=b.y,i=s=0}else if(n.type==="ellipse"){const b=n;if(o=b.halfWidth,a=b.halfHeight,o<=0||a<=0)return!1;e=b.x,r=b.y,i=s=0}else{const b=n,M=b.width/2,C=b.height/2;e=b.x+M,r=b.y+C,o=a=Math.max(0,Math.min(b.radius,Math.min(M,C))),i=M-o,s=C-a}if(i<0||s<0)return!1;const h=Math.ceil(2.3*Math.sqrt(o+a)),c=h*8+(i?4:0)+(s?4:0);if(c===0)return!1;if(h===0)return t[0]=t[6]=e+i,t[1]=t[3]=r+s,t[2]=t[4]=e-i,t[5]=t[7]=r-s,!0;let l=0,u=h*4+(i?2:0)+2,d=u,f=c,p=i+o,g=s,m=e+p,y=e-p,x=r+g;if(t[l++]=m,t[l++]=x,t[--u]=x,t[--u]=y,s){const b=r-g;t[d++]=y,t[d++]=b,t[--f]=b,t[--f]=m}for(let b=1;b<h;b++){const M=Math.PI/2*(b/h),C=i+Math.cos(M)*o,A=s+Math.sin(M)*a,E=e+C,I=e-C,T=r+A,P=r-A;t[l++]=E,t[l++]=T,t[--u]=T,t[--u]=I,t[d++]=I,t[d++]=P,t[--f]=P,t[--f]=E}p=i,g=s+a,m=e+p,y=e-p,x=r+g;const _=r-g;return t[l++]=m,t[l++]=x,t[--f]=_,t[--f]=m,i&&(t[l++]=y,t[l++]=x,t[--f]=_,t[--f]=y),!0},triangulate(n,t,e,r,i,s){if(n.length===0)return;let o=0,a=0;for(let l=0;l<n.length;l+=2)o+=n[l],a+=n[l+1];o/=n.length/2,a/=n.length/2;let h=r;t[h*e]=o,t[h*e+1]=a;const c=h++;for(let l=0;l<n.length;l+=2)t[h*e]=n[l],t[h*e+1]=n[l+1],l>0&&(i[s++]=h,i[s++]=c,i[s++]=h-1),h++;i[s++]=c+1,i[s++]=c,i[s++]=h-1}},h1={..._n,extension:{..._n.extension,name:"ellipse"}},c1={..._n,extension:{..._n.extension,name:"roundedRectangle"}},kc=1e-4,pa=1e-4;function l1(n){const t=n.length;if(t<6)return 1;let e=0;for(let r=0,i=n[t-2],s=n[t-1];r<t;r+=2){const o=n[r],a=n[r+1];e+=(o-i)*(a+s),i=o,s=a}return e<0?-1:1}function ga(n,t,e,r,i,s,o,a){const h=n-e*i,c=t-r*i,l=n+e*s,u=t+r*s;let d,f;o?(d=r,f=-e):(d=-r,f=e);const p=h+d,g=c+f,m=l+d,y=u+f;return a.push(p,g),a.push(m,y),2}function se(n,t,e,r,i,s,o,a){const h=e-n,c=r-t;let l=Math.atan2(h,c),u=Math.atan2(i-n,s-t);a&&l<u?l+=Math.PI*2:!a&&l>u&&(u+=Math.PI*2);let d=l;const f=u-l,p=Math.abs(f),g=Math.sqrt(h*h+c*c),m=(15*p*Math.sqrt(g)/Math.PI>>0)+1,y=f/m;if(d+=y,a){o.push(n,t),o.push(e,r);for(let x=1,_=d;x<m;x++,_+=y)o.push(n,t),o.push(n+Math.sin(_)*g,t+Math.cos(_)*g);o.push(n,t),o.push(i,s)}else{o.push(e,r),o.push(n,t);for(let x=1,_=d;x<m;x++,_+=y)o.push(n+Math.sin(_)*g,t+Math.cos(_)*g),o.push(n,t);o.push(i,s),o.push(n,t)}return m*2}function u1(n,t,e,r,i,s){const o=kc;if(n.length===0)return;const a=t;let h=a.alignment;if(t.alignment!==.5){let k=l1(n);h=(h-.5)*k+.5}const c=new V(n[0],n[1]),l=new V(n[n.length-2],n[n.length-1]),u=r,d=Math.abs(c.x-l.x)<o&&Math.abs(c.y-l.y)<o;if(u){n=n.slice(),d&&(n.pop(),n.pop(),l.set(n[n.length-2],n[n.length-1]));const k=(c.x+l.x)*.5,L=(l.y+c.y)*.5;n.unshift(k,L),n.push(k,L)}const f=i,p=n.length/2;let g=n.length;const m=f.length/2,y=a.width/2,x=y*y,_=a.miterLimit*a.miterLimit;let b=n[0],M=n[1],C=n[2],A=n[3],E=0,I=0,T=-(M-A),P=b-C,G=0,O=0,v=Math.sqrt(T*T+P*P);T/=v,P/=v,T*=y,P*=y;const R=h,w=(1-R)*2,S=R*2;u||(a.cap==="round"?g+=se(b-T*(w-S)*.5,M-P*(w-S)*.5,b-T*w,M-P*w,b+T*S,M+P*S,f,!0)+2:a.cap==="square"&&(g+=ga(b,M,T,P,w,S,!0,f))),f.push(b-T*w,M-P*w),f.push(b+T*S,M+P*S);for(let k=1;k<p-1;++k){b=n[(k-1)*2],M=n[(k-1)*2+1],C=n[k*2],A=n[k*2+1],E=n[(k+1)*2],I=n[(k+1)*2+1],T=-(M-A),P=b-C,v=Math.sqrt(T*T+P*P),T/=v,P/=v,T*=y,P*=y,G=-(A-I),O=C-E,v=Math.sqrt(G*G+O*O),G/=v,O/=v,G*=y,O*=y;const L=C-b,N=M-A,H=C-E,rt=I-A,Q=L*H+N*rt,it=N*H-rt*L,ot=it<0;if(Math.abs(it)<.001*Math.abs(Q)){f.push(C-T*w,A-P*w),f.push(C+T*S,A+P*S),Q>=0&&(a.join==="round"?g+=se(C,A,C-T*w,A-P*w,C-G*w,A-O*w,f,!1)+4:g+=2,f.push(C-G*S,A-O*S),f.push(C+G*w,A+O*w));continue}const ht=(-T+b)*(-P+A)-(-T+C)*(-P+M),mt=(-G+E)*(-O+A)-(-G+C)*(-O+I),$t=(L*mt-H*ht)/it,Cn=(rt*ht-N*mt)/it,Ir=($t-C)*($t-C)+(Cn-A)*(Cn-A),te=C+($t-C)*w,ee=A+(Cn-A)*w,ne=C-($t-C)*S,re=A-(Cn-A)*S,Jc=Math.min(L*L+N*N,H*H+rt*rt),Hs=ot?w:S,tl=Jc+Hs*Hs*x;Ir<=tl?a.join==="bevel"||Ir/x>_?(ot?(f.push(te,ee),f.push(C+T*S,A+P*S),f.push(te,ee),f.push(C+G*S,A+O*S)):(f.push(C-T*w,A-P*w),f.push(ne,re),f.push(C-G*w,A-O*w),f.push(ne,re)),g+=2):a.join==="round"?ot?(f.push(te,ee),f.push(C+T*S,A+P*S),g+=se(C,A,C+T*S,A+P*S,C+G*S,A+O*S,f,!0)+4,f.push(te,ee),f.push(C+G*S,A+O*S)):(f.push(C-T*w,A-P*w),f.push(ne,re),g+=se(C,A,C-T*w,A-P*w,C-G*w,A-O*w,f,!1)+4,f.push(C-G*w,A-O*w),f.push(ne,re)):(f.push(te,ee),f.push(ne,re)):(f.push(C-T*w,A-P*w),f.push(C+T*S,A+P*S),a.join==="round"?ot?g+=se(C,A,C+T*S,A+P*S,C+G*S,A+O*S,f,!0)+2:g+=se(C,A,C-T*w,A-P*w,C-G*w,A-O*w,f,!1)+2:a.join==="miter"&&Ir/x<=_&&(ot?(f.push(ne,re),f.push(ne,re)):(f.push(te,ee),f.push(te,ee)),g+=2),f.push(C-G*w,A-O*w),f.push(C+G*S,A+O*S),g+=2)}b=n[(p-2)*2],M=n[(p-2)*2+1],C=n[(p-1)*2],A=n[(p-1)*2+1],T=-(M-A),P=b-C,v=Math.sqrt(T*T+P*P),T/=v,P/=v,T*=y,P*=y,f.push(C-T*w,A-P*w),f.push(C+T*S,A+P*S),u||(a.cap==="round"?g+=se(C-T*(w-S)*.5,A-P*(w-S)*.5,C-T*w,A-P*w,C+T*S,A+P*S,f,!1)+2:a.cap==="square"&&(g+=ga(C,A,T,P,w,S,!1,f)));const B=pa*pa;for(let k=m;k<g+m-2;++k)b=f[k*2],M=f[k*2+1],C=f[(k+1)*2],A=f[(k+1)*2+1],E=f[(k+2)*2],I=f[(k+2)*2+1],!(Math.abs(b*(A-I)+C*(I-M)+E*(M-A))<B)&&s.push(k,k+1,k+2)}function d1(n,t,e,r){const i=kc;if(n.length===0)return;const s=n[0],o=n[1],a=n[n.length-2],h=n[n.length-1],c=t||Math.abs(s-a)<i&&Math.abs(o-h)<i,l=e,u=n.length/2,d=l.length/2;for(let f=0;f<u;f++)l.push(n[f*2]),l.push(n[f*2+1]);for(let f=0;f<u-1;f++)r.push(d+f,d+f+1);c&&r.push(d+u-1,d)}function Ec(n,t,e,r,i,s,o){const a=Eg(n,t,2);if(!a)return;for(let c=0;c<a.length;c+=3)s[o++]=a[c]+i,s[o++]=a[c+1]+i,s[o++]=a[c+2]+i;let h=i*r;for(let c=0;c<n.length;c+=2)e[h]=n[c],e[h+1]=n[c+1],h+=r}const f1=[],p1={extension:{type:F.ShapeBuilder,name:"polygon"},build(n,t){for(let e=0;e<n.points.length;e++)t[e]=n.points[e];return!0},triangulate(n,t,e,r,i,s){Ec(n,f1,t,e,r,i,s)}},g1={extension:{type:F.ShapeBuilder,name:"rectangle"},build(n,t){const e=n,r=e.x,i=e.y,s=e.width,o=e.height;return s>0&&o>0?(t[0]=r,t[1]=i,t[2]=r+s,t[3]=i,t[4]=r+s,t[5]=i+o,t[6]=r,t[7]=i+o,!0):!1},triangulate(n,t,e,r,i,s){let o=0;r*=e,t[r+o]=n[0],t[r+o+1]=n[1],o+=e,t[r+o]=n[2],t[r+o+1]=n[3],o+=e,t[r+o]=n[6],t[r+o+1]=n[7],o+=e,t[r+o]=n[4],t[r+o+1]=n[5],o+=e;const a=r/e;i[s++]=a,i[s++]=a+1,i[s++]=a+2,i[s++]=a+1,i[s++]=a+3,i[s++]=a+2}},m1={extension:{type:F.ShapeBuilder,name:"triangle"},build(n,t){return t[0]=n.x,t[1]=n.y,t[2]=n.x2,t[3]=n.y2,t[4]=n.x3,t[5]=n.y3,!0},triangulate(n,t,e,r,i,s){let o=0;r*=e,t[r+o]=n[0],t[r+o+1]=n[1],o+=e,t[r+o]=n[2],t[r+o+1]=n[3],o+=e,t[r+o]=n[4],t[r+o+1]=n[5];const a=r/e;i[s++]=a,i[s++]=a+1,i[s++]=a+2}},ma=[{offset:0,color:"white"},{offset:1,color:"black"}],ks=class qi{constructor(...t){this.uid=Z("fillGradient"),this._tick=0,this.type="linear",this.colorStops=[];let e=y1(t);e={...e.type==="radial"?qi.defaultRadialOptions:qi.defaultLinearOptions,...dr(e)},this._textureSize=e.textureSize,this._wrapMode=e.wrapMode,e.type==="radial"?(this.center=e.center,this.outerCenter=e.outerCenter??this.center,this.innerRadius=e.innerRadius,this.outerRadius=e.outerRadius,this.scale=e.scale,this.rotation=e.rotation):(this.start=e.start,this.end=e.end),this.textureSpace=e.textureSpace,this.type=e.type,e.colorStops.forEach(i=>{this.addColorStop(i.offset,i.color)})}addColorStop(t,e){return this.colorStops.push({offset:t,color:_t.shared.setValue(e).toHexa()}),this}buildLinearGradient(){if(this.texture)return;let{x:t,y:e}=this.start,{x:r,y:i}=this.end,s=r-t,o=i-e;const a=s<0||o<0;if(this._wrapMode==="clamp-to-edge"){if(s<0){const m=t;t=r,r=m,s*=-1}if(o<0){const m=e;e=i,i=m,o*=-1}}const h=this.colorStops.length?this.colorStops:ma,c=this._textureSize,{canvas:l,context:u}=xa(c,1),d=a?u.createLinearGradient(this._textureSize,0,0,0):u.createLinearGradient(0,0,this._textureSize,0);ya(d,h),u.fillStyle=d,u.fillRect(0,0,c,1),this.texture=new D({source:new Fe({resource:l,addressMode:this._wrapMode})});const f=Math.sqrt(s*s+o*o),p=Math.atan2(o,s),g=new z;g.scale(f/c,1),g.rotate(p),g.translate(t,e),this.textureSpace==="local"&&g.scale(c,c),this.transform=g}buildGradient(){this.texture||this._tick++,this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const t=this.colorStops.length?this.colorStops:ma,e=this._textureSize,{canvas:r,context:i}=xa(e,e),{x:s,y:o}=this.center,{x:a,y:h}=this.outerCenter,c=this.innerRadius,l=this.outerRadius,u=a-l,d=h-l,f=e/(l*2),p=(s-u)*f,g=(o-d)*f,m=i.createRadialGradient(p,g,c*f,(a-u)*f,(h-d)*f,l*f);ya(m,t),i.fillStyle=t[t.length-1].color,i.fillRect(0,0,e,e),i.fillStyle=m,i.translate(p,g),i.rotate(this.rotation),i.scale(1,this.scale),i.translate(-p,-g),i.fillRect(0,0,e,e),this.texture=new D({source:new Fe({resource:r,addressMode:this._wrapMode})});const y=new z;y.scale(1/f,1/f),y.translate(u,d),this.textureSpace==="local"&&y.scale(e,e),this.transform=y}destroy(){var t;(t=this.texture)==null||t.destroy(!0),this.texture=null,this.transform=null,this.colorStops=[],this.start=null,this.end=null,this.center=null,this.outerCenter=null}get styleKey(){return`fill-gradient-${this.uid}-${this._tick}`}};ks.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256,wrapMode:"clamp-to-edge"};ks.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256,wrapMode:"clamp-to-edge"};let wn=ks;function ya(n,t){for(let e=0;e<t.length;e++){const r=t[e];n.addColorStop(r.offset,r.color)}}function xa(n,t){const e=K.get().createCanvas(n,t),r=e.getContext("2d");return{canvas:e,context:r}}function y1(n){let t=n[0]??{};return(typeof t=="number"||n[1])&&(U("8.5.2","use options object instead"),t={type:"linear",start:{x:n[0],y:n[1]},end:{x:n[2],y:n[3]},textureSpace:n[4],textureSize:n[5]??wn.defaultLinearOptions.textureSize}),t}const x1=new z,_1=new Y;function b1(n,t,e,r){const i=t.matrix?n.copyFrom(t.matrix).invert():n.identity();if(t.textureSpace==="local"){const o=e.getBounds(_1);t.width&&o.pad(t.width);const{x:a,y:h}=o,c=1/o.width,l=1/o.height,u=-a*c,d=-h*l,f=i.a,p=i.b,g=i.c,m=i.d;i.a*=c,i.b*=c,i.c*=l,i.d*=l,i.tx=u*f+d*g+i.tx,i.ty=u*p+d*m+i.ty}else i.translate(t.texture.frame.x,t.texture.frame.y),i.scale(1/t.texture.source.width,1/t.texture.source.height);const s=t.texture.source.style;return!(t.fill instanceof wn)&&s.addressMode==="clamp-to-edge"&&(s.addressMode="repeat",s.update()),r&&i.append(x1.copyFrom(r).invert()),i}const Sr={};tt.handleByMap(F.ShapeBuilder,Sr);tt.add(g1,p1,m1,_n,h1,c1);const v1=new Y,w1=new z;function A1(n,t){const{geometryData:e,batches:r}=t;r.length=0,e.indices.length=0,e.vertices.length=0,e.uvs.length=0;for(let i=0;i<n.instructions.length;i++){const s=n.instructions[i];if(s.action==="texture")C1(s.data,r,e);else if(s.action==="fill"||s.action==="stroke"){const o=s.action==="stroke",a=s.data.path.shapePath,h=s.data.style,c=s.data.hole;o&&c&&_a(c.shapePath,h,!0,r,e),c&&(a.shapePrimitives[a.shapePrimitives.length-1].holes=c.shapePath.shapePrimitives),_a(a,h,o,r,e)}}}function C1(n,t,e){const r=[],i=Sr.rectangle,s=v1;s.x=n.dx,s.y=n.dy,s.width=n.dw,s.height=n.dh;const o=n.transform;if(!i.build(s,r))return;const{vertices:a,uvs:h,indices:c}=e,l=c.length,u=a.length/2;o&&Tc(r,o),i.triangulate(r,a,2,u,c,l);const d=n.image,f=d.uvs;h.push(f.x0,f.y0,f.x1,f.y1,f.x3,f.y3,f.x2,f.y2);const p=ut.get(Ts);p.indexOffset=l,p.indexSize=c.length-l,p.attributeOffset=u,p.attributeSize=a.length/2-u,p.baseColor=n.style,p.alpha=n.alpha,p.texture=d,p.geometryData=e,t.push(p)}function _a(n,t,e,r,i){const{vertices:s,uvs:o,indices:a}=i;n.shapePrimitives.forEach(({shape:h,transform:c,holes:l})=>{const u=[],d=Sr[h.type];if(!d.build(h,u))return;const f=a.length,p=s.length/2;let g="triangle-list";if(c&&Tc(u,c),e){const _=h.closePath??!0,b=t;b.pixelLine?(d1(u,_,s,a),g="line-list"):u1(u,b,!1,_,s,a)}else if(l){const _=[],b=u.slice();M1(l).forEach(C=>{_.push(b.length/2),b.push(...C)}),Ec(b,_,s,2,p,a,f)}else d.triangulate(u,s,2,p,a,f);const m=o.length/2,y=t.texture;if(y!==D.WHITE){const _=b1(w1,t,h,c);s1(s,2,p,o,m,2,s.length/2-p,_)}else o1(o,m,2,s.length/2-p);const x=ut.get(Ts);x.indexOffset=f,x.indexSize=a.length-f,x.attributeOffset=p,x.attributeSize=s.length/2-p,x.baseColor=t.color,x.alpha=t.alpha,x.texture=y,x.geometryData=i,x.topology=g,r.push(x)})}function M1(n){const t=[];for(let e=0;e<n.length;e++){const r=n[e].shape,i=[];Sr[r.type].build(r,i)&&t.push(i)}return t}class S1{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}reset(){this.batches&&this.batches.forEach(t=>{ut.return(t)}),this.graphicsData&&ut.return(this.graphicsData),this.isBatchable=!1,this.context=null,this.batches.length=0,this.geometryData.indices.length=0,this.geometryData.vertices.length=0,this.geometryData.uvs.length=0,this.graphicsData=null}destroy(){this.reset(),this.batches=null,this.geometryData=null}}class P1{constructor(){this.instructions=new xs}init(t){const e=t.maxTextures;this.batcher?this.batcher._updateMaxTextures(e):this.batcher=new i1({maxTextures:e}),this.instructions.reset()}get geometry(){return U(J0,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}destroy(){this.batcher.destroy(),this.instructions.destroy(),this.batcher=null,this.instructions=null}}const Es=class ji{constructor(t){this._renderer=t,this._managedContexts=new Mr({renderer:t,type:"resource",name:"graphicsContext"})}init(t){ji.defaultOptions.bezierSmoothness=(t==null?void 0:t.bezierSmoothness)??ji.defaultOptions.bezierSmoothness}getContextRenderData(t){return t._gpuData[this._renderer.uid].graphicsData||this._initContextRenderData(t)}updateGpuContext(t){const e=!!t._gpuData[this._renderer.uid],r=t._gpuData[this._renderer.uid]||this._initContext(t);if(t.dirty||!e){e&&r.reset(),A1(t,r);const i=t.batchMode;t.customShader||i==="no-batch"?r.isBatchable=!1:i==="auto"?r.isBatchable=r.geometryData.vertices.length<400:r.isBatchable=!0,t.dirty=!1}return r}getGpuContext(t){return t._gpuData[this._renderer.uid]||this._initContext(t)}_initContextRenderData(t){const e=ut.get(P1,{maxTextures:this._renderer.limits.maxBatchableTextures}),r=t._gpuData[this._renderer.uid],{batches:i,geometryData:s}=r;r.graphicsData=e;const o=s.vertices.length,a=s.indices.length;for(let u=0;u<i.length;u++)i[u].applyTransform=!1;const h=e.batcher;h.ensureAttributeBuffer(o),h.ensureIndexBuffer(a),h.begin();for(let u=0;u<i.length;u++){const d=i[u];h.add(d)}h.finish(e.instructions);const c=h.geometry;c.indexBuffer.setDataWithSize(h.indexBuffer,h.indexSize,!0),c.buffers[0].setDataWithSize(h.attributeBuffer.float32View,h.attributeSize,!0);const l=h.batches;for(let u=0;u<l.length;u++){const d=l[u];d.bindGroup=mm(d.textures.textures,d.textures.count,this._renderer.limits.maxBatchableTextures)}return e}_initContext(t){const e=new S1;return e.context=t,t._gpuData[this._renderer.uid]=e,this._managedContexts.add(t),e}destroy(){this._managedContexts.destroy(),this._renderer=null}};Es.extension={type:[F.WebGLSystem,F.WebGPUSystem],name:"graphicsContext"};Es.defaultOptions={bezierSmoothness:.5};let Is=Es;const T1=8,Vn=11920929e-14,k1=1;function Ic(n,t,e,r,i,s,o,a,h,c){const u=Math.min(.99,Math.max(0,c??Is.defaultOptions.bezierSmoothness));let d=(k1-u)/1;return d*=d,E1(t,e,r,i,s,o,a,h,n,d),n}function E1(n,t,e,r,i,s,o,a,h,c){Zi(n,t,e,r,i,s,o,a,h,c,0),h.push(o,a)}function Zi(n,t,e,r,i,s,o,a,h,c,l){if(l>T1)return;const u=(n+e)/2,d=(t+r)/2,f=(e+i)/2,p=(r+s)/2,g=(i+o)/2,m=(s+a)/2,y=(u+f)/2,x=(d+p)/2,_=(f+g)/2,b=(p+m)/2,M=(y+_)/2,C=(x+b)/2;if(l>0){let A=o-n,E=a-t;const I=Math.abs((e-o)*E-(r-a)*A),T=Math.abs((i-o)*E-(s-a)*A);if(I>Vn&&T>Vn){if((I+T)*(I+T)<=c*(A*A+E*E)){h.push(M,C);return}}else if(I>Vn){if(I*I<=c*(A*A+E*E)){h.push(M,C);return}}else if(T>Vn){if(T*T<=c*(A*A+E*E)){h.push(M,C);return}}else if(A=M-(n+o)/2,E=C-(t+a)/2,A*A+E*E<=c){h.push(M,C);return}}Zi(n,t,u,d,y,x,M,C,h,c,l+1),Zi(M,C,_,b,g,m,o,a,h,c,l+1)}const I1=8,R1=11920929e-14,F1=1;function B1(n,t,e,r,i,s,o,a){const c=Math.min(.99,Math.max(0,a??Is.defaultOptions.bezierSmoothness));let l=(F1-c)/1;return l*=l,L1(t,e,r,i,s,o,n,l),n}function L1(n,t,e,r,i,s,o,a){Ki(o,n,t,e,r,i,s,a,0),o.push(i,s)}function Ki(n,t,e,r,i,s,o,a,h){if(h>I1)return;const c=(t+r)/2,l=(e+i)/2,u=(r+s)/2,d=(i+o)/2,f=(c+u)/2,p=(l+d)/2;let g=s-t,m=o-e;const y=Math.abs((r-s)*m-(i-o)*g);if(y>R1){if(y*y<=a*(g*g+m*m)){n.push(f,p);return}}else if(g=f-(t+s)/2,m=p-(e+o)/2,g*g+m*m<=a){n.push(f,p);return}Ki(n,t,e,c,l,f,p,a,h+1),Ki(n,f,p,u,d,s,o,a,h+1)}function Rc(n,t,e,r,i,s,o,a){let h=Math.abs(i-s);(!o&&i>s||o&&s>i)&&(h=2*Math.PI-h),a||(a=Math.max(6,Math.floor(6*Math.pow(r,1/3)*(h/Math.PI)))),a=Math.max(a,3);let c=h/a,l=i;c*=o?-1:1;for(let u=0;u<a+1;u++){const d=Math.cos(l),f=Math.sin(l),p=t+d*r,g=e+f*r;n.push(p,g),l+=c}}function D1(n,t,e,r,i,s){const o=n[n.length-2],h=n[n.length-1]-e,c=o-t,l=i-e,u=r-t,d=Math.abs(h*u-c*l);if(d<1e-8||s===0){(n[n.length-2]!==t||n[n.length-1]!==e)&&n.push(t,e);return}const f=h*h+c*c,p=l*l+u*u,g=h*l+c*u,m=s*Math.sqrt(f)/d,y=s*Math.sqrt(p)/d,x=m*g/f,_=y*g/p,b=m*u+y*c,M=m*l+y*h,C=c*(y+x),A=h*(y+x),E=u*(m+_),I=l*(m+_),T=Math.atan2(A-M,C-b),P=Math.atan2(I-M,E-b);Rc(n,b+t,M+e,s,T,P,c*l>u*h)}const ln=Math.PI*2,ui={centerX:0,centerY:0,ang1:0,ang2:0},di=({x:n,y:t},e,r,i,s,o,a,h)=>{n*=e,t*=r;const c=i*n-s*t,l=s*n+i*t;return h.x=c+o,h.y=l+a,h};function G1(n,t){const e=t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),r=t===1.5707963267948966?.551915024494:e,i=Math.cos(n),s=Math.sin(n),o=Math.cos(n+t),a=Math.sin(n+t);return[{x:i-s*r,y:s+i*r},{x:o+a*r,y:a-o*r},{x:o,y:a}]}const ba=(n,t,e,r)=>{const i=n*r-t*e<0?-1:1;let s=n*e+t*r;return s>1&&(s=1),s<-1&&(s=-1),i*Math.acos(s)},O1=(n,t,e,r,i,s,o,a,h,c,l,u,d)=>{const f=Math.pow(i,2),p=Math.pow(s,2),g=Math.pow(l,2),m=Math.pow(u,2);let y=f*p-f*m-p*g;y<0&&(y=0),y/=f*m+p*g,y=Math.sqrt(y)*(o===a?-1:1);const x=y*i/s*u,_=y*-s/i*l,b=c*x-h*_+(n+e)/2,M=h*x+c*_+(t+r)/2,C=(l-x)/i,A=(u-_)/s,E=(-l-x)/i,I=(-u-_)/s,T=ba(1,0,C,A);let P=ba(C,A,E,I);a===0&&P>0&&(P-=ln),a===1&&P<0&&(P+=ln),d.centerX=b,d.centerY=M,d.ang1=T,d.ang2=P};function z1(n,t,e,r,i,s,o,a=0,h=0,c=0){if(s===0||o===0)return;const l=Math.sin(a*ln/360),u=Math.cos(a*ln/360),d=u*(t-r)/2+l*(e-i)/2,f=-l*(t-r)/2+u*(e-i)/2;if(d===0&&f===0)return;s=Math.abs(s),o=Math.abs(o);const p=Math.pow(d,2)/Math.pow(s,2)+Math.pow(f,2)/Math.pow(o,2);p>1&&(s*=Math.sqrt(p),o*=Math.sqrt(p)),O1(t,e,r,i,s,o,h,c,l,u,d,f,ui);let{ang1:g,ang2:m}=ui;const{centerX:y,centerY:x}=ui;let _=Math.abs(m)/(ln/4);Math.abs(1-_)<1e-7&&(_=1);const b=Math.max(Math.ceil(_),1);m/=b;let M=n[n.length-2],C=n[n.length-1];const A={x:0,y:0};for(let E=0;E<b;E++){const I=G1(g,m),{x:T,y:P}=di(I[0],s,o,u,l,y,x,A),{x:G,y:O}=di(I[1],s,o,u,l,y,x,A),{x:v,y:R}=di(I[2],s,o,u,l,y,x,A);Ic(n,M,C,T,P,G,O,v,R),M=v,C=R,g+=m}}function N1(n,t,e){const r=(o,a)=>{const h=a.x-o.x,c=a.y-o.y,l=Math.sqrt(h*h+c*c),u=h/l,d=c/l;return{len:l,nx:u,ny:d}},i=(o,a)=>{o===0?n.moveTo(a.x,a.y):n.lineTo(a.x,a.y)};let s=t[t.length-1];for(let o=0;o<t.length;o++){const a=t[o%t.length],h=a.radius??e;if(h<=0){i(o,a),s=a;continue}const c=t[(o+1)%t.length],l=r(a,s),u=r(a,c);if(l.len<1e-4||u.len<1e-4){i(o,a),s=a;continue}let d=Math.asin(l.nx*u.ny-l.ny*u.nx),f=1,p=!1;l.nx*u.nx-l.ny*-u.ny<0?d<0?d=Math.PI+d:(d=Math.PI-d,f=-1,p=!0):d>0&&(f=-1,p=!0);const g=d/2;let m,y=Math.abs(Math.cos(g)*h/Math.sin(g));y>Math.min(l.len/2,u.len/2)?(y=Math.min(l.len/2,u.len/2),m=Math.abs(y*Math.sin(g)/Math.cos(g))):m=h;const x=a.x+u.nx*y+-u.ny*m*f,_=a.y+u.ny*y+u.nx*m*f,b=Math.atan2(l.ny,l.nx)+Math.PI/2*f,M=Math.atan2(u.ny,u.nx)-Math.PI/2*f;o===0&&n.moveTo(x+Math.cos(b)*m,_+Math.sin(b)*m),n.arc(x,_,m,b,M,p),s=a}}function U1(n,t,e,r){const i=(a,h)=>Math.sqrt((a.x-h.x)**2+(a.y-h.y)**2),s=(a,h,c)=>({x:a.x+(h.x-a.x)*c,y:a.y+(h.y-a.y)*c}),o=t.length;for(let a=0;a<o;a++){const h=t[(a+1)%o],c=h.radius??e;if(c<=0){a===0?n.moveTo(h.x,h.y):n.lineTo(h.x,h.y);continue}const l=t[a],u=t[(a+2)%o],d=i(l,h);let f;if(d<1e-4)f=h;else{const m=Math.min(d/2,c);f=s(h,l,m/d)}const p=i(u,h);let g;if(p<1e-4)g=h;else{const m=Math.min(p/2,c);g=s(h,u,m/p)}a===0?n.moveTo(f.x,f.y):n.lineTo(f.x,f.y),n.quadraticCurveTo(h.x,h.y,g.x,g.y,r)}}const $1=new Y;class H1{constructor(t){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new Mt,this._graphicsPath2D=t,this.signed=t.checkForHoles}moveTo(t,e){return this.startPoly(t,e),this}lineTo(t,e){this._ensurePoly();const r=this._currentPoly.points,i=r[r.length-2],s=r[r.length-1];return(i!==t||s!==e)&&r.push(t,e),this}arc(t,e,r,i,s,o){this._ensurePoly(!1);const a=this._currentPoly.points;return Rc(a,t,e,r,i,s,o),this}arcTo(t,e,r,i,s){this._ensurePoly();const o=this._currentPoly.points;return D1(o,t,e,r,i,s),this}arcToSvg(t,e,r,i,s,o,a){const h=this._currentPoly.points;return z1(h,this._currentPoly.lastX,this._currentPoly.lastY,o,a,t,e,r,i,s),this}bezierCurveTo(t,e,r,i,s,o,a){this._ensurePoly();const h=this._currentPoly;return Ic(this._currentPoly.points,h.lastX,h.lastY,t,e,r,i,s,o,a),this}quadraticCurveTo(t,e,r,i,s){this._ensurePoly();const o=this._currentPoly;return B1(this._currentPoly.points,o.lastX,o.lastY,t,e,r,i,s),this}closePath(){return this.endPoly(!0),this}addPath(t,e){this.endPoly(),e&&!e.isIdentity()&&(t=t.clone(!0),t.transform(e));const r=this.shapePrimitives,i=r.length;for(let s=0;s<t.instructions.length;s++){const o=t.instructions[s];this[o.action](...o.data)}if(t.checkForHoles&&r.length-i>1){let s=null;for(let o=i;o<r.length;o++){const a=r[o];if(a.shape.type==="polygon"){const h=a.shape,c=s==null?void 0:s.shape;c&&c.containsPolygon(h)?(s.holes||(s.holes=[]),s.holes.push(a),r.copyWithin(o,o+1),r.length--,o--):s=a}}}return this}finish(t=!1){this.endPoly(t)}rect(t,e,r,i,s){return this.drawShape(new Y(t,e,r,i),s),this}circle(t,e,r,i){return this.drawShape(new Cs(t,e,r),i),this}poly(t,e,r){const i=new hn(t);return i.closePath=e,this.drawShape(i,r),this}regularPoly(t,e,r,i,s=0,o){i=Math.max(i|0,3);const a=-1*Math.PI/2+s,h=Math.PI*2/i,c=[];for(let l=0;l<i;l++){const u=a-l*h;c.push(t+r*Math.cos(u),e+r*Math.sin(u))}return this.poly(c,!0,o),this}roundPoly(t,e,r,i,s,o=0,a){if(i=Math.max(i|0,3),s<=0)return this.regularPoly(t,e,r,i,o);const h=r*Math.sin(Math.PI/i)-.001;s=Math.min(s,h);const c=-1*Math.PI/2+o,l=Math.PI*2/i,u=(i-2)*Math.PI/i/2;for(let d=0;d<i;d++){const f=d*l+c,p=t+r*Math.cos(f),g=e+r*Math.sin(f),m=f+Math.PI+u,y=f-Math.PI-u,x=p+s*Math.cos(m),_=g+s*Math.sin(m),b=p+s*Math.cos(y),M=g+s*Math.sin(y);d===0?this.moveTo(x,_):this.lineTo(x,_),this.quadraticCurveTo(p,g,b,M,a)}return this.closePath()}roundShape(t,e,r=!1,i){return t.length<3?this:(r?U1(this,t,e,i):N1(this,t,e),this.closePath())}filletRect(t,e,r,i,s){if(s===0)return this.rect(t,e,r,i);const o=Math.min(r,i)/2,a=Math.min(o,Math.max(-o,s)),h=t+r,c=e+i,l=a<0?-a:0,u=Math.abs(a);return this.moveTo(t,e+u).arcTo(t+l,e+l,t+u,e,u).lineTo(h-u,e).arcTo(h-l,e+l,h,e+u,u).lineTo(h,c-u).arcTo(h-l,c-l,t+r-u,c,u).lineTo(t+u,c).arcTo(t+l,c-l,t,c-u,u).closePath()}chamferRect(t,e,r,i,s,o){if(s<=0)return this.rect(t,e,r,i);const a=Math.min(s,Math.min(r,i)/2),h=t+r,c=e+i,l=[t+a,e,h-a,e,h,e+a,h,c-a,h-a,c,t+a,c,t,c-a,t,e+a];for(let u=l.length-1;u>=2;u-=2)l[u]===l[u-2]&&l[u-1]===l[u-3]&&l.splice(u-1,2);return this.poly(l,!0,o)}ellipse(t,e,r,i,s){return this.drawShape(new Ms(t,e,r,i),s),this}roundRect(t,e,r,i,s,o){return this.drawShape(new Ss(t,e,r,i,s),o),this}drawShape(t,e){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:e}),this}startPoly(t,e){let r=this._currentPoly;return r&&this.endPoly(),r=new hn,r.points.push(t,e),this._currentPoly=r,this}endPoly(t=!1){const e=this._currentPoly;return e&&e.points.length>2&&(e.closePath=t,this.shapePrimitives.push({shape:e})),this._currentPoly=null,this}_ensurePoly(t=!0){if(!this._currentPoly&&(this._currentPoly=new hn,t)){const e=this.shapePrimitives[this.shapePrimitives.length-1];if(e){let r=e.shape.x,i=e.shape.y;if(e.transform&&!e.transform.isIdentity()){const s=e.transform,o=r;r=s.a*r+s.c*i+s.tx,i=s.b*o+s.d*i+s.ty}this._currentPoly.points.push(r,i)}else this._currentPoly.points.push(0,0)}}buildPath(){const t=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let e=0;e<t.instructions.length;e++){const r=t.instructions[e];this[r.action](...r.data)}this.finish()}get bounds(){const t=this._bounds;t.clear();const e=this.shapePrimitives;for(let r=0;r<e.length;r++){const i=e[r],s=i.shape.getBounds($1);i.transform?t.addRect(s,i.transform):t.addRect(s)}return t}}class zt{constructor(t,e=!1){this.instructions=[],this.uid=Z("graphicsPath"),this._dirty=!0,this.checkForHoles=e,typeof t=="string"?dm(t,this):this.instructions=(t==null?void 0:t.slice())??[]}get shapePath(){return this._shapePath||(this._shapePath=new H1(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(t,e){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,e]}),this._dirty=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this._dirty=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this._dirty=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this._dirty=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this._dirty=!0,this}bezierCurveToShort(t,e,r,i,s){const o=this.instructions[this.instructions.length-1],a=this.getLastPoint(V.shared);let h=0,c=0;if(!o||o.action!=="bezierCurveTo")h=a.x,c=a.y;else{h=o.data[2],c=o.data[3];const l=a.x,u=a.y;h=l+(l-h),c=u+(u-c)}return this.instructions.push({action:"bezierCurveTo",data:[h,c,t,e,r,i,s]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this._dirty=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this._dirty=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this._dirty=!0,this}quadraticCurveToShort(t,e,r){const i=this.instructions[this.instructions.length-1],s=this.getLastPoint(V.shared);let o=0,a=0;if(!i||i.action!=="quadraticCurveTo")o=s.x,a=s.y;else{o=i.data[0],a=i.data[1];const h=s.x,c=s.y;o=h+(h-o),a=c+(c-a)}return this.instructions.push({action:"quadraticCurveTo",data:[o,a,t,e,r]}),this._dirty=!0,this}rect(t,e,r,i,s){return this.instructions.push({action:"rect",data:[t,e,r,i,s]}),this._dirty=!0,this}circle(t,e,r,i){return this.instructions.push({action:"circle",data:[t,e,r,i]}),this._dirty=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this._dirty=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this._dirty=!0,this}regularPoly(...t){return this.instructions.push({action:"regularPoly",data:t}),this._dirty=!0,this}roundPoly(...t){return this.instructions.push({action:"roundPoly",data:t}),this._dirty=!0,this}roundShape(...t){return this.instructions.push({action:"roundShape",data:t}),this._dirty=!0,this}filletRect(...t){return this.instructions.push({action:"filletRect",data:t}),this._dirty=!0,this}chamferRect(...t){return this.instructions.push({action:"chamferRect",data:t}),this._dirty=!0,this}star(t,e,r,i,s,o,a){s||(s=i/2);const h=-1*Math.PI/2+o,c=r*2,l=Math.PI*2/c,u=[];for(let d=0;d<c;d++){const f=d%2?s:i,p=d*l+h;u.push(t+f*Math.cos(p),e+f*Math.sin(p))}return this.poly(u,!0,a),this}clone(t=!1){const e=new zt;if(e.checkForHoles=this.checkForHoles,!t)e.instructions=this.instructions.slice();else for(let r=0;r<this.instructions.length;r++){const i=this.instructions[r];e.instructions.push({action:i.action,data:i.data.slice()})}return e}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(t){if(t.isIdentity())return this;const e=t.a,r=t.b,i=t.c,s=t.d,o=t.tx,a=t.ty;let h=0,c=0,l=0,u=0,d=0,f=0,p=0,g=0;for(let m=0;m<this.instructions.length;m++){const y=this.instructions[m],x=y.data;switch(y.action){case"moveTo":case"lineTo":h=x[0],c=x[1],x[0]=e*h+i*c+o,x[1]=r*h+s*c+a;break;case"bezierCurveTo":l=x[0],u=x[1],d=x[2],f=x[3],h=x[4],c=x[5],x[0]=e*l+i*u+o,x[1]=r*l+s*u+a,x[2]=e*d+i*f+o,x[3]=r*d+s*f+a,x[4]=e*h+i*c+o,x[5]=r*h+s*c+a;break;case"quadraticCurveTo":l=x[0],u=x[1],h=x[2],c=x[3],x[0]=e*l+i*u+o,x[1]=r*l+s*u+a,x[2]=e*h+i*c+o,x[3]=r*h+s*c+a;break;case"arcToSvg":h=x[5],c=x[6],p=x[0],g=x[1],x[0]=e*p+i*g,x[1]=r*p+s*g,x[5]=e*h+i*c+o,x[6]=r*h+s*c+a;break;case"circle":x[4]=je(x[3],t);break;case"rect":x[4]=je(x[4],t);break;case"ellipse":x[8]=je(x[8],t);break;case"roundRect":x[5]=je(x[5],t);break;case"addPath":x[0].transform(t);break;case"poly":x[2]=je(x[2],t);break;default:j("unknown transform action",y.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(t){let e=this.instructions.length-1,r=this.instructions[e];if(!r)return t.x=0,t.y=0,t;for(;r.action==="closePath";){if(e--,e<0)return t.x=0,t.y=0,t;r=this.instructions[e]}switch(r.action){case"moveTo":case"lineTo":t.x=r.data[0],t.y=r.data[1];break;case"quadraticCurveTo":t.x=r.data[2],t.y=r.data[3];break;case"bezierCurveTo":t.x=r.data[4],t.y=r.data[5];break;case"arc":case"arcToSvg":t.x=r.data[5],t.y=r.data[6];break;case"addPath":r.data[0].getLastPoint(t);break}return t}}function je(n,t){return n?n.prepend(t):t.clone()}function q(n,t,e){const r=n.getAttribute(t);return r?Number(r):e}function V1(n,t){const e=n.querySelectorAll("defs");for(let r=0;r<e.length;r++){const i=e[r];for(let s=0;s<i.children.length;s++){const o=i.children[s];switch(o.nodeName.toLowerCase()){case"lineargradient":t.defs[o.id]=W1(o);break;case"radialgradient":t.defs[o.id]=X1();break}}}}function W1(n){const t=q(n,"x1",0),e=q(n,"y1",0),r=q(n,"x2",1),i=q(n,"y2",0),s=n.getAttribute("gradientUnits")||"objectBoundingBox",o=new wn(t,e,r,i,s==="objectBoundingBox"?"local":"global");for(let a=0;a<n.children.length;a++){const h=n.children[a],c=q(h,"offset",0),l=_t.shared.setValue(h.getAttribute("stop-color")).toNumber();o.addColorStop(c,l)}return o}function X1(n){return j("[SVG Parser] Radial gradients are not yet supported"),new wn(0,0,1,0)}function va(n){const t=n.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return t?t[1]:""}const wa={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function Fc(n,t){const e=n.getAttribute("style"),r={},i={},s={strokeStyle:r,fillStyle:i,useFill:!1,useStroke:!1};for(const o in wa){const a=n.getAttribute(o);a&&Aa(t,s,o,a.trim())}if(e){const o=e.split(";");for(let a=0;a<o.length;a++){const h=o[a].trim(),[c,l]=h.split(":");wa[c]&&Aa(t,s,c,l.trim())}}return{strokeStyle:s.useStroke?r:null,fillStyle:s.useFill?i:null,useFill:s.useFill,useStroke:s.useStroke}}function Aa(n,t,e,r){switch(e){case"stroke":if(r!=="none"){if(r.startsWith("url(")){const i=va(r);t.strokeStyle.fill=n.defs[i]}else t.strokeStyle.color=_t.shared.setValue(r).toNumber();t.useStroke=!0}break;case"stroke-width":t.strokeStyle.width=Number(r);break;case"fill":if(r!=="none"){if(r.startsWith("url(")){const i=va(r);t.fillStyle.fill=n.defs[i]}else t.fillStyle.color=_t.shared.setValue(r).toNumber();t.useFill=!0}break;case"fill-opacity":t.fillStyle.alpha=Number(r);break;case"stroke-opacity":t.strokeStyle.alpha=Number(r);break;case"opacity":t.fillStyle.alpha=Number(r),t.strokeStyle.alpha=Number(r);break}}function Y1(n){if(n.length<=2)return!0;const t=n.map(a=>a.area).sort((a,h)=>h-a),[e,r]=t,i=t[t.length-1],s=e/r,o=r/i;return!(s>3&&o<2)}function q1(n){return n.split(/(?=[Mm])/).filter(r=>r.trim().length>0)}function j1(n){const t=n.match(/[-+]?[0-9]*\.?[0-9]+/g);if(!t||t.length<4)return 0;const e=t.map(Number),r=[],i=[];for(let l=0;l<e.length;l+=2)l+1<e.length&&(r.push(e[l]),i.push(e[l+1]));if(r.length===0||i.length===0)return 0;const s=Math.min(...r),o=Math.max(...r),a=Math.min(...i),h=Math.max(...i);return(o-s)*(h-a)}function Ca(n,t){const e=new zt(n,!1);for(const r of e.instructions)t.instructions.push(r)}function Z1(n,t){if(typeof n=="string"){const o=document.createElement("div");o.innerHTML=n.trim(),n=o.querySelector("svg")}const e={context:t,defs:{},path:new zt};V1(n,e);const r=n.children,{fillStyle:i,strokeStyle:s}=Fc(n,e);for(let o=0;o<r.length;o++){const a=r[o];a.nodeName.toLowerCase()!=="defs"&&Bc(a,e,i,s)}return t}function Bc(n,t,e,r){const i=n.children,{fillStyle:s,strokeStyle:o}=Fc(n,t);s&&e?e={...e,...s}:s&&(e=s),o&&r?r={...r,...o}:o&&(r=o);const a=!e&&!r;a&&(e={color:0});let h,c,l,u,d,f,p,g,m,y,x,_,b,M,C,A,E;switch(n.nodeName.toLowerCase()){case"path":{M=n.getAttribute("d");const I=n.getAttribute("fill-rule"),T=q1(M),P=I==="evenodd",G=T.length>1;if(P&&G){const v=T.map(w=>({path:w,area:j1(w)}));if(v.sort((w,S)=>S.area-w.area),T.length>3||!Y1(v))for(let w=0;w<v.length;w++){const S=v[w],B=w===0;t.context.beginPath();const k=new zt(void 0,!0);Ca(S.path,k),t.context.path(k),B?(e&&t.context.fill(e),r&&t.context.stroke(r)):t.context.cut()}else for(let w=0;w<v.length;w++){const S=v[w],B=w%2===1;t.context.beginPath();const k=new zt(void 0,!0);Ca(S.path,k),t.context.path(k),B?t.context.cut():(e&&t.context.fill(e),r&&t.context.stroke(r))}}else{const v=I?I==="evenodd":!0;C=new zt(M,v),t.context.path(C),e&&t.context.fill(e),r&&t.context.stroke(r)}break}case"circle":p=q(n,"cx",0),g=q(n,"cy",0),m=q(n,"r",0),t.context.ellipse(p,g,m,m),e&&t.context.fill(e),r&&t.context.stroke(r);break;case"rect":h=q(n,"x",0),c=q(n,"y",0),A=q(n,"width",0),E=q(n,"height",0),y=q(n,"rx",0),x=q(n,"ry",0),y||x?t.context.roundRect(h,c,A,E,y||x):t.context.rect(h,c,A,E),e&&t.context.fill(e),r&&t.context.stroke(r);break;case"ellipse":p=q(n,"cx",0),g=q(n,"cy",0),y=q(n,"rx",0),x=q(n,"ry",0),t.context.beginPath(),t.context.ellipse(p,g,y,x),e&&t.context.fill(e),r&&t.context.stroke(r);break;case"line":l=q(n,"x1",0),u=q(n,"y1",0),d=q(n,"x2",0),f=q(n,"y2",0),t.context.beginPath(),t.context.moveTo(l,u),t.context.lineTo(d,f),r&&t.context.stroke(r);break;case"polygon":b=n.getAttribute("points"),_=b.match(/-?\d+/g).map(I=>parseInt(I,10)),t.context.poly(_,!0),e&&t.context.fill(e),r&&t.context.stroke(r);break;case"polyline":b=n.getAttribute("points"),_=b.match(/-?\d+/g).map(I=>parseInt(I,10)),t.context.poly(_,!1),r&&t.context.stroke(r);break;case"g":case"svg":break;default:{j(`[SVG parser] <${n.nodeName}> elements unsupported`);break}}a&&(e=null);for(let I=0;I<i.length;I++)Bc(i[I],t,e,r)}const Ma={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class K1{constructor(t,e){this.uid=Z("fillPattern"),this._tick=0,this.transform=new z,this.texture=t,this.transform.scale(1/t.frame.width,1/t.frame.height),e&&(t.source.style.addressModeU=Ma[e].addressModeU,t.source.style.addressModeV=Ma[e].addressModeV)}setTransform(t){const e=this.texture;this.transform.copyFrom(t),this.transform.invert(),this.transform.scale(1/e.frame.width,1/e.frame.height),this._tick++}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture=t,this._tick++)}get styleKey(){return`fill-pattern-${this.uid}-${this._tick}`}destroy(){this.texture.destroy(!0),this.texture=null}}function Q1(n){return _t.isColorLike(n)}function Sa(n){return n instanceof K1}function Pa(n){return n instanceof wn}function J1(n){return n instanceof D}function ty(n,t,e){const r=_t.shared.setValue(t??0);return n.color=r.toNumber(),n.alpha=r.alpha===1?e.alpha:r.alpha,n.texture=D.WHITE,{...e,...n}}function ey(n,t,e){return n.texture=t,{...e,...n}}function Ta(n,t,e){return n.fill=t,n.color=16777215,n.texture=t.texture,n.matrix=t.transform,{...e,...n}}function ka(n,t,e){return t.buildGradient(),n.fill=t,n.color=16777215,n.texture=t.texture,n.matrix=t.transform,n.textureSpace=t.textureSpace,{...e,...n}}function ny(n,t){const e={...t,...n},r=_t.shared.setValue(e.color);return e.alpha*=r.alpha,e.color=r.toNumber(),e}function nn(n,t){if(n==null)return null;const e={},r=n;return Q1(n)?ty(e,n,t):J1(n)?ey(e,n,t):Sa(n)?Ta(e,n,t):Pa(n)?ka(e,n,t):r.fill&&Sa(r.fill)?Ta(r,r.fill,t):r.fill&&Pa(r.fill)?ka(r,r.fill,t):ny(r,t)}function Ea(n,t){const{width:e,alignment:r,miterLimit:i,cap:s,join:o,pixelLine:a,...h}=t,c=nn(n,h);return c?{width:e,alignment:r,miterLimit:i,cap:s,join:o,pixelLine:a,...c}:null}const ry=new V,Ia=new z,Rs=class kt extends Ut{constructor(){super(...arguments),this._gpuData=Object.create(null),this.autoGarbageCollect=!0,this._gcLastUsed=-1,this.uid=Z("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this.destroyed=!1,this._activePath=new zt,this._transform=new z,this._fillStyle={...kt.defaultFillStyle},this._strokeStyle={...kt.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new Mt,this._boundsDirty=!0}clone(){const t=new kt;return t.batchMode=this.batchMode,t.instructions=this.instructions.slice(),t._activePath=this._activePath.clone(),t._transform=this._transform.clone(),t._fillStyle={...this._fillStyle},t._strokeStyle={...this._strokeStyle},t._stateStack=this._stateStack.slice(),t._bounds=this._bounds.clone(),t._boundsDirty=!0,t}get fillStyle(){return this._fillStyle}set fillStyle(t){this._fillStyle=nn(t,kt.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(t){this._strokeStyle=Ea(t,kt.defaultStrokeStyle)}setFillStyle(t){return this._fillStyle=nn(t,kt.defaultFillStyle),this}setStrokeStyle(t){return this._strokeStyle=nn(t,kt.defaultStrokeStyle),this}texture(t,e,r,i,s,o){return this.instructions.push({action:"texture",data:{image:t,dx:r||0,dy:i||0,dw:s||t.frame.width,dh:o||t.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:e||e===0?_t.shared.setValue(e).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new zt,this}fill(t,e){let r;const i=this.instructions[this.instructions.length-1];return this._tick===0&&(i==null?void 0:i.action)==="stroke"?r=i.data.path:r=this._activePath.clone(),r?(t!=null&&(e!==void 0&&typeof t=="number"&&(U(W,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),t={color:t,alpha:e}),this._fillStyle=nn(t,kt.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:r}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:t,y:e}=this._activePath.getLastPoint(V.shared);this._activePath.clear(),this._activePath.moveTo(t,e)}stroke(t){let e;const r=this.instructions[this.instructions.length-1];return this._tick===0&&(r==null?void 0:r.action)==="fill"?e=r.data.path:e=this._activePath.clone(),e?(t!=null&&(this._strokeStyle=Ea(t,kt.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:e}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let t=0;t<2;t++){const e=this.instructions[this.instructions.length-1-t],r=this._activePath.clone();if(e&&(e.action==="stroke"||e.action==="fill"))if(e.data.hole)e.data.hole.addPath(r);else{e.data.hole=r;break}}return this._initNextPathLocation(),this}arc(t,e,r,i,s,o){this._tick++;const a=this._transform;return this._activePath.arc(a.a*t+a.c*e+a.tx,a.b*t+a.d*e+a.ty,r,i,s,o),this}arcTo(t,e,r,i,s){this._tick++;const o=this._transform;return this._activePath.arcTo(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,o.a*r+o.c*i+o.tx,o.b*r+o.d*i+o.ty,s),this}arcToSvg(t,e,r,i,s,o,a){this._tick++;const h=this._transform;return this._activePath.arcToSvg(t,e,r,i,s,h.a*o+h.c*a+h.tx,h.b*o+h.d*a+h.ty),this}bezierCurveTo(t,e,r,i,s,o,a){this._tick++;const h=this._transform;return this._activePath.bezierCurveTo(h.a*t+h.c*e+h.tx,h.b*t+h.d*e+h.ty,h.a*r+h.c*i+h.tx,h.b*r+h.d*i+h.ty,h.a*s+h.c*o+h.tx,h.b*s+h.d*o+h.ty,a),this}closePath(){var t;return this._tick++,(t=this._activePath)==null||t.closePath(),this}ellipse(t,e,r,i){return this._tick++,this._activePath.ellipse(t,e,r,i,this._transform.clone()),this}circle(t,e,r){return this._tick++,this._activePath.circle(t,e,r,this._transform.clone()),this}path(t){return this._tick++,this._activePath.addPath(t,this._transform.clone()),this}lineTo(t,e){this._tick++;const r=this._transform;return this._activePath.lineTo(r.a*t+r.c*e+r.tx,r.b*t+r.d*e+r.ty),this}moveTo(t,e){this._tick++;const r=this._transform,i=this._activePath.instructions,s=r.a*t+r.c*e+r.tx,o=r.b*t+r.d*e+r.ty;return i.length===1&&i[0].action==="moveTo"?(i[0].data[0]=s,i[0].data[1]=o,this):(this._activePath.moveTo(s,o),this)}quadraticCurveTo(t,e,r,i,s){this._tick++;const o=this._transform;return this._activePath.quadraticCurveTo(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,o.a*r+o.c*i+o.tx,o.b*r+o.d*i+o.ty,s),this}rect(t,e,r,i){return this._tick++,this._activePath.rect(t,e,r,i,this._transform.clone()),this}roundRect(t,e,r,i,s){return this._tick++,this._activePath.roundRect(t,e,r,i,s,this._transform.clone()),this}poly(t,e){return this._tick++,this._activePath.poly(t,e,this._transform.clone()),this}regularPoly(t,e,r,i,s=0,o){return this._tick++,this._activePath.regularPoly(t,e,r,i,s,o),this}roundPoly(t,e,r,i,s,o){return this._tick++,this._activePath.roundPoly(t,e,r,i,s,o),this}roundShape(t,e,r,i){return this._tick++,this._activePath.roundShape(t,e,r,i),this}filletRect(t,e,r,i,s){return this._tick++,this._activePath.filletRect(t,e,r,i,s),this}chamferRect(t,e,r,i,s,o){return this._tick++,this._activePath.chamferRect(t,e,r,i,s,o),this}star(t,e,r,i,s=0,o=0){return this._tick++,this._activePath.star(t,e,r,i,s,o,this._transform.clone()),this}svg(t){return this._tick++,Z1(t,this),this}restore(){const t=this._stateStack.pop();return t&&(this._transform=t.transform,this._fillStyle=t.fillStyle,this._strokeStyle=t.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(t){return this._transform.rotate(t),this}scale(t,e=t){return this._transform.scale(t,e),this}setTransform(t,e,r,i,s,o){return t instanceof z?(this._transform.set(t.a,t.b,t.c,t.d,t.tx,t.ty),this):(this._transform.set(t,e,r,i,s,o),this)}transform(t,e,r,i,s,o){return t instanceof z?(this._transform.append(t),this):(Ia.set(t,e,r,i,s,o),this._transform.append(Ia),this)}translate(t,e=t){return this._transform.translate(t,e),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this._boundsDirty=!0,!this.dirty&&(this.emit("update",this,16),this.dirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;this._boundsDirty=!1;const t=this._bounds;t.clear();for(let e=0;e<this.instructions.length;e++){const r=this.instructions[e],i=r.action;if(i==="fill"){const s=r.data;t.addBounds(s.path.bounds)}else if(i==="texture"){const s=r.data;t.addFrame(s.dx,s.dy,s.dx+s.dw,s.dy+s.dh,s.transform)}if(i==="stroke"){const s=r.data,o=s.style.alignment,a=s.style.width*(1-o),h=s.path.bounds;t.addFrame(h.minX-a,h.minY-a,h.maxX+a,h.maxY+a)}}return t}containsPoint(t){var i;if(!this.bounds.containsPoint(t.x,t.y))return!1;const e=this.instructions;let r=!1;for(let s=0;s<e.length;s++){const o=e[s],a=o.data,h=a.path;if(!o.action||!h)continue;const c=a.style,l=h.shapePath.shapePrimitives;for(let u=0;u<l.length;u++){const d=l[u].shape;if(!c||!d)continue;const f=l[u].transform,p=f?f.applyInverse(t,ry):t;if(o.action==="fill")r=d.contains(p.x,p.y);else{const m=c;r=d.strokeContains(p.x,p.y,m.width,m.alignment)}const g=a.hole;if(g){const m=(i=g.shapePath)==null?void 0:i.shapePrimitives;if(m)for(let y=0;y<m.length;y++)m[y].shape.contains(p.x,p.y)&&(r=!1)}if(r)return!0}}return r}unload(){var t;this.emit("unload",this);for(const e in this._gpuData)(t=this._gpuData[e])==null||t.destroy();this._gpuData=Object.create(null)}destroy(t=!1){if(this.destroyed)return;if(this.destroyed=!0,this._stateStack.length=0,this._transform=null,this.unload(),this.emit("destroy",this),this.removeAllListeners(),typeof t=="boolean"?t:t==null?void 0:t.texture){const r=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._fillStyle.texture&&(this._fillStyle.fill&&"uid"in this._fillStyle.fill?this._fillStyle.fill.destroy():this._fillStyle.texture.destroy(r)),this._strokeStyle.texture&&(this._strokeStyle.fill&&"uid"in this._strokeStyle.fill?this._strokeStyle.fill.destroy():this._strokeStyle.texture.destroy(r))}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};Rs.defaultFillStyle={color:16777215,alpha:1,texture:D.WHITE,matrix:null,fill:null,textureSpace:"local"};Rs.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:D.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let _e=Rs;function Fs(n,t=1){var r;const e=(r=Le.RETINA_PREFIX)==null?void 0:r.exec(n);return e?parseFloat(e[1]):t}function Bs(n,t,e){n.label=e,n._sourceOrigin=e;const r=new D({source:n,label:e}),i=()=>{delete t.promiseCache[e],nt.has(e)&&nt.remove(e)};return r.source.once("destroy",()=>{t.promiseCache[e]&&(j("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),i())}),r.once("destroy",()=>{n.destroyed||(j("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),i())}),r}const iy=".svg",sy="image/svg+xml",oy={extension:{type:F.LoadParser,priority:Qt.Low,name:"loadSVG"},name:"loadSVG",id:"svg",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(n){return De(n,sy)||Ge(n,iy)},async load(n,t,e){var r;return((r=t.data)==null?void 0:r.parseAsGraphicsContext)??this.config.parseAsGraphicsContext?hy(n):ay(n,t,e,this.config.crossOrigin)},unload(n){n.destroy(!0)}};async function ay(n,t,e,r){var m,y,x;const i=await K.get().fetch(n),s=K.get().createImage();s.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(await i.text())}`,s.crossOrigin=r,await s.decode();const o=((m=t.data)==null?void 0:m.width)??s.width,a=((y=t.data)==null?void 0:y.height)??s.height,h=((x=t.data)==null?void 0:x.resolution)||Fs(n),c=Math.ceil(o*h),l=Math.ceil(a*h),u=K.get().createCanvas(c,l),d=u.getContext("2d");d.imageSmoothingEnabled=!0,d.imageSmoothingQuality="high",d.drawImage(s,0,0,o*h,a*h);const{parseAsGraphicsContext:f,...p}=t.data??{},g=new Fe({resource:u,alphaMode:"premultiply-alpha-on-upload",resolution:h,...p});return Bs(g,e,n)}async function hy(n){const e=await(await K.get().fetch(n)).text(),r=new _e;return r.svg(e),r}const cy=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function") return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (_e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let Se=null,Qi=class{constructor(){Se||(Se=URL.createObjectURL(new Blob([cy],{type:"application/javascript"}))),this.worker=new Worker(Se)}};Qi.revokeObjectURL=function(){Se&&(URL.revokeObjectURL(Se),Se=null)};const ly=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let Pe=null;class Lc{constructor(){Pe||(Pe=URL.createObjectURL(new Blob([ly],{type:"application/javascript"}))),this.worker=new Worker(Pe)}}Lc.revokeObjectURL=function(){Pe&&(URL.revokeObjectURL(Pe),Pe=null)};let Ra=0,fi;class uy{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const{worker:e}=new Qi;e.addEventListener("message",r=>{e.terminate(),Qi.revokeObjectURL(),t(r.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t,e){var r;return this._run("loadImageBitmap",[t,(r=e==null?void 0:e.data)==null?void 0:r.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){fi===void 0&&(fi=navigator.hardwareConcurrency||4);let t=this._workerPool.pop();return!t&&this._createdWorkers<fi&&(this._createdWorkers++,t=new Lc().worker,t.addEventListener("message",e=>{this._complete(e.data),this._returnWorker(e.target),this._next()})),t}_returnWorker(t){this._workerPool.push(t)}_complete(t){this._resolveHash[t.uuid]&&(t.error!==void 0?this._resolveHash[t.uuid].reject(t.error):this._resolveHash[t.uuid].resolve(t.data),delete this._resolveHash[t.uuid])}async _run(t,e){await this._initWorkers();const r=new Promise((i,s)=>{this._queue.push({id:t,arguments:e,resolve:i,reject:s})});return this._next(),r}_next(){if(!this._queue.length)return;const t=this._getWorker();if(!t)return;const e=this._queue.pop(),r=e.id;this._resolveHash[Ra]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:Ra++,id:r})}reset(){this._workerPool.forEach(t=>t.terminate()),this._workerPool.length=0,Object.values(this._resolveHash).forEach(({reject:t})=>{t==null||t(new Error("WorkerManager has been reset before completion"))}),this._resolveHash={},this._queue.length=0,this._initialized=!1,this._createdWorkers=0}}const Fa=new uy,dy=[".jpeg",".jpg",".png",".webp",".avif"],fy=["image/jpeg","image/png","image/webp","image/avif"];async function py(n,t){var i;const e=await K.get().fetch(n);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${n}: ${e.status} ${e.statusText}`);const r=await e.blob();return((i=t==null?void 0:t.data)==null?void 0:i.alphaMode)==="premultiplied-alpha"?createImageBitmap(r,{premultiplyAlpha:"none"}):createImageBitmap(r)}const Dc={name:"loadTextures",id:"texture",extension:{type:F.LoadParser,priority:Qt.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(n){return De(n,fy)||Ge(n,dy)},async load(n,t,e){var s;let r=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await Fa.isImageBitmapSupported()?r=await Fa.loadImageBitmap(n,t):r=await py(n,t):r=await new Promise((o,a)=>{r=K.get().createImage(),r.crossOrigin=this.config.crossOrigin,r.src=n,r.complete?o(r):(r.onload=()=>{o(r)},r.onerror=a)});const i=new Fe({resource:r,alphaMode:"premultiply-alpha-on-upload",resolution:((s=t.data)==null?void 0:s.resolution)||Fs(n),...t.data});return Bs(i,e,n)},unload(n){n.destroy(!0)}},gy=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"];let pi,gi;function my(n,t,e){e===void 0&&!t.startsWith("data:")?n.crossOrigin=xy(t):e!==!1&&(n.crossOrigin=typeof e=="string"?e:"anonymous")}function yy(n){return new Promise((t,e)=>{n.addEventListener("canplaythrough",r),n.addEventListener("error",i),n.load();function r(){s(),t()}function i(o){s(),e(o)}function s(){n.removeEventListener("canplaythrough",r),n.removeEventListener("error",i)}})}function xy(n,t=globalThis.location){if(n.startsWith("data:"))return"";t||(t=globalThis.location);const e=new URL(n,document.baseURI);return e.hostname!==t.hostname||e.port!==t.port||e.protocol!==t.protocol?"anonymous":""}function _y(){const n=[],t=[];for(const e of gy){const r=on.MIME_TYPES[e.substring(1)]||`video/${e.substring(1)}`;Cr(r)&&(n.push(e),t.includes(r)||t.push(r))}return{validVideoExtensions:n,validVideoMime:t}}const by={name:"loadVideo",id:"video",extension:{type:F.LoadParser,name:"loadVideo"},test(n){if(!pi||!gi){const{validVideoExtensions:r,validVideoMime:i}=_y();pi=r,gi=i}const t=De(n,gi),e=Ge(n,pi);return t||e},async load(n,t,e){var h,c;const r={...on.defaultOptions,resolution:((h=t.data)==null?void 0:h.resolution)||Fs(n),alphaMode:((c=t.data)==null?void 0:c.alphaMode)||await Kh(),...t.data},i=document.createElement("video"),s={preload:r.autoLoad!==!1?"auto":void 0,"webkit-playsinline":r.playsinline!==!1?"":void 0,playsinline:r.playsinline!==!1?"":void 0,muted:r.muted===!0?"":void 0,loop:r.loop===!0?"":void 0,autoplay:r.autoPlay!==!1?"":void 0};Object.keys(s).forEach(l=>{const u=s[l];u!==void 0&&i.setAttribute(l,u)}),r.muted===!0&&(i.muted=!0),my(i,n,r.crossorigin);const o=document.createElement("source");let a;if(r.mime)a=r.mime;else if(n.startsWith("data:"))a=n.slice(5,n.indexOf(";"));else if(!n.startsWith("blob:")){const l=n.split("?")[0].slice(n.lastIndexOf(".")+1).toLowerCase();a=on.MIME_TYPES[l]||`video/${l}`}return o.src=n,a&&(o.type=a),new Promise((l,u)=>{r.preload&&!r.autoPlay&&i.load(),i.addEventListener("canplay",d),i.addEventListener("error",f),o.addEventListener("error",f),i.appendChild(o);async function d(){const g=new on({...r,resource:i});p(),t.data.preload&&await yy(i),l(Bs(g,e,n))}function f(g){p(),u(g)}function p(){i.removeEventListener("canplay",d),i.removeEventListener("error",f),o.removeEventListener("error",f)}})},unload(n){n.destroy(!0)}},Gc={extension:{type:F.ResolveParser,name:"resolveTexture"},test:Dc.test,parse:n=>{var t;return{resolution:parseFloat(((t=Le.RETINA_PREFIX.exec(n))==null?void 0:t[1])??"1"),format:n.split(".").pop(),src:n}}},vy={extension:{type:F.ResolveParser,priority:-2,name:"resolveJson"},test:n=>Le.RETINA_PREFIX.test(n)&&n.endsWith(".json"),parse:Gc.parse};class wy{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Le,this.loader=new qg,this.cache=nt,this._backgroundLoader=new zg(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var s,o;if(this._initialized){j("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let a=t.manifest;typeof a=="string"&&(a=await this.load(a)),this.resolver.addManifest(a)}const e=((s=t.texturePreference)==null?void 0:s.resolution)??1,r=typeof e=="number"?[e]:e,i=await this._detectFormats({preferredFormats:(o=t.texturePreference)==null?void 0:o.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:i,resolution:r}}),t.preferences&&this.setPreferences(t.preferences),t.loadOptions&&(this.loader.loadOptions={...this.loader.loadOptions,...t.loadOptions})}add(t){this.resolver.add(t)}async load(t,e){this._initialized||await this.init();const r=fr(t),i=Ct(t).map(a=>{if(typeof a!="string"){const h=this.resolver.getAlias(a);return h.some(c=>!this.resolver.hasKey(c))&&this.add(a),Array.isArray(h)?h[0]:h}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),s=this.resolver.resolve(i),o=await this._mapLoadToResolve(s,e);return r?o[i[0]]:o}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let r=!1;typeof t=="string"&&(r=!0,t=[t]);const i=this.resolver.resolveBundle(t),s={},o=Object.keys(i);let a=0;const h=[],c=()=>{e==null||e(h.reduce((u,d)=>u+d,0)/a)},l=o.map((u,d)=>{const f=i[u],p=Object.values(f),m=[...new Set(p.flat())].reduce((y,x)=>y+(x.progressSize||1),0);return h.push(0),a+=m,this._mapLoadToResolve(f,y=>{h[d]=y*m,c()}).then(y=>{s[u]=y})});return await Promise.all(l),r?s[t[0]]:s}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(r=>{this._backgroundLoader.add(Object.values(r))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return nt.get(t);const e={};for(let r=0;r<t.length;r++)e[r]=nt.get(t[r]);return e}async _mapLoadToResolve(t,e){const r=[...new Set(Object.values(t))];this._backgroundLoader.active=!1;const i=await this.loader.load(r,e);this._backgroundLoader.active=!0;const s={};return r.forEach(o=>{const a=i[o.src],h=[o.src];o.alias&&h.push(...o.alias),h.forEach(c=>{s[c]=a}),nt.set(h,a)}),s}async unload(t){this._initialized||await this.init();const e=Ct(t).map(i=>typeof i!="string"?i.src:i),r=this.resolver.resolve(e);await this._unloadFromResolved(r)}async unloadBundle(t){this._initialized||await this.init(),t=Ct(t);const e=this.resolver.resolveBundle(t),r=Object.keys(e).map(i=>this._unloadFromResolved(e[i]));await Promise.all(r)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(r=>{nt.remove(r.src)}),await this.loader.unload(e)}async _detectFormats(t){let e=[];t.preferredFormats&&(e=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const r of t.detections)t.skipDetections||await r.test()?e=await r.add(e):t.skipDetections||(e=await r.remove(e));return e=e.filter((r,i)=>e.indexOf(r)===i),e}get detections(){return this._detections}setPreferences(t){this.loader.parsers.forEach(e=>{e.config&&Object.keys(e.config).filter(r=>r in t).forEach(r=>{e.config[r]=t[r]})})}}const rn=new wy;tt.handleByList(F.LoadParser,rn.loader.parsers).handleByList(F.ResolveParser,rn.resolver.parsers).handleByList(F.CacheParser,rn.cache.parsers).handleByList(F.DetectionParser,rn.detections);tt.add(Ng,$g,Ug,Yg,Vg,Wg,Xg,Kg,tm,hm,oy,Dc,by,Og,Gg,Gc,vy);const Ba={loader:F.LoadParser,resolver:F.ResolveParser,cache:F.CacheParser,detection:F.DetectionParser};tt.handle(F.Asset,n=>{const t=n.ref;Object.entries(Ba).filter(([e])=>!!t[e]).forEach(([e,r])=>tt.add(Object.assign(t[e],{extension:t[e].extension??r})))},n=>{const t=n.ref;Object.keys(Ba).filter(e=>!!t[e]).forEach(e=>tt.remove(t[e]))});function La(n,t,e,r,i,s,o,a){const h=o-e,c=a-r,l=i-e,u=s-r,d=n-e,f=t-r,p=h*h+c*c,g=h*l+c*u,m=h*d+c*f,y=l*l+u*u,x=l*d+u*f,_=1/(p*y-g*g),b=(y*m-g*x)*_,M=(p*x-g*m)*_;return b>=0&&M>=0&&b+M<1}class Ay{constructor(){this.isBatchable=!1}reset(){this.isBatchable=!1,this.context=null,this.graphicsData&&(this.graphicsData.destroy(),this.graphicsData=null)}destroy(){this.reset()}}class Cy{constructor(){this.instructions=new xs}init(){this.instructions.reset()}destroy(){this.instructions.destroy(),this.instructions=null}}const Ls=class Ji{constructor(t){this._renderer=t,this._managedContexts=new Mr({renderer:t,type:"resource",name:"graphicsContext"})}init(t){Ji.defaultOptions.bezierSmoothness=(t==null?void 0:t.bezierSmoothness)??Ji.defaultOptions.bezierSmoothness}getContextRenderData(t){return this.getGpuContext(t).graphicsData||this._initContextRenderData(t)}updateGpuContext(t){const e=t._gpuData,r=!!e[this._renderer.uid],i=e[this._renderer.uid]||this._initContext(t);return(t.dirty||!r)&&(r&&i.reset(),i.isBatchable=!1,t.dirty=!1),i}getGpuContext(t){return t._gpuData[this._renderer.uid]||this._initContext(t)}_initContextRenderData(t){const e=new Cy,r=this.getGpuContext(t);return r.graphicsData=e,e.init(),e}_initContext(t){const e=new Ay;return e.context=t,t._gpuData[this._renderer.uid]=e,this._managedContexts.add(t),e}destroy(){this._managedContexts.destroy(),this._renderer=null}};Ls.extension={type:[F.CanvasSystem],name:"graphicsContext"};Ls.defaultOptions={bezierSmoothness:.5};let My=Ls;class Oc{constructor(t,e){this.state=As.for2d(),this.renderer=t,this._adaptor=e,this.renderer.runners.contextChange.add(this),this._managedGraphics=new Mr({renderer:t,type:"renderable",priority:-1,name:"graphics"})}contextChange(){this._adaptor.contextChange(this.renderer)}validateRenderable(t){return!1}addRenderable(t,e){this._managedGraphics.add(t),this.renderer.renderPipes.batch.break(e),e.add(t)}updateRenderable(t){}execute(t){t.isRenderable&&this._adaptor.execute(this,t)}destroy(){this._managedGraphics.destroy(),this.renderer=null,this._adaptor.destroy(),this._adaptor=null}}Oc.extension={type:[F.CanvasPipes],name:"graphics"};function zc(n,t,e){const r=(n>>24&255)/255;t[e++]=(n&255)/255*r,t[e++]=(n>>8&255)/255*r,t[e++]=(n>>16&255)/255*r,t[e++]=r}class Sy{constructor(){this.batches=[],this.batched=!1}destroy(){this.batches.forEach(t=>{ut.return(t)}),this.batches.length=0}}class Nc{constructor(t,e){this.state=As.for2d(),this.renderer=t,this._adaptor=e,this.renderer.runners.contextChange.add(this),this._managedGraphics=new Mr({renderer:t,type:"renderable",priority:-1,name:"graphics"})}contextChange(){this._adaptor.contextChange(this.renderer)}validateRenderable(t){const e=t.context,r=!!t._gpuData,s=this.renderer.graphicsContext.updateGpuContext(e);return!!(s.isBatchable||r!==s.isBatchable)}addRenderable(t,e){const i=this.renderer.graphicsContext.updateGpuContext(t.context);t.didViewUpdate&&this._rebuild(t),i.isBatchable?this._addToBatcher(t,e):(this.renderer.renderPipes.batch.break(e),e.add(t))}updateRenderable(t){const r=this._getGpuDataForRenderable(t).batches;for(let i=0;i<r.length;i++){const s=r[i];s._batcher.updateElement(s)}}execute(t){if(!t.isRenderable)return;const e=this.renderer,r=t.context;if(!e.graphicsContext.getGpuContext(r).batches.length)return;const s=r.customShader||this._adaptor.shader;this.state.blendMode=t.groupBlendMode;const o=s.resources.localUniforms.uniforms;o.uTransformMatrix=t.groupTransform,o.uRound=e._roundPixels|t._roundPixels,zc(t.groupColorAlpha,o.uColor,0),this._adaptor.execute(this,t)}_rebuild(t){const e=this._getGpuDataForRenderable(t),i=this.renderer.graphicsContext.updateGpuContext(t.context);e.destroy(),i.isBatchable&&this._updateBatchesForRenderable(t,e)}_addToBatcher(t,e){const r=this.renderer.renderPipes.batch,i=this._getGpuDataForRenderable(t).batches;for(let s=0;s<i.length;s++){const o=i[s];r.addToBatch(o,e)}}_getGpuDataForRenderable(t){return t._gpuData[this.renderer.uid]||this._initGpuDataForRenderable(t)}_initGpuDataForRenderable(t){const e=new Sy;return t._gpuData[this.renderer.uid]=e,this._managedGraphics.add(t),e}_updateBatchesForRenderable(t,e){const r=t.context,s=this.renderer.graphicsContext.getGpuContext(r),o=this.renderer._roundPixels|t._roundPixels;e.batches=s.batches.map(a=>{const h=ut.get(Ts);return a.copyTo(h),h.renderable=t,h.roundPixels=o,h})}destroy(){this._managedGraphics.destroy(),this.renderer=null,this._adaptor.destroy(),this._adaptor=null,this.state=null}}Nc.extension={type:[F.WebGLPipes,F.WebGPUPipes],name:"graphics"};tt.add(Oc);tt.add(Nc);tt.add(My);tt.add(Is);class Te extends _s{constructor(t){t instanceof _e&&(t={context:t});const{context:e,roundPixels:r,...i}=t||{};super({label:"Graphics",...i}),this.renderPipeId="graphics",e?this.context=e:(this.context=this._ownedContext=new _e,this.context.autoGarbageCollect=this.autoGarbageCollect),this.didViewUpdate=!0,this.allowChildren=!1,this.roundPixels=r??!1}set context(t){t!==this._context&&(this._context&&(this._context.off("update",this.onViewUpdate,this),this._context.off("unload",this.unload,this)),this._context=t,this._context.on("update",this.onViewUpdate,this),this._context.on("unload",this.unload,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}updateBounds(){}containsPoint(t){return this._context.containsPoint(t)}destroy(t){this._ownedContext&&!t?this._ownedContext.destroy(t):(t===!0||(t==null?void 0:t.context)===!0)&&this._context.destroy(t),this._ownedContext=null,this._context=null,super.destroy(t)}_onTouch(t){this._gcLastUsed=t,this._context._gcLastUsed=t}_callContextMethod(t,e){return this.context[t](...e),this}setFillStyle(...t){return this._callContextMethod("setFillStyle",t)}setStrokeStyle(...t){return this._callContextMethod("setStrokeStyle",t)}fill(...t){return this._callContextMethod("fill",t)}stroke(...t){return this._callContextMethod("stroke",t)}texture(...t){return this._callContextMethod("texture",t)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...t){return this._callContextMethod("arc",t)}arcTo(...t){return this._callContextMethod("arcTo",t)}arcToSvg(...t){return this._callContextMethod("arcToSvg",t)}bezierCurveTo(...t){return this._callContextMethod("bezierCurveTo",t)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...t){return this._callContextMethod("ellipse",t)}circle(...t){return this._callContextMethod("circle",t)}path(...t){return this._callContextMethod("path",t)}lineTo(...t){return this._callContextMethod("lineTo",t)}moveTo(...t){return this._callContextMethod("moveTo",t)}quadraticCurveTo(...t){return this._callContextMethod("quadraticCurveTo",t)}rect(...t){return this._callContextMethod("rect",t)}roundRect(...t){return this._callContextMethod("roundRect",t)}poly(...t){return this._callContextMethod("poly",t)}regularPoly(...t){return this._callContextMethod("regularPoly",t)}roundPoly(...t){return this._callContextMethod("roundPoly",t)}roundShape(...t){return this._callContextMethod("roundShape",t)}filletRect(...t){return this._callContextMethod("filletRect",t)}chamferRect(...t){return this._callContextMethod("chamferRect",t)}star(...t){return this._callContextMethod("star",t)}svg(...t){return this._callContextMethod("svg",t)}restore(...t){return this._callContextMethod("restore",t)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...t){return this._callContextMethod("rotate",t)}scaleTransform(...t){return this._callContextMethod("scale",t)}setTransform(...t){return this._callContextMethod("setTransform",t)}transform(...t){return this._callContextMethod("transform",t)}translateTransform(...t){return this._callContextMethod("translate",t)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(t){this._context.fillStyle=t}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(t){this._context.strokeStyle=t}clone(t=!1){return t?new Te(this._context.clone()):(this._ownedContext=null,new Te(this._context))}lineStyle(t,e,r){U(W,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const i={};return t&&(i.width=t),e&&(i.color=e),r&&(i.alpha=r),this.context.strokeStyle=i,this}beginFill(t,e){U(W,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const r={};return t!==void 0&&(r.color=t),e!==void 0&&(r.alpha=e),this.context.fillStyle=r,this}endFill(){U(W,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const t=this.context.strokeStyle;return(t.width!==_e.defaultStrokeStyle.width||t.color!==_e.defaultStrokeStyle.color||t.alpha!==_e.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...t){return U(W,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",t)}drawEllipse(...t){return U(W,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",t)}drawPolygon(...t){return U(W,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",t)}drawRect(...t){return U(W,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",t)}drawRoundedRect(...t){return U(W,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",t)}drawStar(...t){return U(W,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",t)}}const Uc=class $c extends Ps{constructor(...t){let e=t[0]??{};e instanceof Float32Array&&(U(W,"use new MeshGeometry({ positions, uvs, indices }) instead"),e={positions:e,uvs:t[1],indices:t[2]}),e={...$c.defaultOptions,...e};const r=e.positions||new Float32Array([0,0,1,0,1,1,0,1]);let i=e.uvs;i||(e.positions?i=new Float32Array(r.length):i=new Float32Array([0,0,1,0,1,1,0,1]));const s=e.indices||new Uint32Array([0,1,2,0,2,3]),o=e.shrinkBuffersToFit,a=new Xt({data:r,label:"attribute-mesh-positions",shrinkToFit:o,usage:J.VERTEX|J.COPY_DST}),h=new Xt({data:i,label:"attribute-mesh-uvs",shrinkToFit:o,usage:J.VERTEX|J.COPY_DST}),c=new Xt({data:s,label:"index-mesh-buffer",shrinkToFit:o,usage:J.INDEX|J.COPY_DST});super({attributes:{aPosition:{buffer:a,format:"float32x2",stride:8,offset:0},aUV:{buffer:h,format:"float32x2",stride:8,offset:0}},indexBuffer:c,topology:e.topology}),this.batchMode="auto"}get positions(){return this.attributes.aPosition.buffer.data}set positions(t){this.attributes.aPosition.buffer.data=t}get uvs(){return this.attributes.aUV.buffer.data}set uvs(t){this.attributes.aUV.buffer.data=t}get indices(){return this.indexBuffer.data}set indices(t){this.indexBuffer.data=t}};Uc.defaultOptions={topology:"triangle-list",shrinkBuffersToFit:!1};let An=Uc;class Py{constructor(){this.batcherName="default",this.packAsQuad=!1,this.indexOffset=0,this.attributeOffset=0,this.roundPixels=0,this._batcher=null,this._batch=null,this._textureMatrixUpdateId=-1,this._uvUpdateId=-1}get blendMode(){return this.renderable.groupBlendMode}get topology(){return this._topology||this.geometry.topology}set topology(t){this._topology=t}reset(){this.renderable=null,this.texture=null,this._batcher=null,this._batch=null,this.geometry=null,this._uvUpdateId=-1,this._textureMatrixUpdateId=-1}setTexture(t){this.texture!==t&&(this.texture=t,this._textureMatrixUpdateId=-1)}get uvs(){const e=this.geometry.getBuffer("aUV"),r=e.data;let i=r;const s=this.texture.textureMatrix;return s.isSimple||(i=this._transformedUvs,(this._textureMatrixUpdateId!==s._updateID||this._uvUpdateId!==e._updateID)&&((!i||i.length<r.length)&&(i=this._transformedUvs=new Float32Array(r.length)),this._textureMatrixUpdateId=s._updateID,this._uvUpdateId=e._updateID,s.multiplyUvs(r,i))),i}get positions(){return this.geometry.positions}get indices(){return this.geometry.indices}get color(){return this.renderable.groupColorAlpha}get groupTransform(){return this.renderable.groupTransform}get attributeSize(){return this.geometry.positions.length/2}get indexSize(){return this.geometry.indices.length}}class Da{destroy(){}}class Hc{constructor(t,e){this.localUniforms=new vs({uTransformMatrix:{value:new z,type:"mat3x3<f32>"},uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uRound:{value:0,type:"f32"}}),this.localUniformsBindGroup=new an({0:this.localUniforms}),this.renderer=t,this._adaptor=e,this._adaptor.init()}validateRenderable(t){const e=this._getMeshData(t),r=e.batched,i=t.batched;if(e.batched=i,r!==i)return!0;if(i){const s=t._geometry;if(s.indices.length!==e.indexSize||s.positions.length!==e.vertexSize)return e.indexSize=s.indices.length,e.vertexSize=s.positions.length,!0;const o=this._getBatchableMesh(t);return o.texture.uid!==t._texture.uid&&(o._textureMatrixUpdateId=-1),!o._batcher.checkAndUpdateTexture(o,t._texture)}return!1}addRenderable(t,e){var s,o;const r=this.renderer.renderPipes.batch,i=this._getMeshData(t);if(t.didViewUpdate&&(i.indexSize=(s=t._geometry.indices)==null?void 0:s.length,i.vertexSize=(o=t._geometry.positions)==null?void 0:o.length),i.batched){const a=this._getBatchableMesh(t);a.setTexture(t._texture),a.geometry=t._geometry,r.addToBatch(a,e)}else r.break(e),e.add(t)}updateRenderable(t){if(t.batched){const e=this._getBatchableMesh(t);e.setTexture(t._texture),e.geometry=t._geometry,e._batcher.updateElement(e)}}execute(t){if(!t.isRenderable)return;t.state.blendMode=Yi(t.groupBlendMode,t.texture._source);const e=this.localUniforms;e.uniforms.uTransformMatrix=t.groupTransform,e.uniforms.uRound=this.renderer._roundPixels|t._roundPixels,e.update(),zc(t.groupColorAlpha,e.uniforms.uColor,0),this._adaptor.execute(this,t)}_getMeshData(t){var e,r;return(e=t._gpuData)[r=this.renderer.uid]||(e[r]=new Da),t._gpuData[this.renderer.uid].meshData||this._initMeshData(t)}_initMeshData(t){return t._gpuData[this.renderer.uid].meshData={batched:t.batched,indexSize:0,vertexSize:0},t._gpuData[this.renderer.uid].meshData}_getBatchableMesh(t){var e,r;return(e=t._gpuData)[r=this.renderer.uid]||(e[r]=new Da),t._gpuData[this.renderer.uid].batchableMesh||this._initBatchableMesh(t)}_initBatchableMesh(t){const e=new Py;return e.renderable=t,e.setTexture(t._texture),e.transform=t.groupTransform,e.roundPixels=this.renderer._roundPixels|t._roundPixels,t._gpuData[this.renderer.uid].batchableMesh=e,e}destroy(){this.localUniforms=null,this.localUniformsBindGroup=null,this._adaptor.destroy(),this._adaptor=null,this.renderer=null}}Hc.extension={type:[F.WebGLPipes,F.WebGPUPipes],name:"mesh"};tt.add(Hc);class Pr extends _s{constructor(...t){let e=t[0];e instanceof Ps&&(U(W,"Mesh: use new Mesh({ geometry, shader }) instead"),e={geometry:e,shader:t[1]},t[3]&&(U(W,"Mesh: drawMode argument has been removed, use geometry.topology instead"),e.geometry.topology=t[3]));const{geometry:r,shader:i,texture:s,roundPixels:o,state:a,...h}=e;super({label:"Mesh",...h}),this.renderPipeId="mesh",this._shader=null,this.allowChildren=!1,this.shader=i??null,this.texture=s??(i==null?void 0:i.texture)??D.WHITE,this.state=a??As.for2d(),this._geometry=r,this._geometry.on("update",this.onViewUpdate,this),this.roundPixels=o??!1}get material(){return U(W,"mesh.material property has been removed, use mesh.shader instead"),this._shader}set shader(t){this._shader!==t&&(this._shader=t,this.onViewUpdate())}get shader(){return this._shader}set geometry(t){var e;this._geometry!==t&&((e=this._geometry)==null||e.off("update",this.onViewUpdate,this),t.on("update",this.onViewUpdate,this),this._geometry=t,this.onViewUpdate())}get geometry(){return this._geometry}set texture(t){t||(t=D.EMPTY);const e=this._texture;e!==t&&(e&&e.dynamic&&e.off("update",this.onViewUpdate,this),t.dynamic&&t.on("update",this.onViewUpdate,this),this.shader&&(this.shader.texture=t),this._texture=t,this.onViewUpdate())}get texture(){return this._texture}get batched(){return this._shader||(this.state.data&12)!==0?!1:this._geometry instanceof An?this._geometry.batchMode==="auto"?this._geometry.positions.length/2<=100:this._geometry.batchMode==="batch":!1}get bounds(){return this._geometry.bounds}updateBounds(){this._bounds=this._geometry.bounds}containsPoint(t){const{x:e,y:r}=t;if(!this.bounds.containsPoint(e,r))return!1;const i=this.geometry.getBuffer("aPosition").data,s=this.geometry.topology==="triangle-strip"?3:1;if(this.geometry.getIndex()){const o=this.geometry.getIndex().data,a=o.length;for(let h=0;h+2<a;h+=s){const c=o[h]*2,l=o[h+1]*2,u=o[h+2]*2;if(La(e,r,i[c],i[c+1],i[l],i[l+1],i[u],i[u+1]))return!0}}else{const o=i.length/2;for(let a=0;a+2<o;a+=s){const h=a*2,c=(a+1)*2,l=(a+2)*2;if(La(e,r,i[h],i[h+1],i[c],i[c+1],i[l],i[l+1]))return!0}}return!1}destroy(t){var r;if(super.destroy(t),typeof t=="boolean"?t:t==null?void 0:t.texture){const i=typeof t=="boolean"?t:t==null?void 0:t.textureSource;this._texture.destroy(i)}(r=this._geometry)==null||r.off("update",this.onViewUpdate,this),this._texture=null,this._geometry=null,this._shader=null}}var ts=(n=>(n.CLAMP="clamp-to-edge",n.REPEAT="repeat",n.MIRRORED_REPEAT="mirror-repeat",n))(ts||{});new Proxy(ts,{get(n,t){return U(W,`DRAW_MODES.${t} is deprecated, use '${ts[t]}' instead`),n[t]}});var es=(n=>(n.NEAREST="nearest",n.LINEAR="linear",n))(es||{});const Ty=new Proxy(es,{get(n,t){return U(W,`DRAW_MODES.${t} is deprecated, use '${es[t]}' instead`),n[t]}}),Vc=class Wc extends An{constructor(t){const{width:e,points:r,textureScale:i}={...Wc.defaultOptions,...t};super({positions:new Float32Array(r.length*4),uvs:new Float32Array(r.length*4),indices:new Uint32Array((r.length-1)*6)}),this.points=r,this._width=e,this.textureScale=i,this._build()}get width(){return this._width}_build(){const t=this.points;if(!t)return;const e=this.getBuffer("aPosition"),r=this.getBuffer("aUV"),i=this.getIndex();if(t.length<1)return;e.data.length/4!==t.length&&(e.data=new Float32Array(t.length*4),r.data=new Float32Array(t.length*4),i.data=new Uint16Array((t.length-1)*6));const s=r.data,o=i.data;s[0]=0,s[1]=0,s[2]=0,s[3]=1;let a=0,h=t[0];const c=this._width*this.textureScale,l=t.length;for(let d=0;d<l;d++){const f=d*4;if(this.textureScale>0){const p=h.x-t[d].x,g=h.y-t[d].y,m=Math.sqrt(p*p+g*g);h=t[d],a+=m/c}else a=d/(l-1);s[f]=a,s[f+1]=0,s[f+2]=a,s[f+3]=1}let u=0;for(let d=0;d<l-1;d++){const f=d*2;o[u++]=f,o[u++]=f+1,o[u++]=f+2,o[u++]=f+2,o[u++]=f+1,o[u++]=f+3}r.update(),i.update(),this.updateVertices()}updateVertices(){const t=this.points;if(t.length<1)return;let e=t[0],r,i=0,s=0;const o=this.buffers[0].data,a=t.length,h=this.textureScale>0?this.textureScale*this._width/2:this._width/2;for(let c=0;c<a;c++){const l=t[c],u=c*4;c<t.length-1?r=t[c+1]:r=l,s=-(r.x-e.x),i=r.y-e.y;const d=Math.sqrt(i*i+s*s);d<1e-6?(i=0,s=0):(i/=d,s/=d,i*=h,s*=h),o[u]=l.x+i,o[u+1]=l.y+s,o[u+2]=l.x-i,o[u+3]=l.y-s,e=l}this.buffers[0].update()}update(){this.textureScale>0?this._build():this.updateVertices()}};Vc.defaultOptions={width:200,points:[],textureScale:0};let ky=Vc;const Xc=class Yc extends Pr{constructor(t){const{texture:e,points:r,textureScale:i,...s}={...Yc.defaultOptions,...t},o=new ky(dr({width:e.height,points:r,textureScale:i}));i>0&&(e.source.style.addressMode="repeat"),super(dr({...s,texture:e,geometry:o})),this.autoUpdate=!0,this.onRender=this._render}_render(){const t=this.geometry;(this.autoUpdate||t._width!==this.texture.height)&&(t._width=this.texture.height,t.update())}};Xc.defaultOptions={textureScale:0};let Ga=Xc;tt.add(H0,V0);class i_{async init(t){const e={width:Mh,height:Sh,antialias:!0,backgroundAlpha:0,clearBeforeRender:!0,preserveDrawingBuffer:!0,...t};this.renderer=await Lg(e),this.stage=new Kt}get canvas(){var t;return(t=this.renderer)==null?void 0:t.canvas}render(){var t;this.stage!=null&&((t=this.renderer)==null||t.render(this.stage))}}class Ey extends Ch{constructor(t,e,r){var i;super(e,r),this.ctx=t,this.container=new Kt,(i=this.ctx.stage)==null||i.addChild(this.container)}render(){this.ctx.render()}addChild(t){this.container.addChild(t)}clearLayer(){this.container.removeChildren().forEach(e=>{e.destroy()})}onMount(t){var e,r;super.onMount(t),this.pixiViewContainer=((e=this.element)==null?void 0:e.querySelector("#webgl-layer"))??void 0,this.pixiViewContainer||(this.pixiViewContainer=document.createElement("div"),this.pixiViewContainer.setAttribute("id",`${this.id}`),this.pixiViewContainer.setAttribute("class","webgl-layer"),this.ctx.canvas!=null&&this.pixiViewContainer.appendChild(this.ctx.canvas),(r=this.element)==null||r.appendChild(this.pixiViewContainer),this.updateStyle())}onUnmount(t){var e,r;super.onUnmount(t),this.clearLayer(),(e=this.ctx.stage)==null||e.removeChild(this.container),this.container.destroy(),(r=this.pixiViewContainer)==null||r.remove(),this.pixiViewContainer=void 0}onResize(t){var e;super.onResize(t),(e=this.ctx.renderer)==null||e.resize(t.width,t.height)}onRescale(t){super.onRescale(t);const e=t.xBounds[0]>t.xBounds[1],r=t.yBounds[0]>t.yBounds[1];this.setContainerPosition(t.xScale(0),t.yScale(0)),this.setContainerScale(t.xRatio*(e?-1:1),t.yRatio*(r?-1:1))}setContainerPosition(t,e){this.container.position.set(t,e)}setContainerScale(t,e){this.container.scale.set(t,e)}updateStyle(t){var s;const e=t||this.isVisible,r=this.interactive?"auto":"none";this.container.visible=e;const i=[["position","absolute"],["pointer-events",`${r}`],["z-index",`${this.order}`],["opacity",`${this.opacity}`]].map(o=>o.join(":")).join(";");(s=this.pixiViewContainer)==null||s.setAttribute("style",i)}setVisibility(t,e){super.setVisibility(t,e),this.pixiViewContainer&&this.updateStyle(t)}onOpacityChanged(t){this.pixiViewContainer&&this.updateStyle()}onOrderChanged(t){this.pixiViewContainer&&this.updateStyle()}onInteractivityChanged(t){this.pixiViewContainer&&this.updateStyle()}renderType(){var t;return(t=this.ctx.renderer)==null?void 0:t.type}}function Ds(n){throw new Error(`Unexpected object: ${JSON.stringify(n)}`)}const Iy=n=>n.kind==="pAndASymbol",Ry=n=>n.kind==="cementSqueeze",Fy=n=>n.kind==="cementPlug",By=(n,t,e)=>r=>{switch(r.kind){case"screen":return n(r);case"tubing":return t(r);case"completionSymbol":return e(r);default:return Ds(r)}},Jt=(n,t)=>{switch(t){case"Perforation":return n.Perforation(t);case"Open hole gravel pack":return n.OpenHoleGravelPack(t);case"Open hole frac pack":return n.OpenHoleFracPack(t);case"Cased hole fracturation":return n.CasedHoleFracturation(t);case"Cased hole frac pack":return n.CasedHoleFracPack(t);case"Cased hole gravel pack":return n.CasedHoleGravelPack(t);default:return Ds(t)}},Ly=n=>Jt({Perforation:()=>!1,OpenHoleGravelPack:()=>!0,OpenHoleFracPack:()=>!0,CasedHoleFracturation:()=>!1,CasedHoleGravelPack:()=>!0,CasedHoleFracPack:()=>!0},n.subKind);function Dy(n){return Jt({Perforation:()=>!1,OpenHoleGravelPack:()=>!1,OpenHoleFracPack:()=>!0,CasedHoleFracturation:()=>!0,CasedHoleGravelPack:()=>!1,CasedHoleFracPack:()=>!0},n.subKind)}function Gy(n){return Jt({Perforation:()=>!0,OpenHoleGravelPack:()=>!1,OpenHoleFracPack:()=>!1,CasedHoleFracturation:()=>!1,CasedHoleGravelPack:()=>!1,CasedHoleFracPack:()=>!1},n.subKind)}function Oy(n){return Jt({Perforation:()=>!1,OpenHoleGravelPack:()=>!1,OpenHoleFracPack:()=>!1,CasedHoleFracturation:()=>!1,CasedHoleGravelPack:()=>!0,CasedHoleFracPack:()=>!1},n.subKind)}function zy(n){return Jt({Perforation:()=>!1,OpenHoleGravelPack:()=>!1,OpenHoleFracPack:()=>!1,CasedHoleFracturation:()=>!1,CasedHoleGravelPack:()=>!1,CasedHoleFracPack:()=>!0},n.subKind)}const Ny=n=>n.subKind==="Cased hole fracturation",Uy=(n,t)=>n.start<t.end&&n.end>t.start,$y=n=>({holeLayerId:`${n}-hole`,casingLayerId:`${n}-casing`,completionLayerId:`${n}-completion`,cementLayerId:`${n}-cement`,pAndALayerId:`${n}-pAndA`,perforationLayerId:`${n}-perforation`}),Hy={firstColor:"#8c541d",secondColor:"#eee3d8",lineColor:"#8b4513"},Vy={solidColor:"#dcdcdc",lineColor:"#575757",shoeSize:{width:U0,length:$0},windowOptions:{dashColor:"#dc0000",dashLength:5,spaceLength:3}},Wy={stroke:"rgba(0, 0, 0, 0.25)",yellow:"#FFFC00",grey:"gray",red:"#FF5050",outline:"black",transparent:"rgba(255, 255, 255, 0)",spikeWidth:50,spikeLength:50,packingOpacity:.7,fracLineCurve:10,fracLineLength:25,scalingFactor:25},Xy={firstColor:"#c7b9ab",secondColor:"#5b5b5b",scalingFactor:4},Yy={firstColor:"#8b6713",secondColor:"#000000",scalingFactor:4},qy={scalingFactor:4,lineColor:"#63666a"},jy={scalingFactor:1,innerColor:"#eeeeff",outerColor:"#777788"},Zy={firstColor:"#c7b9ab",secondColor:"#000000",scalingFactor:4},Ky=16,Qy=6;function Dt(n){const t=Yt(n);if(t!=null){const e=t==null?void 0:t.formatHex();return parseInt(e.replace("#","0x"))}else throw Error(`Could not format string ${n} to hex code.`)}function s_(n){return typeof n=="string"?n:`#${n.toString(Ky).padStart(Qy,"0")}`}const Jy=2147483648,tx=4294967295;function o_(n,t,e){const r=e.filter(f=>f.data.values),i=ox(r),s=new Map,o=ix(i,t,s);sx(o);const a=ex(i,n),h=ux(n,o,t),c=rx(s,h),u=[...nx(c,n),...Object.values(h).flat().filter(f=>!f.exclude)];return{lines:a,areas:u}}function ex(n,t){return n.filter(r=>r.visualization==="line").map(r=>({id:r.name,label:r.name,width:2,color:Dt(r.color||"black"),data:t.map((i,s)=>[i[0],r.values[s]])}))}function nx(n,t){return n.map((r,i)=>{const s=i+1<n.length?n[i+1]:null;return{id:r.id,color:Dt(r.color),data:t.map((o,a)=>[o[0],r.top[a],...s?[s.top[a]]:[]])}})}function rx(n,t){return Array.from(n.values()).sort((r,i)=>r.age-i.age).filter(r=>{const i=t[r.name],s=i&&i.length>0;return s||console.warn(`Intersection surface group '${r.name}' has no valid entries and will be discarded.`),s}).map((r,i)=>{const o=t[r.name][0];return{id:r.name,label:r.name,color:hx(i),top:o.data.map(a=>a[1])}})}function ix(n,t,e){const r=t&&t.find(o=>o.stratUnitLevel===1),i=r?r.identifier:"SEABED";return n.filter(o=>o.visualization==="interval"||o.visualization==="none").map(o=>{const a=[],h=qc(t,o.name,a);h||console.warn(`No match for ${o.name} in strat column`);const c=a[0]||h,l=c&&c.identifier||i;return c&&!e.has(l)&&e.set(l,{age:c.topAge,name:c.identifier}),{...o,unit:h,group:l}})}function sx(n){n.sort((t,e)=>{if(!t.unit&&!e.unit)return 0;if(!t.unit)return-1;if(!e.unit)return 1;const r=t.isBase?t.unit.baseAge:t.unit.topAge,i=e.isBase?e.unit.baseAge:e.unit.topAge;return r!==i?r-i:t.isBase&&!e.isBase?1:!t.isBase&&e.isBase?-1:t.unit.stratUnitLevel-e.unit.stratUnitLevel})}function qc(n,t,e=[]){const r=n.find(i=>i.identifier.toLowerCase()===t.toLowerCase());if(r){let i=r;do e.unshift(i),i=n.find(s=>s.identifier===i.stratUnitParent);while(i);return r}return null}function ox(n){return n.map(t=>{const e=t.visualSettings.displayName,r=e.replace(/\s(Base|Top)/gi,""),i=e.toLowerCase().endsWith("base");return{name:r,isBase:i,values:t.data.values,color:t.visualSettings.colors.crossSection,visualization:t.visualSettings.crossSection.toLowerCase()}})}function ax(n){return n.colorR===null||n.colorG===null||n.colorB===null?Jy:n.colorR<<16|n.colorG<<8|n.colorB}const hx=Ha().domain([0,100]).range(Wl(fn("#e6f1cf","#85906d"),10));function cx(n,t,e,r){const i=t+1;if(!e||i>=e.length)return;const s=e.findIndex(o=>o.isBase&&o.name===n.name);if(s!==-1)return s;for(let o=i;o<e.length;o++){const a=e[o];if(!(a!=null&&a.isBase)||lx(n,a,r))return o}}function lx(n,t,e){const r=[];return qc(e,n.name,r),r.some(i=>t.name===i.identifier)}function ux(n,t,e){return t.reduce((i,s,o)=>{var a;if(!s.isBase){i[s.group]||(i[s.group]=[]);const h=cx(s,o,t,e);(a=i[s.group])==null||a.push({id:s.name,label:s.name,color:s.unit&&ax(s.unit)||tx,exclude:s.visualization==="none"||!s.unit,data:n.map((c,l)=>{const u=s.values[l]!=null?dx(h,t,l):void 0;return[c[0],s.values[l],u]})})}return i},{})}function dx(n,t,e){var r,i;if(!(!t||!n||n>=t.length)){for(let s=n;s<t.length;s++)if(((r=t[s])==null?void 0:r.values[e])!=null)return(i=t[s])==null?void 0:i.values[e]}}const fx={dash:[10,5],width:1,color:16777215,alpha:1,scale:1,useTexture:!1,alignment:.5},Et=class Et{constructor(t,e={}){this.cursor=new V,this.scale=1,this.graphics=t,e={...fx,...e},this.dash=e.dash,this.dashSize=this.dash.reduce((r,i)=>r+i),this.useTexture=e.useTexture,this.options=e,this.setLineStyle()}setLineStyle(){const t=this.options;if(this.useTexture){const e=Et.getTexture(t,this.dashSize);this.graphics.lineTextureStyle({width:t.width*t.scale,color:t.color,alpha:t.alpha,texture:e,alignment:t.alignment})}else this.graphics.setStrokeStyle({width:t.width*t.scale,color:t.color,alpha:t.alpha,cap:t.cap,join:t.join,alignment:t.alignment});this.scale=t.scale}static distance(t,e,r,i){return Math.sqrt(Math.pow(r-t,2)+Math.pow(i-e,2))}moveTo(t,e){return this.lineLength=0,this.cursor.set(t,e),this.start=new V(t,e),this.graphics.moveTo(this.cursor.x,this.cursor.y),this}lineTo(t,e,r){typeof this.lineLength===void 0&&this.moveTo(0,0);const s=Et.distance(this.cursor.x,this.cursor.y,t,e),o=Math.atan2(e-this.cursor.y,t-this.cursor.x),a=r&&t===this.start.x&&e===this.start.y;if(this.useTexture)if(this.graphics.moveTo(this.cursor.x,this.cursor.y),this.adjustLineStyle(o),a&&this.dash.length%2===0){const h=Math.min(this.dash[this.dash.length-1],s);this.graphics.lineTo(t-Math.cos(o)*h,e-Math.sin(o)*h),this.graphics.closePath()}else this.graphics.lineTo(t,e);else{const h=Math.cos(o),c=Math.sin(o);let l=this.cursor.x,u=this.cursor.y;const d=this.lineLength%(this.dashSize*this.scale);let f=0,p=0,g=0;for(let y=0;y<this.dash.length;y++){const x=this.dash[y]*this.scale;if(d<g+x){f=y,p=d-g;break}else g+=x}let m=s;for(;m>0;){const y=this.dash[f]*this.scale-p,x=m>y?y:m;if(a&&Et.distance(l+h*x,u+c*x,this.start.x,this.start.y)<=x){if(f%2===0){const b=Et.distance(l,u,this.start.x,this.start.y)-this.dash[this.dash.length-1]*this.scale;l+=h*b,u+=c*b,this.graphics.lineTo(l,u)}break}l+=h*x,u+=c*x,f%2?this.graphics.moveTo(l,u):this.graphics.lineTo(l,u),m-=x,f++,f=f===this.dash.length?0:f,p=0}}return this.lineLength+=s,this.cursor.set(t,e),this}closePath(){this.lineTo(this.start.x,this.start.y,!0)}drawCircle(t,e,r,i=80,s){const o=Math.PI*2/i;let a=0,h;s?(h=new V(t+Math.cos(a)*r,e+Math.sin(a)*r),s.apply(h,h),this.moveTo(h[0],h[1])):(h=new V(t+Math.cos(a)*r,e+Math.sin(a)*r),this.moveTo(h.x,h.y)),a+=o;for(let c=1;c<i+1;c++){const l=c===i?h:[t+Math.cos(a)*r,e+Math.sin(a)*r];this.lineTo(l[0],l[1]),a+=o}return this}drawEllipse(t,e,r,i,s=80,o){const a=Math.PI*2/s;let h;const c=new V;for(let l=0;l<Math.PI*2;l+=a){let u=t-r*Math.sin(l),d=e-i*Math.cos(l);o&&(c.set(u,d),o.apply(c,c),u=c.x,d=c.y),l===0?(this.moveTo(u,d),h={x:u,y:d}):this.lineTo(u,d)}return this.lineTo(h.x,h.y,!0),this}drawPolygon(t,e){const r=new V;if(typeof t[0]=="number")if(e){r.set(t[0],t[1]),e.apply(r,r),this.moveTo(r.x,r.y);for(let i=2;i<t.length;i+=2)r.set(t[i],t[i+1]),e.apply(r,r),this.lineTo(r.x,r.y,i===t.length-2)}else{this.moveTo(t[0],t[1]);for(let i=2;i<t.length;i+=2)this.lineTo(t[i],t[i+1],i===t.length-2)}else if(e){const i=t[0];r.copyFrom(i),e.apply(r,r),this.moveTo(r.x,r.y);for(let s=1;s<t.length;s++){const o=t[s];r.copyFrom(o),e.apply(r,r),this.lineTo(r.x,r.y,s===t.length-1)}}else{const i=t[0];this.moveTo(i.x,i.y);for(let s=1;s<t.length;s++){const o=t[s];this.lineTo(o.x,o.y,s===t.length-1)}}return this}drawRect(t,e,r,i,s){if(s){const o=new V;o.set(t,e),s.apply(o,o),this.moveTo(o.x,o.y),o.set(t+r,e),s.apply(o,o),this.lineTo(o.x,o.y),o.set(t+r,e+i),s.apply(o,o),this.lineTo(o.x,o.y),o.set(t,e+i),s.apply(o,o),this.lineTo(o.x,o.y),o.set(t,e),s.apply(o,o),this.lineTo(o.x,o.y,!0)}else this.moveTo(t,e).lineTo(t+r,e).lineTo(t+r,e+i).lineTo(t,e+i).lineTo(t,e,!0);return this}adjustLineStyle(t){const e=this.graphics.line;e.matrix=new z,t&&e.matrix.rotate(t),this.scale!==1&&e.matrix.scale(this.scale,this.scale);const r=-this.lineLength;e.matrix.translate(this.cursor.x+r*Math.cos(t),this.cursor.y+r*Math.sin(t)),this.graphics.lineStyle(e)}static getTexture(t,e){const r=t.dash.toString();if(Et.dashTextureCache[r])return Et.dashTextureCache[r];const i=document.createElement("canvas");i.width=e,i.height=Math.ceil(t.width);const s=i.getContext("2d");if(!s){console.warn("Did not get context from canvas");return}s.globalAlpha=t.alpha,s.lineWidth=t.width;let o=0;const a=t.width/2;s.moveTo(o,a);for(let c=0;c<t.dash.length;c+=2)o+=t.dash[c],s.lineTo(o,a),t.dash.length!==c+1&&(o+=t.dash[c+1],s.moveTo(o,a));s.strokeStyle="white",s.stroke();const h=Et.dashTextureCache[r]=D.from(i);return h.baseTexture.scaleMode=Ty.NEAREST,h}};Et.dashTextureCache={};let ns=Et;const rs=n=>new Ja(n.x,n.y),px=n=>new V(n[0],n[1]),jc=n=>{if(n.length<2)return[new Ja(0)];let t;return n.map((e,r,i)=>{const s=i[r],o=i[r+1];if(r<i.length-1&&s!=null&&o!=null){const a=rs(s);return t=rs(o).sub(a).rotate90().normalized(),t}return t})},Zc=(n,t,e)=>{const r=rs(n);return px(r.add(t.scale(e)))},is=(n,t,e)=>{if(n.length!==t.length)throw new Error("Number of vectors does not match number of points");return n.map((r,i)=>{const s=t[i];if(s!=null)return Zc(r,s,e);throw new Error(`Trying to read index ${i} of point ${r}, but no such vector was found!`)})},Oa=(n,t,e,r)=>n<=r&&e<=t,gx=(n,t,e,r)=>n<r&&e<t,mx=n=>Array.from(new Set(n)),Tr=(n,t,e,r)=>{const i=r.filter(o=>Oa(n,t,o.start,o.end)),s=e.filter(o=>Oa(n,t,o.start,o.end));return{overlappingHoles:i,overlappingOuterStrings:s}},kr=([n,t],e)=>{const s=e.flatMap(a=>[a.start-1e-4,a.start,a.end,a.end+1e-4]).filter(a=>a>=n&&a<=t);return s.push(n),s.push(t),mx(s).sort((a,h)=>a-h)},ft=n=>n.kind==="casing"?n.innerDiameter:n.diameter,Kc=(n,t,e,r)=>{const s=n.find(c=>c.start<=r&&c.end>=r),o=s?s.diameter:0,a=t.filter(c=>ft(c)>o).sort((c,l)=>ft(c)-ft(l)).find(c=>c.start<=r&&c.end>=r),h=e.find(c=>c.start<=r&&c.end>=r&&c.diameter>o);return a?ft(a):h?h.diameter:100},yx=(n,t,e,r)=>{const s=n.sort((a,h)=>h.diameter-a.diameter).find(a=>a.start<=e&&a.end>=e),o=t.find(a=>a.start<=e&&a.end>=e);return s&&r!=="Open hole frac pack"&&r!=="Open hole gravel pack"?ft(s):o?o.diameter:100},xx=(n,t,e,r)=>{const s=n.sort((c,l)=>ft(c)-ft(l)).find(c=>c.start<=r&&c.end>=r);if(s)return ft(s);const o=n.length?Math.min(...n.map(c=>ft(c))):0,a=t.sort((c,l)=>ft(c)-ft(l)).find(c=>c.start<=r&&c.end>=r&&o<=ft(c));if(a)return ft(a);const h=e.find(c=>c.start<=r&&c.end>=r&&c.diameter);return h?h.diameter:100},_x=(n,t,e,r,i,s)=>{const{attachedStrings:o,nonAttachedStrings:a}=Gs(n.referenceIds,t,e);if(o.length===0)throw new Error(`Invalid cement data, can't find referenced casing/completion string for cement with id '${n.id}'`);o.sort((g,m)=>g.end-m.end);const h=o[o.length-1].end,{overlappingOuterStrings:c,overlappingHoles:l}=Tr(n.toc,h,a,r),u=[...c,...l].map(g=>({start:g.start,end:g.end}));return kr([n.toc,h],u).flatMap((g,m,y)=>{if(m===y.length-1)return[];const x=y[m+1],_=Kc(o,c,l,g);return[{top:g,bottom:x,diameter:_*i}]}).map(g=>({diameter:g.diameter,points:s(g.top,g.bottom)}))},Gs=(n,t,e)=>[...t,...e].reduce((r,i)=>n.includes(i.id)?{...r,attachedStrings:[...r.attachedStrings,i]}:{...r,nonAttachedStrings:[...r.nonAttachedStrings,i]},{attachedStrings:[],nonAttachedStrings:[]}),bx=(n,t,e,r,i,s)=>{const{attachedStrings:o,nonAttachedStrings:a}=Gs(n.referenceIds,t,e);if(o.length===0)throw new Error(`Invalid cement squeeze data, can't find referenced casing/completion for squeeze with id '${n.id}'`);const{overlappingOuterStrings:h,overlappingHoles:c}=Tr(n.start,n.end,a,r),l=[...h,...c].map(p=>({start:p.start,end:p.end}));return kr([n.start,n.end],l).flatMap((p,g,m)=>{if(g===m.length-1)return[];const y=m[g+1],x=Kc(o,h,c,p);return[{top:p,bottom:y,diameter:x*i}]}).map(p=>({diameter:p.diameter,points:s(p.top,p.bottom)}))},vx=(n,t,e,r,i,s)=>{const{attachedStrings:o,nonAttachedStrings:a}=Gs(n.referenceIds,t,e),{overlappingHoles:h,overlappingOuterStrings:c}=Tr(n.start,n.end,a,r),l=[...o,...h,...c].map(p=>({start:p.start,end:p.end}));return kr([n.start,n.end],l).flatMap((p,g,m)=>{if(g===m.length-1)return[];const y=m[g+1],x=xx(o,c,h,p);return[{top:p,bottom:y,diameter:x*i}]}).map(p=>({diameter:p.diameter,points:s(p.top,p.bottom)}))},wx=(n,t,e,r,i)=>{const o=t.createLinearGradient(0,0,0,n.height);return o.addColorStop(0,e),o.addColorStop(.5-i,r),o.addColorStop(.5+i,r),o.addColorStop(1,e),o},Ax=({firstColor:n,secondColor:t},e,r)=>{const i=document.createElement("canvas");i.width=e,i.height=r;const s=i.getContext("2d");if(s==null)throw Error("Could not get canvas context!");return s.fillStyle=wx(i,s,n,t,0),s.fillRect(0,0,i.width,i.height),D.from(i)},Cx=({scalingFactor:n})=>{const t=document.createElement("canvas"),e=qt*n;t.width=e,t.height=e;const r=t.getContext("2d");if(r==null)throw Error("Could not get canvas context!");r.fillStyle="white",r.fillRect(0,0,t.width,t.height);const i=e/10;r.strokeStyle="#AAAAAA",r.lineWidth=i,r.beginPath();const s=e/3;for(let o=-t.width;o<t.width;o++)r.moveTo(-t.width+s*o,-t.height),r.lineTo(t.width+s*o,t.height*2);return r.stroke(),D.from(t)},Mx=({innerColor:n,outerColor:t,scalingFactor:e})=>{const r=qt*e,i=document.createElement("canvas");i.width=r,i.height=r;const s=i.getContext("2d");if(s==null)throw Error("Could not get canvas context!");const o=s.createLinearGradient(0,0,0,r),a=.3,h=.7;return o.addColorStop(0,t),o.addColorStop(a,n),o.addColorStop(h,n),o.addColorStop(1,t),s.fillStyle=o,s.fillRect(0,0,i.width,i.height),D.from(i)},Sx=({firstColor:n,secondColor:t,scalingFactor:e})=>{const r=document.createElement("canvas"),i=qt*e,s=e;r.width=i,r.height=i;const o=r.getContext("2d");if(o==null)throw Error("Could not get canvas context!");o.fillStyle=n,o.fillRect(0,0,r.width,r.height),o.lineWidth=s,o.fillStyle=t,o.beginPath();const a=i/12;for(let h=-r.width;h<r.width;h++)o.moveTo(-r.width+a*h,-r.height),o.lineTo(r.width+a*h,r.height);return o.stroke(),D.from(r)},Px=({firstColor:n,secondColor:t,scalingFactor:e})=>{const r=document.createElement("canvas"),i=qt*e;r.width=i,r.height=i;const s=r.getContext("2d");if(s==null)throw Error("Could not get canvas context!");s.fillStyle=n,s.fillRect(0,0,r.width,r.height),s.lineWidth=e,s.strokeStyle=t,s.beginPath(),s.setLineDash([20,10]);const o=i/12;for(let a=-r.width;a<r.width;a++)s.moveTo(-r.width+o*a,-r.height),s.lineTo(r.width+o*a,r.height*2);return s.stroke(),D.from(r)},Tx=({firstColor:n,secondColor:t,scalingFactor:e})=>{const r=document.createElement("canvas"),i=qt*e,s=e;r.width=i,r.height=i;const o=r.getContext("2d");if(o==null)throw Error("Could not get canvas context!");o.lineWidth=s,o.fillStyle=n,o.strokeStyle=t,o.fillRect(0,0,r.width,r.height),o.beginPath(),o.setLineDash([20,10]);const a=i/12;for(let h=-r.width;h<r.width;h++)o.moveTo(-r.width+a*h,-r.height),o.lineTo(r.width+a*h,r.height*2);return o.stroke(),D.from(r)},Jn=(n,t)=>{const e=jc(t),r=is(t,e,n);return{leftPath:is(t,e,-n),rightPath:r}},mi=(n,t)=>({kind:"casing",start:n,end:t}),kx=(n,t)=>({kind:"casing-window",start:n,end:t}),Ex=n=>{const t=(n.windows||[]).filter(e=>gx(n.start,n.end,e.start,e.end)).reduce(({intervals:e,lastBottom:r},i,s,o)=>{const a=r<i.start?mi(r,i.start):null,h=a?a.end:r,c=Math.max(h,i.start),l=Math.min(n.end,i.end),u=kx(c,l),d=l,p=s===o.length-1&&d<n.end?mi(d,n.end):null,g=[a,u,p].filter(m=>m!=null);return{intervals:[...e,...g],lastBottom:d}},{intervals:[],lastBottom:n.start});return t.intervals.length?t.intervals:[mi(n.start,n.end)]},Ix=(n,t,e)=>{const r=t.diameter*n,i=r/2,o=t.innerDiameter*n/2,a=i-o,h=Ex(t).map(c=>{const l=e(c.start,c.end),{leftPath:u,rightPath:d}=Jn(i,l);return{kind:c.kind,leftPath:u,rightPath:d,pathPoints:l}});return{kind:"casing",id:t.id,referenceDiameter:r,referenceRadius:i,sections:h,casingWallWidth:a,hasShoe:t.hasShoe,bottom:t.end}},Rx=(n,t,e,r,i)=>{const{overlappingOuterStrings:s,overlappingHoles:o}=Tr(n.start,n.end,t,e),a=[...s,...o].map(u=>({start:u.start,end:u.end}));return kr([n.start,n.end],a).flatMap((u,d,f)=>{if(d===f.length-1)return[];const p=f[d+1],g=yx(s,o,u,n.subKind);return[{top:u,bottom:p,diameter:g*r}]}).map(u=>{const d=i(u.top,u.bottom);return{diameter:u.diameter,points:d}})},Er=(n,t,e)=>{const{packingOpacity:r,yellow:i}=e;t.fillStyle=i,t.strokeStyle=i;const s=[0,0],o=[n.width,n.height];t.save(),t.globalAlpha=r,t.fillRect(...s,...o),t.restore()},Os=(n,t,e,r,i)=>{const{fracLineCurve:s}=r,o=10,a=n.width/o,h=e/3*r.scalingFactor,c=h/4,l=h/2,u=0,d=i==="diameter"?0:l;t.globalAlpha=r.packingOpacity;const f=()=>{for(let p=-1;p<o;p++){const g=[p*a+u+a/2,n.height/2-c-d-c];t.beginPath();const m=[...g],y=[g[0]-s*2,g[1]-c/4],x=[g[0],g[1]-c/2],_=[g[0]+s*2,g[1]-c/2-c/4],b=[g[0],g[1]-c];t.bezierCurveTo(...m,...y,...x),t.bezierCurveTo(...x,..._,...b),t.stroke()}for(let p=-1;p<o;p++){const g=[p*a+a+u+a/2,n.height/2+h/2+d];t.beginPath();const m=[...g],y=[g[0]-s*2,g[1]+c/4],x=[g[0],g[1]+c/2],_=[g[0]+s*2,g[1]+c/2+c/4],b=[g[0],g[1]+c];t.bezierCurveTo(...m,...y,...x),t.bezierCurveTo(...x,..._,...b),t.stroke()}};t.strokeStyle=r.yellow,t.lineWidth=6,t.save(),f(),t.restore(),t.lineWidth=1,t.strokeStyle=r.outline,f(),t.closePath()},Fx=(n,t,e,r)=>{const s=n.width/4;t.strokeStyle=r.outline;const o=e/3*r.scalingFactor;t.lineWidth=1;const a=o/2;for(let h=0;h<=4;h++){const c=[h*s,n.height/2-o/2],l=[c[0]-s/2,c[1]-a],u=[c[0]-s,c[1]];t.beginPath(),t.moveTo(...c),t.lineTo(...l),t.lineTo(...u),t.fill(),t.lineWidth=1,t.stroke()}for(let h=0;h<=4;h++){const c=[h*s,n.height/2+o/2],l=[c[0]-s/2,c[1]+a],u=[c[0]-s,c[1]];t.beginPath(),t.moveTo(...c),t.lineTo(...l),t.lineTo(...u),t.fill(),t.lineWidth=1,t.stroke()}t.closePath()},Rt=(n="Error!",t)=>{console.error(`${n}`);const e=document.createElement("canvas"),r=qt;e.width=r/2,e.height=r;const i=e.getContext("2d"),s=[0,0],o=[e.width,e.height];if(i==null)throw Error("Could not get canvas context!");return i.fillStyle="#ff00ff",i.fillRect(...s,...o),new D({source:new vr({resource:e,wrapMode:"clamp-to-edge"}),orig:new Y(0,0,e.width,e.height),rotate:$.MIRROR_HORIZONTAL})},jt=(n,t)=>{const e=document.createElement("canvas"),i=n.diameter*t.scalingFactor;e.width=i/2,e.height=i;const s=e.getContext("2d");if(s==null)throw Error("Could not get canvas context!");return{canvas:e,ctx:s}},Zt=n=>new D({source:new vr({resource:n}),orig:new Y(0,0,n.width,n.height),rotate:$.MIRROR_HORIZONTAL}),Bx=(n,t)=>e=>t.some(r=>e(r)&&Uy(n,r)),zs={packing:()=>Rt(),fracLines:()=>Rt(),spikes:(n,t,e,r)=>{const{canvas:i,ctx:s}=jt(t,r),o=Bx(n,e),a=o(Oy),h=o(Ny),c=o(zy),u=a||h||c?r.yellow:r.red;return s.globalAlpha=r.packingOpacity,n.isOpen?(s.fillStyle=u,s.strokeStyle=u):(s.fillStyle=r.grey,s.strokeStyle=r.grey),Fx(i,s,t.diameter,r),c&&Os(i,s,t.diameter,r,"spike"),Zt(i)}},Qc={packing:()=>Rt(),fracLines:(n,t)=>{const{canvas:e,ctx:r}=jt(n,t);return Os(e,r,n.diameter,t,"diameter"),Zt(e)},spikes:()=>Rt()},gr={packing:(n,t)=>{const{canvas:e,ctx:r}=jt(n,t);return Er(e,r,t),Zt(e)},fracLines:(n,t)=>{const{canvas:e}=jt(n,t);return Zt(e)},spikes:()=>Rt()},Ns={packing:(n,t)=>{const{canvas:e,ctx:r}=jt(n,t);return Er(e,r,t),Zt(e)},fracLines:()=>Rt(),spikes:()=>Rt()},Us={packing:(n,t)=>{const{canvas:e,ctx:r}=jt(n,t);return Er(e,r,t),Zt(e)},fracLines:()=>Rt(),spikes:()=>Rt()},$s={packing:(n,t,e)=>{const{canvas:r,ctx:i}=jt(t,e);return Er(r,i,e),Zt(r)},fracLines:(n,t)=>{const{canvas:e,ctx:r}=jt(n,t);return Os(e,r,n.diameter,t,"diameter"),Zt(e)},spikes:()=>Rt()},Lx=(n,t,e)=>Jt({Perforation:()=>zs.packing(),CasedHoleFracturation:()=>gr.packing(t,e),CasedHoleFracPack:()=>gr.packing(t,e),OpenHoleGravelPack:()=>Us.packing(t,e),OpenHoleFracPack:()=>$s.packing(n,t,e),CasedHoleGravelPack:()=>Ns.packing(t,e)},n.subKind),Dx=(n,t,e)=>Jt({Perforation:()=>zs.fracLines(),OpenHoleGravelPack:()=>Us.fracLines(),OpenHoleFracPack:()=>$s.fracLines(t,e),CasedHoleFracturation:()=>Qc.fracLines(t,e),CasedHoleGravelPack:()=>Ns.fracLines(),CasedHoleFracPack:()=>gr.fracLines(t,e)},n.subKind),Gx=(n,t,e,r)=>Jt({Perforation:()=>zs.spikes(n,e,t,r),OpenHoleGravelPack:()=>Us.spikes(),OpenHoleFracPack:()=>$s.spikes(),CasedHoleFracturation:()=>Qc.spikes(),CasedHoleGravelPack:()=>Ns.spikes(),CasedHoleFracPack:()=>gr.spikes()},n.subKind);class Ox extends An{constructor(t){const e=Rr(t,r=>r.points.length);super({positions:new Float32Array(e*4),uvs:new Float32Array(e*4),indices:new Uint32Array((e-1)*6),shrinkBuffersToFit:!0}),this.segments=t,this.build()}get width(){return xi(this.segments,t=>t.diameter)}build(){var p,g,m,y,x,_,b,M;const t=this.segments;if(!t)return;const e=this.getBuffer("aPosition"),r=this.getBuffer("aUV"),i=this.getIndex(),s=Rr(t,C=>C.points.length);if(s<1)return;e.data.length/4!==s&&(e.data=new Float32Array(s*4),r.data=new Float32Array(s*4),i.data=new Uint16Array((s-1)*6));const o=r.data,a=i.data;o[0]=0,o[1]=0,o[2]=0,o[3]=1;const h=t.length,c=xi(t,C=>C.diameter);let l=0,u=0,d=0,f=0;for(let C=0;C<h;C++){let A=(p=t[C])==null?void 0:p.points[0];const E=c,I=((g=t[C])==null?void 0:g.diameter)/c/2,T=(m=t[C])==null?void 0:m.points.length;for(let P=0;P<T;P++){const G=A.x-((x=(y=t[C])==null?void 0:y.points[P])==null?void 0:x.x),O=A.y-((b=(_=t[C])==null?void 0:_.points[P])==null?void 0:b.y),v=Math.sqrt(G*G+O*O);A=(M=t[C])==null?void 0:M.points[P],l+=v/E,o[u]=l,o[u+1]=.5-I,o[u+2]=l,o[u+3]=.5+I,u+=4}for(let P=0;P<T-1;P++)a[f++]=d,a[f++]=d+1,a[f++]=d+2,a[f++]=d+2,a[f++]=d+1,a[f++]=d+3,d+=2;d+=2}r.update(),i.update(),this.updateVertices()}updateVertices(){var s,o,a,h,c,l,u,d;const t=this.segments;if(Rr(t,f=>f.points.length)<1)return;const r=t.length;let i=0;for(let f=0;f<r;f++){let p=(s=t[f])==null?void 0:s.points[0],g,m=0,y=0;const x=(o=this.buffers[0])==null?void 0:o.data,_=(a=t[f])==null?void 0:a.points.length;let b=0;for(let M=0;M<_;M++){const C=(h=t[f])==null?void 0:h.points[M];b=i+M*4,M<((c=t[f])==null?void 0:c.points.length)-1?g=(l=t[f])==null?void 0:l.points[M+1]:g=C,y=-(g.x-p.x),m=g.y-p.y;const A=Math.sqrt(m*m+y*y),E=((u=t[f])==null?void 0:u.diameter)/2;m/=A,y/=A,m*=E,y*=E,x!=null&&(x[b]=C.x+m,x[b+1]=C.y+y,x[b+2]=C.x-m,x[b+3]=C.y-y),p=C}i=b+4}(d=this.buffers[0])==null||d.update()}update(){this.build()}}class zx extends Pr{constructor(t,e){const r=new Ox(e);t.source.addressMode="repeat",super({geometry:r,texture:t}),this.autoUpdate=!0,this.onRender=()=>{const i=this.geometry;this.autoUpdate&&i.update()}}}class Nx extends An{constructor(t,e=200){super({positions:new Float32Array(t.length*4),uvs:new Float32Array(t.length*4),indices:new Uint32Array((t.length-1)*6)}),this.points=t,this._width=e,this.build()}get width(){return this._width}build(){var u,d;const t=this.points;if(!t)return;const e=this.getBuffer("aPosition"),r=this.getBuffer("aUV"),i=this.getIndex();if(t.length<1)return;e.data.length/4!==t.length&&(e.data=new Float32Array(t.length*4),r.data=new Float32Array(t.length*4),i.data=new Uint16Array((t.length-1)*6));const s=r.data,o=i.data;s[0]=0,s[1]=0,s[2]=0,s[3]=1;let a=0,h=t[0];const c=t.length;for(let f=0;f<c;f++){const p=f*4,g=h.x-((u=t[f])==null?void 0:u.x),m=h.y-((d=t[f])==null?void 0:d.y),y=Math.sqrt(g*g+m*m);h=t[f],a+=y/this._width,s[p]=a,s[p+1]=0,s[p+2]=a,s[p+3]=1}let l=0;for(let f=0;f<c-1;f++){const p=f*2;o[l++]=p,o[l++]=p+1,o[l++]=p+2,o[l++]=p+2,o[l++]=p+1,o[l++]=p+3}r.update(),i.update(),this.updateVertices()}updateVertices(){var h,c;const t=this.points;if(t.length<1)return;let e=t[0],r,i=0,s=0;const o=(h=this.buffers[0])==null?void 0:h.data,a=t.length;for(let l=0;l<a;l++){const u=t[l],d=l*4;l<t.length-1?r=t[l+1]:r=u,s=-(r.x-e.x),i=r.y-e.y;const f=Math.sqrt(i*i+s*s),p=this._width/2;i/=f,s/=f,i*=p,s*=p,o[d]=u.x+i,o[d+1]=u.y+s,o[d+2]=u.x-i,o[d+3]=u.y-s,e=u}(c=this.buffers[0])==null||c.update()}update(){this.build()}}class Ux extends Pr{constructor(t,e,r){const i=new Nx(e,r);t.source.addressMode="repeat",super({geometry:i,texture:t}),this.autoUpdate=!0,this.onRender=()=>{const s=this.geometry;this.autoUpdate&&s.update()}}}class $x extends An{constructor(t,e=200){super({positions:new Float32Array(t.length*4),uvs:new Float32Array(t.length*4),indices:new Uint32Array((t.length-1)*6)}),this.points=t,this._width=e,this.build()}build(){var f,p,g,m;const t=this.points;if(!t)return;const e=this.getBuffer("aPosition"),r=this.getBuffer("aUV"),i=this.getIndex();if(t.length<1)return;e.data.length/4!==t.length&&(e.data=new Float32Array(t.length*4),r.data=new Float32Array(t.length*4),i.data=new Uint16Array((t.length-1)*6));const s=t.length;let o=0,a=t[0];for(let y=0;y<s;y++){const x=a.x-((f=t[y])==null?void 0:f.x),_=a.y-((p=t[y])==null?void 0:p.y),b=Math.sqrt(x*x+_*_);a=t[y],o+=b}const h=r.data,c=i.data;h[0]=0,h[1]=0,h[2]=0,h[3]=1;let l=0,u=t[0];for(let y=0;y<s;y++){const x=y*4,_=u.x-((g=t[y])==null?void 0:g.x),b=u.y-((m=t[y])==null?void 0:m.y),M=Math.sqrt(_*_+b*b);u=t[y],l+=M/o,h[x]=l,h[x+1]=0,h[x+2]=l,h[x+3]=1}let d=0;for(let y=0;y<s-1;y++){const x=y*2;c[d++]=x,c[d++]=x+1,c[d++]=x+2,c[d++]=x+2,c[d++]=x+1,c[d++]=x+3}r.update(),i.update(),this.updateVertices()}updateVertices(){var h,c;const t=this.points;if(t.length<1)return;let e=t[0],r,i=0,s=0;const o=(h=this.buffers[0])==null?void 0:h.data,a=t.length;for(let l=0;l<a;l++){const u=t[l],d=l*4;l<t.length-1?r=t[l+1]:r=u,s=-(r.x-e.x),i=r.y-e.y;const f=Math.sqrt(i*i+s*s),p=this._width/2;i/=f,s/=f,i*=p,s*=p,o[d]=u.x+i,o[d+1]=u.y+s,o[d+2]=u.x-i,o[d+3]=u.y-s,e=u}(c=this.buffers[0])==null||c.update()}update(){this.updateVertices()}}class Hx extends Pr{constructor(t,e){const r=new $x(e,t.height);super({geometry:r,texture:t}),this.autoUpdate=!0,this.onRender=()=>{var s,o;const i=this.geometry;(this.autoUpdate||i._width!==((s=this.shader)==null?void 0:s.texture.height))&&(i._width=((o=this.shader)==null?void 0:o.texture.height)??0,i.update())}}}const Vx=(n,t,e)=>r=>{switch(r.kind){case"casing":return n(r);case"cement":return t(r);case"cementSqueeze":return e(r);default:return Ds(r)}},Wx=n=>({exaggerationFactor:2,internalLayerOptions:$y(n),holeOptions:Hy,casingOptions:Vy,cementOptions:Xy,cementSqueezeOptions:Yy,screenOptions:qy,tubingOptions:jy,cementPlugOptions:Zy,perforationOptions:Wy}),mr=class mr extends Ey{constructor(t,e,r){super(t,e,r),this.internalLayerVisibility={holeLayerId:!0,casingLayerId:!0,completionLayerId:!0,cementLayerId:!0,pAndALayerId:!0,perforationLayerId:!0},this.cementTextureCache=null,this.cementSqueezeTextureCache=null,this.cementPlugTextureCache=null,this.holeTextureCache=null,this.screenTextureCache=null,this.tubingTextureCache=null,this.textureSymbolCacheArray=null,this.scalingFactors={height:600,zFactor:1,yScale:sr()},this.getZFactorScaledPathForPoints=(i,s)=>{var h;const o=c=>c*this.scalingFactors.zFactor;return(((h=this.referenceSystem)==null?void 0:h.getCurtainPath(i,s,!0))??[]).map(c=>new V(c.point[0],o(c.point[1])))},this.drawBigPolygon=(i,s=0)=>{const o=new Te;o.poly(i),o.fill(s),this.addChild(o)},this.perforationRopeAndTextureReferences=[],this.prepareSymbolRenderObject=i=>{const{exaggerationFactor:s=1}=this.options,o=i.diameter*s;return{pathPoints:this.getZFactorScaledPathForPoints(i.start,i.end),referenceDiameter:o,symbolKey:i.symbolKey}},this.drawSymbolComponent=({pathPoints:i,referenceDiameter:s,symbolKey:o})=>{const a=this.getSymbolTexture(o,s);this.drawSVGRope(i,a)},this.drawHoleSize=(i,s)=>{if(s==null)return;const o=this.getZFactorScaledPathForPoints(s.start,s.end);if(o.length===0)return;const{exaggerationFactor:a=1,holeOptions:h}=this.options,c=s.diameter*a,{rightPath:l,leftPath:u}=Jn(c/2,o),d=this.getHoleTexture(h,c,i);this.drawHoleRope(o,d,i),this.drawOutline(u,l,Dt(h.lineColor),z0*a,"TopAndBottom",0)},this.drawCasing=i=>{const{casingOptions:s}=this.options,o=Dt(s.solidColor),a=Dt(s.lineColor);i.sections.forEach((h,c,l)=>{const u=mr.getOutlineClosureType(c,l.length-1),d=this.createCasingTexture(i.referenceDiameter);this.drawRope(h.pathPoints,d,o),h.kind==="casing-window"?this.drawCasingWindowOutline(h.leftPath,h.rightPath,s,i.casingWallWidth):this.drawOutline(h.leftPath,h.rightPath,a,i.casingWallWidth,u)})},this.generateShoe=(i,s,o,a)=>{const h=i-o,c=i,l=this.getZFactorScaledPathForPoints(h,c),u=jc(l),d=is(l,u,s*(a<0?-1:1)),f=l[l.length-1],p=u[u.length-1],g=Zc(f,p,a+s*(a<0?-1:1));return[...d,g]},this.createCementSqueezeShape=(i,s,o,a)=>{const{exaggerationFactor:h=1}=this.options;return bx(i,s,o,a,h,this.getZFactorScaledPathForPoints)},this.createPerforationShape=(i,s,o)=>{const{exaggerationFactor:a=1}=this.options;return Rx(i,s,o,a,this.getZFactorScaledPathForPoints)},this.options={...this.options,...Wx(this.id),...r}}onUnmount(t){super.onUnmount(t),this.cementTextureCache=null,this.cementSqueezeTextureCache=null,this.holeTextureCache=null,this.screenTextureCache=null,this.tubingTextureCache=null,this.textureSymbolCacheArray=null}async onUpdate(t){super.onUpdate(t),this.clearLayer(),await this.preRender(),this.render()}async onRescale(t){const e=this.scalingFactors.zFactor!==t.zFactor;this.scalingFactors={height:t.height,zFactor:t.zFactor,yScale:t.yScale},super.optionsRescale(t);const r=this.yRatio(),i=t.xBounds[0]>t.xBounds[1],s=t.yBounds[0]>t.yBounds[1];this.setContainerPosition(t.xScale(0),t.yScale(0)),this.setContainerScale(t.xRatio*(i?-1:1),r*(s?-1:1)),e&&(this.clearLayer(),await this.preRender()),this.render()}async setVisibility(t,e){if(e===this.id){super.setVisibility(t,e);return}const{internalLayerOptions:r}=this.options,s=(r?Object.entries(r):[]).find(([a,h])=>h===e),o=s==null?void 0:s[0];o&&(this.internalLayerVisibility[o]=t,this.clearLayer(),await this.preRender(),this.render())}getInternalLayerIds(){const{internalLayerOptions:t}=this.options;return t?Object.values(t):[]}yRatio(){const t=this.scalingFactors.yScale.domain(),r=(t[1]-t[0])*this.scalingFactors.zFactor,i=[t[0],t[0]+r];return Math.abs(this.scalingFactors.height/(i[1]-i[0]))}drawRope(t,e,r){if(t.length===0)return;const i=new Ga({texture:e,points:t,textureScale:1});i.tint=r||i.tint,this.addChild(i)}drawOutline(t,e,r,i=1,s="None",o=1){const a=t.map(u=>u.clone()).reverse(),h=e[0],c=a[0],l=new Te;l.moveTo(h.x,h.y),e.forEach(u=>l.lineTo(u.x,u.y)),(s==="None"||s==="Top")&&l.moveTo(c.x,c.y),a.forEach(u=>l.lineTo(u.x,u.y)),(s==="TopAndBottom"||s==="Top")&&l.lineTo(h.x,h.y),l.stroke({width:i,color:r,alignment:o}),this.addChild(l)}drawCasingWindowOutline(t,e,{lineColor:r,windowOptions:i},s=1){var g,m;const o=!!((m=(g=this.referenceSystem)==null?void 0:g.options)!=null&&m.calculateDisplacementFromBottom),[a,h]=o?[t,e]:[e,t],[c,l]=o?[1,0]:[0,1],u=new Te,d=a[0];u.moveTo(d.x,d.y),a.forEach(y=>u.lineTo(y.x,y.y)),u.setStrokeStyle({width:s,color:Dt(r),alignment:l});const f=new ns(u,{dash:[i.dashLength,i.spaceLength],color:Dt(i.dashColor),width:s,alignment:c}),p=h[0];f.moveTo(p.x,p.y),h.forEach(y=>{f.lineTo(y.x,y.y)}),this.addChild(u)}async preRender(){if(!this.data||!this.referenceSystem)return;const{exaggerationFactor:t=1}=this.options,{holeSizes:e,casings:r,cements:i,completion:s,symbols:o,pAndA:a,perforations:h}=this.data;await this.updateSymbolCache(o),e.sort((g,m)=>m.diameter-g.diameter);const c=e.length>0?(xi(e,g=>g.diameter)??0)*t:O0*t;this.internalLayerVisibility.holeLayerId&&e.forEach(g=>this.drawHoleSize(c,g)),r.sort((g,m)=>m.diameter-g.diameter);const l=r.map(g=>this.createCasingRenderObject(g)),u=i.map(g=>({kind:"cement",segments:_x(g,r,s,e,t,this.getZFactorScaledPathForPoints),casingIds:(g.referenceIds||[]).filter(m=>m)})),[d,f]=a.reduce(([g,m],y)=>Ry(y)?[[y,...g],m]:[g,[y,...m]],[[],[]]),p=d.map(g=>({kind:"cementSqueeze",segments:this.createCementSqueezeShape(g,r,s,e),casingIds:g.referenceIds}));if(this.sortCementAndCasingRenderObjects(l,u,p).forEach(Vx(g=>{this.internalLayerVisibility.casingLayerId&&(this.drawCasing(g),g.hasShoe&&this.drawShoe(g.bottom,g.referenceRadius))},g=>{if(this.internalLayerVisibility.cementLayerId){const m=this.getCementTexture();m&&this.drawComplexRope(g.segments,m)}},g=>{if(this.internalLayerVisibility.pAndALayerId){const m=this.getCementSqueezeTexture();m&&this.drawComplexRope(g.segments,m)}})),this.perforationRopeAndTextureReferences.forEach(({rope:g,texture:m})=>{g.destroyed||g.destroy({children:!0,texture:!0,textureSource:!0}),m&&m.destroy(!0)}),this.perforationRopeAndTextureReferences=[],this.internalLayerVisibility.perforationLayerId){const{perforationOptions:g}=this.options,m=h.filter(Ly),y=h.filter(Dy),x=h.filter(Gy);m.forEach(_=>{const M=this.createPerforationShape(_,r,e).reduce((C,A)=>(C[A.diameter]||(C[A.diameter]=[]),C[A.diameter]=[...C[A.diameter]??[],A],C),{});Object.values(M).forEach(C=>{const A=Lx(_,C[0],g),E=this.drawComplexRope(C,A);E&&this.perforationRopeAndTextureReferences.push({rope:E,texture:A})})}),x.forEach(_=>{const C=this.createPerforationShape(_,r,e).map(A=>({...A,diameter:A.diameter*3})).reduce((A,E)=>(A[E.diameter]||(A[E.diameter]=[]),A[E.diameter]=[...A[E.diameter]??[],E],A),{});Object.values(C).forEach(A=>{A.forEach(E=>{const I=Gx(_,h,E,g),T=this.drawComplexRope([E],I);T&&this.perforationRopeAndTextureReferences.push({rope:T,texture:I})})})}),y.forEach(_=>{const C=this.createPerforationShape(_,r,e).map(A=>({...A,diameter:A.diameter*3})).reduce((A,E)=>(A[E.diameter]||(A[E.diameter]=[]),A[E.diameter]=[...A[E.diameter]??[],E],A),{});Object.values(C).forEach(A=>{A.forEach(E=>{const I=Dx(_,E,g),T=this.drawComplexRope([E],I);T&&this.perforationRopeAndTextureReferences.push({rope:T,texture:I})})})})}this.internalLayerVisibility.completionLayerId&&s.forEach(By(g=>this.drawScreen(g),g=>this.drawTubing(g),g=>{const m=this.prepareSymbolRenderObject(g);this.drawSymbolComponent(m)})),this.internalLayerVisibility.pAndALayerId&&f.forEach(g=>{if(Iy(g)){const m=this.prepareSymbolRenderObject(g);this.drawSymbolComponent(m)}Fy(g)&&this.drawCementPlug(g,r,s,e)})}async updateSymbolCache(t){if(this.textureSymbolCacheArray||(this.textureSymbolCacheArray={}),!t)return;const e=Object.keys(this.textureSymbolCacheArray),r=Object.entries(t).map(async([i,s])=>{!e.includes(i)&&this.textureSymbolCacheArray&&(this.textureSymbolCacheArray[i]=await rn.load(s))});await Promise.all(r)}drawCementPlug(t,e,r,i){const{exaggerationFactor:s=1,cementPlugOptions:o}=this.options,a=vx(t,e,r,i,s,this.getZFactorScaledPathForPoints);o&&this.drawComplexRope(a,this.getCementPlugTexture(o));const{rightPath:h,leftPath:c}=a.reduce((l,u)=>{const{leftPath:d,rightPath:f}=Jn(u.diameter/2,u.points);return{rightPath:[...l.rightPath,...f],leftPath:[...l.leftPath,...d]}},{rightPath:[],leftPath:[]});this.drawOutline(c,h,Dt("black"),.25,"TopAndBottom")}createCasingRenderObject(t){const{exaggerationFactor:e=1}=this.options;return Ix(e,t,this.getZFactorScaledPathForPoints)}getCementPlugTexture(t){return this.cementPlugTextureCache||(this.cementPlugTextureCache=Px(t)),this.cementPlugTextureCache}drawSVGRope(t,e){if(t.length===0)return;const r=new Hx(e,t);this.addChild(r)}getSymbolTexture(t,e){var i,s;const r=(s=(i=this.textureSymbolCacheArray)==null?void 0:i[t])==null?void 0:s.source;return r?new D({source:r,orig:new Y(0,0,0,e),rotate:$.MAIN_DIAGONAL}):void 0}drawHoleRope(t,e,r){if(t.length===0)return;const i=new Ga({texture:e,points:t,textureScale:r/qt});this.addChild(i)}getHoleTexture(t,e,r){const i=qt,s=i,o=i,a=e/r*i;this.holeTextureCache||(this.holeTextureCache=Ax(t,o,s));const h=this.holeTextureCache.source,c=(s-a)/2,l=new Y(0,c,o,a);return new D({source:h,frame:l})}sortCementAndCasingRenderObjects(t,e,r){let i=0;const{result:s}=t.reduce((o,a)=>{const h=o.remainingCement.find(l=>l.casingIds.includes(a.id)),c=o.remainingCementSqueezes.filter(l=>l.casingIds.includes(a.id));return h&&(h.zIndex=i++),c.forEach(l=>l.zIndex=i++),a.zIndex=i++,{result:[...o.result,h,a,...c],remainingCement:o.remainingCement.filter(l=>l!==h),remainingCementSqueezes:o.remainingCementSqueezes.filter(l=>!c.includes(l))}},{result:[],remainingCement:e,remainingCementSqueezes:r});return s.filter(o=>o!=null).sort((o,a)=>o.zIndex-a.zIndex)}drawComplexRope(t,e){if(t.length===0)return;const r=new zx(e,t);return this.addChild(r),r}createCasingTexture(t){return new D({source:D.WHITE.source,orig:new Y(0,0,16,t)})}drawShoe(t,e){const{exaggerationFactor:r=1,casingOptions:i}=this.options,s=i.shoeSize.width*r,o=i.shoeSize.length*r,a=this.generateShoe(t,e,o,s),h=this.generateShoe(t,e,o,-s);this.drawBigPolygon(h),this.drawBigPolygon(a)}getCementTexture(){if(!this.cementTextureCache){const{cementOptions:t}=this.options;t&&(this.cementTextureCache=Sx(t))}return this.cementTextureCache}getCementSqueezeTexture(){if(!this.cementSqueezeTextureCache){const{cementSqueezeOptions:t}=this.options;t&&(this.cementSqueezeTextureCache=Tx(t))}return this.cementSqueezeTextureCache}drawScreen({start:t,end:e,diameter:r}){const{exaggerationFactor:i=1,screenOptions:s}=this.options,o=i*r,a=this.getZFactorScaledPathForPoints(t,e),{leftPath:h,rightPath:c}=Jn(o/2,a),l=this.getScreenTexture();l&&(this.drawCompletionRope(a,l,o),this.drawOutline(h,c,Dt(s.lineColor),N0*i,"TopAndBottom"))}drawTubing({diameter:t,start:e,end:r}){const{exaggerationFactor:i=1,tubingOptions:s}=this.options,o=i*t,a=this.getZFactorScaledPathForPoints(e,r),h=this.getTubingTexture(s);this.drawCompletionRope(a,h,o)}getTubingTexture(t){return this.tubingTextureCache||(this.tubingTextureCache=Mx(t)),this.tubingTextureCache}getScreenTexture(){if(!this.screenTextureCache){const{screenOptions:t}=this.options;t&&(this.screenTextureCache=Cx(t))}return this.screenTextureCache}drawCompletionRope(t,e,r){if(t.length===0)return;const i=new Ux(e,t,r);this.addChild(i)}};mr.getOutlineClosureType=(t,e)=>t===0?t===e?"TopAndBottom":"Top":t===e?"Bottom":"None";let za=mr;const a_=n=>{const t=document.createElement("div");return t.setAttribute("style",`display: flex;flex:1;flex-direction:column; width: ${n}px;height:100%; background-color: white; padding: 12px;`),t},h_=(n,t)=>{const e=document.createElement("div");return e.className="story-layer-container",e.setAttribute("style",`height: ${t}px; width: ${n}px;background-color: #eee;`),e.setAttribute("height",`${t}`),e.setAttribute("width",`${n}`),e},c_=n=>{const t=document.createElement("div");return t.className="button-container",t.setAttribute("style",`width: ${n}px;background-color: white;`),t},l_=()=>{const n=document.createElement("p"),t=[];let e;function r(){window.requestAnimationFrame(()=>{const i=performance.now();for(;t.length>0&&t[0]<=i-1e3;)t.shift();t.push(i),e=t.length,n.innerHTML=`FPS: ${e}`,r()})}return r(),n},u_=n=>{const t=document.createElement("p");return t.innerHTML=n,t};export{Sr as $,Ht as A,ie as B,n_ as C,K as D,j as E,ng as F,Ar as G,Jx as H,_m as I,fg as J,Xt as K,Ch as L,J as M,Ut as N,Z as O,i_ as P,$ as Q,_t as R,za as S,Kn as T,zh as U,t_ as V,z as W,F as X,D as Y,Qx as Z,b1 as _,h_ as a,u1 as a0,wn as a1,K1 as a2,vr as a3,yc as a4,$i as a5,tt as a6,Gn as a7,Oi as a8,V as a9,Gh as aA,Mt as aB,Hh as aC,zo as aD,gn as aE,Fp as aF,Uo as aG,qr as aH,$o as aI,Lp as aJ,Nh as aK,zc as aL,Ig as aM,Ps as aN,wm as aO,Ym as aP,jm as aQ,t1 as aR,n1 as aS,r1 as aT,mp as aa,Kt as ab,_e as ac,nn as ad,Ea as ae,U as af,W as ag,Ih as ah,Y as ai,Fe as aj,nt as ak,mm as al,Mr as am,ra as an,an as ao,bs as ap,pc as aq,Pt as ar,vs as as,Xm as at,qm as au,Qm as av,e1 as aw,ep as ax,i1 as ay,ut as az,u_ as b,a_ as c,l_ as d,c_ as e,ws as f,As as g,sc as h,br as i,Ds as j,o_ as k,s_ as l,Ja as m,So as n,e_ as o,pu as p,Ey as q,Te as r,Vt as s,Mh as t,Sh as u,Kx as v,Zx as w,sr as x,Yt as y,jx as z};
