{"version":3,"file":"findsample-f4fa7ca8.js","sources":["../../../../src/datautils/findsample.ts"],"sourcesContent":["export function findIndexOfSample(data: number[][], pos: number): number {\n  let a = 0;\n  let b = data.length - 1;\n  const linearSearchLimit = 20;\n  let aPos = data[a][0];\n  let bPos = data[b][0];\n\n  while (b - a > linearSearchLimit) {\n    const splitAt = Math.floor((b + a) / 2);\n    const splitPos = data[splitAt][0];\n\n    if (pos >= aPos && pos < splitPos) {\n      b = splitAt;\n      bPos = data[b][0];\n    } else if (pos >= splitPos && pos <= bPos) {\n      a = splitAt;\n      aPos = data[a][0];\n    } else if (pos <= aPos && pos > splitPos) {\n      b = splitAt;\n      bPos = data[b][0];\n    } else if (pos <= splitPos && pos >= bPos) {\n      a = splitAt;\n      aPos = data[a][0];\n    } else {\n      return -1;\n    }\n  }\n\n  let index = -1;\n  for (let i = a; i < b; i++) {\n    const v1 = data[i][0];\n    const v2 = data[i + 1][0];\n    if (Math.min(v1, v2) <= pos && pos <= Math.max(v1, v2)) {\n      index = i;\n      break;\n    }\n  }\n\n  return index;\n}\n\nexport function findSampleAtPos(data: number[][], pos: number, topLimit: number = null, bottomLimit: number = null): number {\n  let y: number = null;\n  const index = findIndexOfSample(data, pos);\n  if (index !== -1) {\n    const v1 = data[index][1];\n    const v2 = data[index + 1][1];\n    if (v2 && v2) {\n      const x1 = data[index][0];\n      const x2 = data[index + 1][0];\n      const span = x2 - x1;\n      const d = pos - x1;\n      const f = d / span;\n      y = v1 * (1 - f) + v2 * f;\n      if (topLimit && topLimit > y) {\n        y = topLimit;\n      }\n      if (bottomLimit && bottomLimit < y) {\n        y = bottomLimit;\n      }\n    }\n  }\n  return y;\n}\n"],"names":["findIndexOfSample","data","pos","a","b","linearSearchLimit","aPos","bPos","splitAt","splitPos","index","i","v1","v2","findSampleAtPos","topLimit","bottomLimit","y","x1","span","f"],"mappings":"AAAgB,SAAAA,EAAkBC,EAAkBC,EAAqB,CACvE,IAAIC,EAAI,EACJC,EAAIH,EAAK,OAAS,EACtB,MAAMI,EAAoB,GAC1B,IAAIC,EAAOL,EAAKE,CAAC,EAAE,CAAC,EAChBI,EAAON,EAAKG,CAAC,EAAE,CAAC,EAEb,KAAAA,EAAID,EAAIE,GAAmB,CAChC,MAAMG,EAAU,KAAK,OAAOJ,EAAID,GAAK,CAAC,EAChCM,EAAWR,EAAKO,CAAO,EAAE,CAAC,EAE5B,GAAAN,GAAOI,GAAQJ,EAAMO,EACnBL,EAAAI,EACGD,EAAAN,EAAKG,CAAC,EAAE,CAAC,UACPF,GAAOO,GAAYP,GAAOK,EAC/BJ,EAAAK,EACGF,EAAAL,EAAKE,CAAC,EAAE,CAAC,UACPD,GAAOI,GAAQJ,EAAMO,EAC1BL,EAAAI,EACGD,EAAAN,EAAKG,CAAC,EAAE,CAAC,UACPF,GAAOO,GAAYP,GAAOK,EAC/BJ,EAAAK,EACGF,EAAAL,EAAKE,CAAC,EAAE,CAAC,MAET,OAAA,EAEX,CAEA,IAAIO,EAAQ,GACZ,QAASC,EAAIR,EAAGQ,EAAIP,EAAGO,IAAK,CAC1B,MAAMC,EAAKX,EAAKU,CAAC,EAAE,CAAC,EACdE,EAAKZ,EAAKU,EAAI,CAAC,EAAE,CAAC,EACpB,GAAA,KAAK,IAAIC,EAAIC,CAAE,GAAKX,GAAOA,GAAO,KAAK,IAAIU,EAAIC,CAAE,EAAG,CAC9CH,EAAAC,EACR,KACF,CACF,CAEO,OAAAD,CACT,CAEO,SAASI,EAAgBb,EAAkBC,EAAaa,EAAmB,KAAMC,EAAsB,KAAc,CAC1H,IAAIC,EAAY,KACV,MAAAP,EAAQV,EAAkBC,EAAMC,CAAG,EACzC,GAAIQ,IAAU,GAAI,CAChB,MAAME,EAAKX,EAAKS,CAAK,EAAE,CAAC,EAClBG,EAAKZ,EAAKS,EAAQ,CAAC,EAAE,CAAC,EAC5B,GAAIG,GAAMA,EAAI,CACZ,MAAMK,EAAKjB,EAAKS,CAAK,EAAE,CAAC,EAElBS,EADKlB,EAAKS,EAAQ,CAAC,EAAE,CAAC,EACVQ,EAEZE,GADIlB,EAAMgB,GACFC,EACVF,EAAAL,GAAM,EAAIQ,GAAKP,EAAKO,EACpBL,GAAYA,EAAWE,IACrBA,EAAAF,GAEFC,GAAeA,EAAcC,IAC3BA,EAAAD,EAER,CACF,CACO,OAAAC,CACT"}